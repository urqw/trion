:mainmenu
;Разработка "Триона" началась 3 марта 2003 года.
;15 декабря 2003 года - квест уже набирает СК 20+++ (максимальная на сегодняшний день оценка).
;Изменения в балансе:
;От изнеможения теперь умереть нельзя, но у вас будут понижаться характеристики.
perkill
invkill
clrscr=1
proc screenpar
Imagetype=6
Image=888
proc replichello
proc replicbye
common=1
pln #/$#/$#/$#/$                                      Трион
pln                                   Часть первая
pln #/$                                Версия 0.22 Demo
pln #/$#/$                                                          Автор: Terracon
pln                                                            Сайт: http://tqst.ru
pln                                                          E-mail: tqstru@tqst.ru
btn newgame, Новая игра
btn about, Описание
btn advices, Советы
end

:rnd()
число=до-от+1
proc rnd
рнд=рнд+от-1
end

:rnd
рнд=rnd*число+1
i=0
:rnd_loop
i=i+1
if рнд>i and рнд<(i+1) then рнд=i
if i<число then goto rnd_loop
end

:fightbegin
fightrole=fightrole+1
if здоровье<1 then goto gameover
рнд=rnd
if конфуз=0 and fightrole=1 and act>0 and рнд<0.11 and numterdes>0 then pln #%terdescription1$
if конфуз=0 and fightrole=1 and act>0 and рнд<0.21 and рнд>0.1 and numterdes>1 then pln #%terdescription2$
if конфуз=0 and fightrole=1 and act>0 and рнд<0.31 and рнд>0.2 and numterdes>2 then pln #%terdescription3$
if времяконфуза=0 and конфуз=1 then конфуз=0 & pln #%name$ наконец-то высвобождается от обвивших его ветвей и теперь может продолжать сражаться.
if времяконфуза>0 then времяконфуза=времяконфуза-1
if конфуз=1 then pln #%name$ стоит неподвижно и не может пошевелиться.
if act=3 then spellcasting=spellcasting+1
if act=1 and kick=1 and actions=1 then goto miss
if act=1 and kick=2 and actions=1 then goto kick
if скорость/вскорость>=2 and скорость/вскорость<3 and action<2 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=3 and скорость/вскорость<4 and action<3 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=4 and скорость/вскорость<5 and action<4 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=5 and скорость/вскорость<6 and action<5 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=6 and скорость/вскорость<7 and action<6 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=7 and скорость/вскорость<8 and action<7 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=8 and скорость/вскорость<9 and action<8 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=9 and скорость/вскорость<10 and action<9 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=10 and скорость/вскорость<11 and action<10 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=11 and скорость/вскорость<12 and action<11 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=12 and скорость/вскорость<13 and action<12 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=13 and скорость/вскорость<14 and action<13 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=14 and скорость/вскорость<15 and action<14 and act=1 and вздоровье>0 then actions=1 & goto fightatack
if скорость/вскорость>=15 and action<15 and act=1 and вздоровье>0 then actions=1 & goto fightatack
begin=begin+1
if вздоровье<1 and здоровье>0.9 then goto fightwin
if опыт#%weapexp$>=нужныйопыт#%weapexp$ then опыт#%weapexp$=0 & нужныйопыт#%weapexp$=нужныйопыт#%weapexp$*2 & #%weapexp$=#%weapexp$+1 & pln #%name$ повысил мастерство #%weapname$
if act=2 and колоружия=0 then pln #%name$ лишь защищается, не атакуя, и пытается немного отдышаться. & бодрость=бодрость+0.25+выносливость/30 & бодрость=бодрость+((весвсего*8)-(выносливость+ловкость*3))/120
if act=2 and колоружия=1 then pln #%name$ лишь защищается, не атакуя, и пытается немного отдышаться. & бодрость=бодрость+0.25+выносливость/30 & бодрость+((весвсего*8)-(выносливость+ловкость*3))/80
if act=2 and колоружия=2 then pln #%name$ лишь защищается, не атакуя, и пытается немного отдышаться. & бодрость=бодрость+0.25+выносливость/30 & бодрость=бодрость-((весвсего*8)-(выносливость+ловкость*3))/40
if бодрость>максбодрость+0.9 then бодрость=(максбодрость+0.9)
if бодрость<1.9 then pln #/$ #%name$ ужасно устал.
if бодрость<1 then pln Из-за усталости у вас начинает кружиться голова, из носа течёт кровь. & бодрость=бодрость+0.6 & здоровье=здоровье-1
if здоровье<2 then pln #/$ #%name$ еле держится на ногах, в глазах двоится, ещё немного и его добьют.
if act<>2 then блокировка=блок+weapbonus
action=0
fightenemyrole=0
fightrole=0

:fightcontinue
fightenemyrole=fightenemyrole+1
if confuse=0 and enemyact=3 then enemyspellcasting=enemyspellcasting+1
if confuse=0 and begin>1 then proc fight#%fightname$action
if confuse=0 and fightenemyrole=1 and enemyact>0 then pln ______________________________________________________________________________
рнд=rnd
if confuse=0 and fightenemyrole=1 and enemyact>0 and рнд<0.11 and numterdesenemy>0 then pln #/$#%terdescriptionenemy1$
if confuse=0 and fightenemyrole=1 and enemyact>0 and рнд<0.21 and рнд>0.1 and numterdesenemy>1 then pln #/$#%terdescriptionenemy2$
if confuse=0 and fightenemyrole=1 and enemyact>0 and рнд<0.31 and рнд>0.2 and numterdesenemy>2 then pln #/$#%terdescriptionenemy3$
p #/$#%enemy$ 

if восприятие>виллюзия+2 and восприятие<виллюзия+4 then p (#вздоровье/вмаксздоровье*100$%/100%) 
if восприятие>виллюзия+3 then p (#вздоровье$/#вмаксздоровье$) 

if восприятие=виллюзия+3 and вбодрость>1 then p выглядит довольно бодро (#вбодрость/вмаксбодрость*100$%/100%), 

if восприятие>виллюзия+2 and восприятие<виллюзия+4 and вбодрость<=1 then p выглядит уставшим (#вбодрость/вмаксбодрость*100$%/100%), 

if восприятие>виллюзия+3 and вбодрость>1 then p выглядит довольно бодро (#вбодрость$/#вмаксбодрость$), 

if восприятие>виллюзия+3 and вбодрость<=1 then p выглядит уставшим (#вбодрость$/#вмаксбодрость$), 

число=2
proc rnd
fightimage=рнд
число=удача/3
proc rnd
удачливость=рнд
от=всила
до=всила*2
proc rnd()
вурон=рнд
от=вминфортуна
до=вмаксфортуна
proc rnd()

if confuse=0 and enemyact=1 and размер/вразмер<1 then proc fightenemyatack & от=1 & до=5 & proc rnd() & область=рнд & число=100 & proc rnd & proc fightenemykickormiss

if confuse=0 and enemyact=1 and размер/вразмер=1 then proc fightenemyatack & от=2 & до=5 & proc rnd() & область=рнд & число=100 & proc rnd & proc fightenemykickormiss

if confuse=0 and enemyact=1 and размер/вразмер>1 then proc fightenemyatack & от=2 & до=6 & proc rnd() & область=рнд & число=100 & proc rnd & proc fightenemykickormiss

if confuse=0 and enemyact=2 then p  останавливается, пытаясь отдышаться. & вбодрость=вбодрость+внагруженность*1.7
if confuse=0 and enemyact=3 then pln  готовит какую-то волшбу #%magicname$ магии. & proc fight#%fightname$spellcasting#enemyspell$
if confuse=0 and enemyact=4 then pln  использует заклинание "#%enemysorcery$". & proc fightenemyspelling#%enemyspellname$
if confuse=0 and enemyact=0 then pln  готовится к сражению. & instr style_formpicture=996.bmp
if confuse=1 then p  не может двинуться. & confusetime=confusetime+1
if confuse=1 and confusetime=confuseending then p #%enemy$ наконец-то вырывается из своей "ловушки". & confusetime=1 & confuse=0
if здоровье<1 then goto gameover
if вздоровье<1 then goto fightwin
if confuse=0 and вскорость/скорость>=2 and вскорость/скорость<3 and enemyact=1 and enemyaction<2 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=3 and вскорость/скорость<4 and enemyact=1 and enemyaction<3 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=4 and вскорость/скорость<5 and enemyact=1 and enemyaction<4 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=5 and вскорость/скорость<6 and enemyact=1 and enemyaction<5 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=6 and вскорость/скорость<7 and enemyact=1 and enemyaction<6 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=7 and вскорость/скорость<8 and enemyact=1 and enemyaction<7 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=8 and вскорость/скорость<9 and enemyact=1 and enemyaction<8 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=9 and вскорость/скорость<10 and enemyact=1 and enemyaction<9 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=10 and вскорость/скорость<11 and enemyact=1 and enemyaction<10 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=11 and вскорость/скорость<12 and enemyact=1 and enemyaction<11 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=12 and вскорость/скорость<13 and enemyact=1 and enemyaction<12 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=13 and вскорость/скорость<14 and enemyact=1 and enemyaction<13 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=14 and вскорость/скорость<15 and enemyact=1 and enemyaction<14 and здоровье>0.9 then goto fightcontinue
if confuse=0 and вскорость/скорость>=15 and enemyact>0 and enemyact<3 and enemyaction<15 and здоровье>0.9 then goto fightcontinue
if spellwait=spellcasting and act=3 then action=0 & goto fightuse#%spell$
fightenemyrole=0
if act=3 then action=0 & goto fightbegin
fightlook=0
if здоровье>0.9 then goto fightchoseaction
end

:fightchoseaction
if здоровье>0.9 and конфуз=0 and лежит=0 and сила>0 then btn fightatack, Атаковать
if здоровье>0.9 and конфуз=0 and лежит=1 then btn fightstandup, Встать на ноги
if здоровье>0.9 and конфуз=0 and оружиеупало>0 then btn fighttakeweapon, Подобрать #%weaponfall#оружиеупало$оружие$
if здоровье>0.9 and Заклинания and мана>1.8 then btn fightchosespell, Выбрать заклинание
if здоровье>0.9 and выборзаклинания=1 then btn fight#%spell$, Использовать заклинание "#%sorcery$"
if здоровье>0.9 then btn fightwait, Ждать
if здоровье>0.9 then btn fightlookat#%fightname$, Осмотреть #%enemy3$
if act=1 and fightlook=0 then instr style_formpicture=#993+fightimage$.bmp
action=0
end

:fightenemykickormiss
enemyaction=enemyaction+1
if впол=1 or впол=3 then instr cname=его
if впол=2 then instr cname=её
if enemykick=1 and блокировка<рнд then pln  атакует, но вы уворачиваетесь от #%cname$ удара.
if блокировка>=рнд then p  атакует, но #%name$ блокирует его удар
if блокировка>=рнд and вудача-1+rnd*вудача>удача and weaptype>0 then p Точный удар #%enemy1$ вышибает #%оружие$ из ваших рук. & оружиеупало=оружиеупало+1 & instr #оружиеупало$оружие=#%weapfullname$& weaptype=0
if блокировка>=рнд then pln .
if область=1 or область=2 then вурон=вурон-броняног
if область=3 or область=4 then вурон=вурон-бронятела
if область=5 or область=6 then вурон=вурон-броняголовы
if вурон<1 and enemykick=2 and блокировка<рнд then вурон=0 & pln атакует, но ваша крепкая броня полностью защищает вас от удара.
if enemykick=2 and блокировка<рнд and вурон>0 then p  атакует вас & здоровье=(здоровье-вурон)
if область<3 and enemykick=2 and блокировка<рнд and вурон>0 then p  по ногам & Style_Dos_TextColor=12 & p (-#вурон$) & Style_Dos_TextColor=7 & pln .& play kick.wav & pause 360
if область=3 and enemykick=2 and блокировка<рнд or область=4 and enemykick=2 and блокировка<рнд and вурон>0 then p  по телу & Style_Dos_TextColor=12 & p (-#вурон$) & Style_Dos_TextColor=7 & pln .& play kick.wav & pause 360
if область>4 and enemykick=2 and блокировка<рнд and вурон>0 then p  по голове & Style_Dos_TextColor=12 & p (-#вурон$) & Style_Dos_TextColor=7 & pln .& play kick.wav & pause 360
if act3s=1 and блокировка<рнд then pln #%enemy$ бездумно расходует свои силы, от чего и теряет здоровье. & Style_Dos_TextColor=12 & pln (-1). & Style_Dos_TextColor=7
end

:fightwait
act=2
блокировка=блок+блок/3+удача/2
goto fightbegin
end

:fightenemyatack
play удар.wav
pause 830
вбодрость=вбодрость-внагруженность
вфортуна=рнд
if (вточность*2.5+(вбодрость/вмаксбодрость)*6+вфортуна)>=ловкость+бодрость/максбодрость+удачливость then enemykick=2
if (вточность*2.5+(вбодрость/вмаксбодрость)*6+вфортуна)<ловкость+бодрость/максбодрость+удачливость then enemykick=1
end

:fightatack
actions=1
pause 1
play удар.wav
pause 830
sec=sec+3
if sec>59 then minute=minute+1 & sec=sec-60
if minute>59 then hour=hour+1 & minute=minute-60
if hour>23 then day=day+1 & hour=hour-24 & годностьяблок=годностьяблок-1
if day>7 and week=1 then week=2
if day>14 and week=2 then week=3
if day>21 and week=3 then week=4
if day>28 and week=4 then week=5
if week>4 and day>3 then month=month+1 & week=week-3 & day=day-30
if колоружия>0 then бодрость=бодрость-((весвсего*8)-(выносливость+ловкость*3))/80
if колоружия=0 then бодрость=бодрость-((весвсего*8)-(выносливость+ловкость*3))/120
act=1
число=вудача
proc rnd
вудачливость=рнд
от=минфортуна
до=максфортуна
proc rnd()
фортуна=рнд
if  точность*2.5+(бодрость/максбодрость-весвсего/3)+фортуна/3+weapbonus/2>=вловкость+вбодрость/вмаксбодрость+вудачливость+вскорость/3 then kick=2 & goto fightbegin
kick=1
goto fightbegin
end

:kick
actions=0
action=action+1
pause 1
от=сминатака
до=смаксатака
proc rnd()
уроноружия=рнд+weapbonus
if уроноружия>смаксатака then уроноружия=смаксатака
от=сила-1
до=сила*2-1
proc rnd()
уронсилы=рнд
урон=уроноружия+уронсилы
if размер=1 then от=1 & до=5 
if размер=2 then от=1 & до=6
if размер=3 then от=2 & до=5
proc rnd()
область=рнд
if область=1 or область=2 then урон=урон-вброняног
if область=3 or область=4 then урон=урон-вбронятела
if область=5 or область=6 then урон=урон-вброняголовы
if область=1 or область=2 then proc kicklegs
if область=3 or область=4 then proc kickbody
if область=5 or область=6 then proc kickhead
Style_Dos_TextColor=12
if урон>0 then p (-#урон$)
Style_Dos_TextColor=7
pln .
if впол=1 then instr cname=он
if впол=2 then instr cname=она
if впол=3 then instr cname=оно
if урон<1 and уроноружия+уронсилы>0 then pln . Броня #%enemy1$ выдерживает удар и #%cname$ не получает никаких повреждений. & урон=0 & play блок.wav & pause 120
if урон<1 and уроноружия+уронсилы<1 then pln . Ваш удар получился настолько слабым, что нисколько не навредил #%enemy2$. & урон=0 & play блок.wav & pause 120
if урон>0 then play kick.wav & pause 360
вздоровье=(вздоровье-урон)
act=1
опыт#%weapexp$=опыт#%weapexp$+1
goto fightbegin
end

:kicklegs
if впол=1 or впол=3 then instr cname=ему
if впол=2 then instr cname=ей
рнд=rnd
if weaptype=0 and рнд<=0.33 then p #%name$ быстро шагнул к #%enemy2$ и с силой наступил #%cname$ на ногу 
if weaptype=0 and рнд>0.33 and рнд<=0.66 then p Присев на корточки, #%name$ сделал подножку #%enemy2$ 
if weaptype=0 and рнд>0.66 then p Стараясь не потерять равновесие, #%name$ ударил #%enemy3$ ногой по голени 
if weaptype=4 and рнд<=0.5 then p #%name$ нанёс удар топором по голени #%enemy1$ 
if weaptype=4 and рнд>0.5 then p Сильно замахнувшись, #%name$ сделал мощный удар топором по бедру #%enemy1$ 
if weaptype=3 and рнд<=0.5 then p #%name$ замахнулся и ударил #%оружие1$ в пах #%enemy1$ 
if weaptype=3 and рнд>0.5 then p #%name$ взял поудобнее #%оружие$ и сделал подсечку #%enemy2$ 
end

:kickbody
рнд=rnd
if weaptype=0 and рнд<=0.25 then p #%name$ пригнулся и нанёс сокрушительный удар кулаком по животу #%enemy1$ 
if weaptype=0 and рнд>0.25 and рнд<=0.5 then p #%name$ с развороту нанёс #%enemy2$ удар ногой по почкам 
if впол=1 or впол=3 then instr cname=его
if впол=2 then instr cname=её
if weaptype=0 and рнд>0.5 and рнд<=0.75 then p Размахнувшись и сделав долгий выдох, #%name$ сделал удар открытой ладонью в сердце #%enemy1$, тем самым оттолкнув #%cname$ на два шага назад 
if weaptype=0 and рнд>0.75 then p Собрав все свои силы в кулак, #%name$ нанёс мощный удар #%enemy2$ в плечо 
if weaptype=4 and рнд<=0.33 then p #%name$ сделал отвлекающий взмах свободной рукой и атаковал #%enemy3$ в плечо топором 
if weaptype=4 and рнд>0.33 and рнд<=0.66 then p #%name$ быстро замахнулся и столь же быстро нанёс удар топором по туловищу #%enemy1$, оставив порез 
if weaptype=4 and рнд>0.66 then p Сделав поворот вокруг своей оси, #%name$ ударил #%enemy3$ топором в рёбра 
if впол=1 then instr cname=он
if впол=2 then instr cname=она
if впол=3 then instr cname=оно
if weaptype=3 and рнд<=0.5 then p #%name$ взял #%оружие$ горизонтально и сильно толкнул #%enemy3$ в грудь 
if weaptype=3 and рнд>0.5 then p Проведя #%оружие1$м полукруг, #%name$ ударил #%enemy3$ по почкам 
end

:kickhead
if впол=1 or впол=3 then instr cname=муся
if впол=2 then instr cname=йся
рнд=rnd
if weaptype=0 and рнд<=0.25 then p #%name$ присел и сделал точный апперкот растерявше#%cname$ #%enemy2$ 
if weaptype=0 and рнд>0.25 and рнд<=0.5 then p Дождавшись нужного момента, #%name$ сделал удар ребром ладони в висок #%enemy1$ 
if впол=1 or впол=3 then instr cname=его
if впол=2 then instr cname=её
if weaptype=0 and рнд>0.5 and рнд<=0.75 then p Не останавливаясь ни на секунду, #%name$ нанёс удар ступнёй в кадык #%enemy1$, заставив #%cname$ закашляться 
if weaptype=0 and рнд>0.75 then p Серьёзно разозлившись, #%name$ сделал быстрый удар локтём в нос #%enemy1$ 
if впол=1 or впол=3 then instr cname=ему
if впол=2 then instr cname=ей
if weaptype=4 and рнд<=0.5 then p #%name$ двинулся навстречу #%enemy2$ и, в прыжке, нанёс #%cname$ ошеломляющий удар топором в лоб  
if weaptype=4 and рнд>0.5 then p Сделав быстрый шаг влево, #%name$ провёл точный удар топором по шее #%cname1$ 
if weaptype=3 and рнд<=0.5 then p #%name$ с силой ударил #%enemy3$ #%оружие1$м прямо в нос 
if weaptype=3 and рнд>0.5 then p Замахнувшись, #%name$ стукнул #%enemy3$ #%оружие1$м в лоб 
end

:miss
actions=0
action=action+1
act=0
p #%name$ атакует, но ловк
if впол=1 then p ий 
if впол=2 then p ая 
if впол=3 then p ое 
pln #%enemy$ уворачивается от вашего удара.
goto fightbegin
end

:fightwgibaction
act3s=0
if вбодрость>1 then enemyact=1
if вбодрость<=1 and rnd>=0.2 or вбодрость<0 then enemyact=2
if вбодрость<=1 and rnd<0.2 and вбодрость>-0.1 then enemyact=1 & вздоровье=вздоровье-1 & act3s=1
end

:fightlookatwgib
fightlook=1
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
pln У #%enemy1$ ничего нет.
goto fightchoseaction
end

:fightvalmesaction
act3s=0
if вбодрость>1 and вмана<2 and enemyspellwait=0 or вздоровье<5 and вбодрость>1 and enemyspellwait=0 then enemyact=1
if вбодрость<=1 and rnd>=0.2 or вбодрость<0 then enemyact=2
if вбодрость<=1 and rnd<0.2 and вбодрость>-0.1 then enemyact=1 & вздоровье=вздоровье-1 & act3s=1
if вбодрость>1 and вмана>2 and вздоровье>4 then enemyact=3 & enemyspell=1
if enemyact=3 and enemyspellwait=1 then enemyact=4
end

:fightlookatvalmes
fightlook=1
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
pln У #%enemy1$ ничего нет.
goto fightchoseaction
end

:fightvalmesspellcasting1
instr magicname=неизвестной
if интеллект<2 then instr magicname=кобольдовой
вмана=вмана-2
enemyspellwait=1
instr enemysorcery=Удача
instr enemyspellname=luck
end

:fightkrilaction
act3s=0
if вбодрость>1 and вмана<2 and enemyspellwait=0 or вбодрость>1 and времяконфуза>1 and enemyspellwait=0 then enemyact=1
if вбодрость<=1 and rnd>=0.2 or вбодрость<0 then enemyact=2
if вбодрость<=1 and rnd<0.2 and вбодрость>-0.1 then enemyact=1 & вздоровье=вздоровье-1 & act3s=1
if вбодрость>1 and вмана>=2 and здоровье<максздоровье-4 and rnd<0.5 and времяконфуза<2 then enemyact=3 & enemyspell=1
if вбодрость>1 and вмана>=2 and здоровье<максздоровье-4 and rnd>=0.5 then enemyact=3 & enemyspell=2
if вбодрость>1 and вмана>=2 and здоровье>=максздоровье-4 and времяконфуза<2 then enemyact=3 & enemyspell=1
instr magicname=неизвестной
if enemyact=3 and интеллект>=2 then instr magicname=зелёной
if enemyact=3 and enemyspellwait=1 then enemyact=4
end

:fightlookatkril
fightlook=1
instr lookarmor=noarmor
instr lookshoes=noshoes
instr lookcap=nocap
p У #%enemy1$ 
if krilwands=1 or krilrobes=1 or krilwands=1 then p есть 
if krilwands=0 and krilrobes=0 and krilwands=0 then pln ничего нет.& instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
if krilrobes=1 and krilsandaless=1 and krilwands=0 then pln плащ и сандалии.& instr style_formpicture=heroimages/robe/sandales/nocap/1.bmp
if krilrobes=1 and krilsandaless=0 and krilwands=1 then pln плащ и посох.& instr style_formpicture=heroimages/robe/noshoes/nocap/4.bmp
if krilrobes=0 and krilsandaless=1 and krilwands=1 then pln сандалии и посох.& instr style_formpicture=heroimages/noarmor/sandales/nocap/4.bmp
if krilrobes=1 and krilsandaless=1 and krilwands=1 then pln плащ, сандалии и посох.& instr style_formpicture=heroimages/robe/sandales/nocap/4.bmp
if krilrobes=1 and krilsandaless=0 and krilwands=0 then pln плащ.& instr style_formpicture=heroimages/robe/noshoes/nocap/1.bmp
if krilrobes=0 and krilsandaless=1 and krilwands=0 then pln сандалии.& instr style_formpicture=heroimages/noarmor/sandales/nocap/1.bmp
if krilrobes=0 and krilsandaless=0 and krilwands=1 then pln посох.& instr style_formpicture=heroimages/noarmor/noshoes/nocap/4.bmp
goto fightchoseaction
end

:fightkrilspellcasting1
вплюс=1
вмана=вмана-2
enemyspellwait=1
instr enemysorcery=Опутывающие ветви
instr enemyspellname=branch
end

:fightkrilspellcasting2
вплюс=5
вмана=вмана-2
enemyspellwait=1
instr enemysorcery=Исцеление
instr enemyspellname=aiming
end

:fightalliraaction
act3s=0
if вбодрость>1 and вмана<6 and enemyspellwait=0 then enemyact=1
if вбодрость<=1 and rnd>=0.2 or вбодрость<0 then enemyact=2 if вбодрость<=1 and rnd<0.2 and вбодрость>-0.1 then enemyact=1 & вздоровье=вздоровье-1 & act3s=1
if вбодрость>1 and вмана>5.9 then fightenemyspelltime=2 & enemyact=3 & enemyspell=1
instr magicname=неизвестной
if enemyact=3 and интеллект>=2 then instr magicname=синей
if enemyact=3 and enemyspellwait=1 then enemyact=4
end

:fightlookatallira
fightlook=1
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
pln У #%enemy1$ ничего нет.
goto fightchoseaction
end

:fightalliraspellcasting1
enemyspellwait=1
вмана=вмана-6 instr enemysorcery=Слезливость
instr enemyspellname=stearing
end

:fightfurgotaction
act3s=0
if вбодрость>1 then enemyact=1if вбодрость<=1 and rnd>=0.2 or вбодрость<0 then enemyact=2
if вбодрость<=1 and rnd<0.2 and вбодрость>-0.1 then enemyact=1 & вздоровье=вздоровье-1 & act3s=1
end

:fightlookatfurgot
fightlook=1
instr lookarmor=noarmor
instr lookshoes=noshoes
instr lookcap=nocap
p У #%enemy1$ 
if furgotaxes=1 then p есть топор дровосека.& instr style_formpicture=heroimages/noarmor/noshoes/nocap/2.bmp
if furgotaxes=0 then pln ничего нет.& instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
goto fightchoseaction
end

:fighttrayaction
act3s=0
if вбодрость>1 then enemyact=1
if вбодрость<=1 and rnd>=0.2 or вбодрость<0 then enemyact=2
if вбодрость<=1 and rnd<0.2 and вбодрость>-0.1 then enemyact=1 & вздоровье=вздоровье-1 & act3s=1
end

:fightlookattray
fightlook=1
instr lookarmor=noarmor
instr lookshoes=noshoes
instr lookcap=nocap
p У #%enemy1$ 
if trayaxes=1 then p есть малый топор.& instr style_formpicture=heroimages/noarmor/noshoes/nocap/3.bmp
if trayaxes=0 then pln ничего нет.& instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
goto fightchoseaction
end

:fighttoraction
act3s=0
if вбодрость>1 then enemyact=1
if вбодрость<=1 and rnd>=0.2 or вбодрость<0 then enemyact=2
if вбодрость<=1 and rnd<0.2 and вбодрость>-0.1 then enemyact=1 & вздоровье=вздоровье-1 & act3s=1
end

:fightlookattor
fightlook=1
instr lookarmor=noarmor
instr lookshoes=noshoes
instr lookcap=nocap
p У #%enemy1$ 
if trayaxes=1 then p есть двуручный топор.& instr style_formpicture=heroimages/noarmor/noshoes/nocap/5.bmp
if trayaxes=0 then pln ничего нет.& instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
goto fightchoseaction
end

:fightwolfaction
act3s=0
if вбодрость>1 then enemyact=1
if вбодрость<=1 and rnd>=0.2 or вбодрость<0 then enemyact=2
if вбодрость<=1 and rnd<0.2 and вбодрость>-0.1 then enemyact=1 & вздоровье=вздоровье-1 & act3s=1
end

:fightlookatwolf
fightlook=1
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
pln У #%enemy1$ ничего нет.
goto fightchoseaction
end

:fightpeasant-bugraideraction
act3s=0
fightthrowstones=fightthrowstones+1
if вбодрость>1 and fightthrowstones<3 or вбодрость>1 and fightstones=0 then enemyact=1
if вбодрость<=1 and rnd>=0.2 or вбодрость<0 then enemyact=2
if вбодрость<=1 and rnd<0.2 and вбодрость>-0.1 then enemyact=1 & вздоровье=вздоровье-1 & act3s=1
if вбодрость>1 and fightthrowstones>2 and fightstones>0 then enemyact=4 & enemyspell=1 & instr magicname=неизвестной& instr enemysorcery=Камень& instr enemyspellname=stone
end

:fightlookatpeasant-bugraider
fightlook=1
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
pln У #%enemy1$ ничего нет.
goto fightchoseaction
end

:fightenemyspellingluck
pln Над головой противника вы замечаете небольшую радугу. #%enemy$ повышает свою удачу на 2.
вудача=вудача+2
вплюскудаче=вплюскудаче+2
вмаксфортуна=вудача
enemyspellwait=0
end

:fightenemyspellingbranch
pln #%enemy$ заканчивает читать заклятие, и вы вдруг замечаете, как длинные лианоподобные ветви спутывают вас. Вы с трудом высвобождаете свою руку от одной из таких ветвей, но на её месте вырастают две другие. Пока #%name$ возится с опутывавшими его ветвями, #%enemy$ продолжает атаковать его.
конфуз=1
времяконфуза=2+вплюс
if уровень<3 then времяконфуза=времяконфуза+2
if уровень=3 then времяконфуза=времяконфуза+1
enemyspellwait=0
end

:fightenemyspellingaiming
if впол=1 then instr cname=
if впол=2 then instr cname=а
if впол=3 then instr cname=о
if впол=1 then instr cname1=ёс
if впол=2 then instr cname1=есла
if впол=3 then instr cname1=есло
if впол=1 or впол=3 then instr cname2=го
if впол=2 then instr cname2=ё
pln #%enemy$ произн#%cname1$ слова заклинания и стал#%cname$ меняться прямо на глазах: е#%cname2$ раны исчезли, зрение восстановилось, а разная порча ушла.
вздоровье=вздоровье+вплюс
if вздоровье>вмаксздоровье then вздоровье=вмаксздоровье
вяд=0
вточность=вточность+вслезливость
вслезливость=0
впроклятие=0
enemyspellwait=0
end

:fightenemyspellingstearing
if впол=1 then instr cname=
if впол=2 then instr cname=а if впол=3 then instr cname=о
pln #%enemy$ прошептал#%cname$ слова заклинания "Слезливость" и вы почувствовали, что ваши глаза начинают слезиться, а взор мутнеет. Ваша точность ухудшается.
слезливость=слезливость+2
точность=точность-2
if плюскточности=0 then плюскточности=-2
if плюскточности<>0 then плюскточности=плюсточности-2
if точность<0 then плюскточности=плюскточности+(0-точность) & слезливость=слезливость+(0-точность) & точность=0
enemyspellwait=0
end

:fightenemyspellingstone
fightthrowstones=0
fightstones=fightstones-1
p Назойливый #%enemy$ кидает в вас большой камень, 
if вточность*1.5<=ловкость then pln но вы успеваете увернуться.
if вточность*1.5>ловкость then p который попадает вам в 
if rnd<0.333333 and вточность*1.5>ловкость then p в ноги & Style_Dos_TextColor=12 & p (-1) & Style_Dos_TextColor=7 & pln .& play kick.wav & pause 360
if rnd>0.333332 and rnd<0.666666 and вточность*1.5>ловкость then p в туловище & Style_Dos_TextColor=12 & p (-1) & Style_Dos_TextColor=7 & pln .& play kick.wav & pause 360
if rnd>0.666665 and вточность*1.5>ловкость then p в голову & Style_Dos_TextColor=12 & p (-1) & Style_Dos_TextColor=7 & pln .& play kick.wav & pause 360
enemyspellwait=0
end

:fightshock
требуемаямана=(6-белмагия)
if требуемаямана<2 then требуемаямана=1
if мана<=требуемаямана+0.8 then pln У вас недостаточно маны для этого заклинания. & goto fightchoseaction
act=3
мана=мана-требуемаямана
pln #%name$ крестится и начинает колдовать заклинание "Удар шоком".
spellcasting=0
spellwait=1
goto fightbegin
end

:fightdeadhand
требуемаямана=(4-чёрмагия)
if требуемаямана<2 then требуемаямана=1
if мана<=требуемаямана+0.8 then pln У вас недостаточно маны для этого заклинания. & goto fightchoseaction
мана=мана-требуемаямана
act=0
вбодрость=вбодрость-(3+чёрмагия)
вздоровье=вздоровье-чёрмагия
вловкость=вловкость-1
spellwait=0
spellcasting=0
опытчёрмагии=опытчёрмагии+1
if опытчёрмагии=нужныйопытчёрмагии and чёрмагия<14 then чёрмагия=чёрмагия+1 & опытчёрмагии=0
if опытчёрмагии=нужныйопытчёрмагии and чёрмагия<14 then чёрмагия=чёрмагия+1 & опытчёрмагии=0 & нужныйопытчёрмагии=999999
p #/$#%name$ поднимает свою руку и произносит заклинание. Лицо #%enemy1$ бледнеет и на нём выступает пот. Ваш враг падает и начинает корчиться в муках. 
if впол=1 then p Он 
if впол=2 then p Она 
if впол=3 then p Оно 
p обхватывает шею руками, пытаясь стянуть с себя невидимую "удавку", но у 
if впол=1 or впол=3 then p него 
if впол=2 then p неё 
p ничего, разумеется, не выходит. Когда сила заклинания иссякает и #%name$ опускает руку, 
if вздоровье<1 then pln умерший от удушья #%enemy$, уже бездыханно лежит.
if вздоровье>0 and вбодрость<1 then pln #%enemy$ всё ещё лежит на полу, пытаясь набрать в лёгкие воздуха.
if вздоровье>0 and вбодрость>1 then pln #%enemy$, с синим, как у мертвеца лицом, шатаясь, поднимается на ноги.
goto fightbegin
end

:fightsmart
требуемаямана=(4-красмагия)
if требуемаямана<2 then требуемаямана=1
if мана<=требуемаямана+0.8 then pln У вас недостаточно маны для этого заклинания. & goto fightchoseaction
мана=мана-требуемаямана
act=0
if плюскскорости=0 then плюскскорости=2+красмагия
if плюскскорости<>0 then плюскскорости=плюскскорости+2+красмагия
скорость=скорость+плюскскорости
spellwait=0
spellcasting=0
опыткрасмагии=опыткрасмагии+1
if опыткрасмагии=нужныйопыткрасмагии and красмагия<14 then красмагия=красмагия+1 & опыткрасмагии=0
if опыткрасмагии=нужныйопыткрасмагии and красмагия<14 then красмагия=красмагия+1 & опыткрасмагии=0 & нужныйопыткрасмагии=999999
pln #%name$ колдует заклинание "Пылкость" и видит, как всё вокруг него сгорает высоким пламенем. Насытившись такой пищей, огонь поднимается всё выше и выше, окутывая вас во что-то вроде кокона. Закутав вас так, что не видно даже вашей макушки, пламя через рот попадает внутрь вас. #%name$ чувствует тепло внутри себя, но не более того. Приятное и питательное тепло... Когда огонь полностью впитывается в вас, ваше тело настолько полно энергии, что способно выжимать из своих мышц всё и даже больше. #%name$ становится чрезвычайно быстр.
goto fightbegin
end

:fightstearing
требуемаямана=(7-синмагия)
if требуемаямана<2 then требуемаямана=1
if мана<=требуемаямана+0.8 then pln У вас недостаточно маны для этого заклинания. & goto fightchoseaction
act=3
мана=мана-требуемаямана
pln #%name$ начинает колдовать заклинание "Слезливость". По телу пробежал приятный холодок.
spellcasting=0
spellwait=1
goto fightbegin
end

:fightbranch
требуемаямана=(5-зелмагия)
if требуемаямана<2 then требуемаямана=1
if мана<=требуемаямана+0.8 then pln У вас недостаточно маны для этого заклинания. & goto fightchoseaction
мана=мана-требуемаямана
act=3
pln #%name$ начинает колдовать заклинание "Опутывающие ветви". Повсюду начинает пахнуть благовониями.
spellcasting=0
spellwait=1
goto fightbegin
end

:fightaiming
требуемаямана=(4-зелмагия)
if требуемаямана<2 then требуемаямана=1
if мана<=требуемаямана+0.8 then pln У вас недостаточно маны для этого заклинания. & goto fightchoseaction
мана=мана-требуемаямана
act=3
pln #%name$ начинает колдовать заклинание "Исцеление". Повсюду начинает пахнуть благовониями.
spellcasting=0
spellwait=1
goto fightbegin
end

:fightluck
требуемаямана=(3-уровень)
if требуемаямана<1 then требуемаямана=0 if мана<=требуемаямана+0.8 then pln У вас недостаточно маны для этого заклинания. & goto fightchoseaction
мана=мана-требуемаямана
act=3
pln #%name$ начинает колдовать заклинание "Удача". Ваше сердце начинает биться чаще.
spellcasting=0
spellwait=1
goto fightbegin
end

:fightthornhand
if weaptype>0 then pln Вы не можете использовать это заклинание! & goto fightchoseaction
требуемаямана=(5-зелмагия)
if требуемаямана<2 then требуемаямана=1
if мана<=требуемаямана+0.8 then pln У вас недостаточно маны для этого заклинания. & goto fightchoseaction
мана=мана-требуемаямана
act=0плюс=2+зелмагия
if плюс>5 then плюс=5
сминатака=плюс
смаксатака=плюс+1
instr weapname=владения кастетом
instr weapexp=знаниекастета
weapbonus=знаниекастета
instr оружие=шипастая рука
weaptype=5
spellwait=0
spellcasting=0
опытзелмагии=опытзелмагии+1
if опытзелмагии=нужныйопытзелмагии and зелмагия<14 then зелмагия=зелмагия+1 & опытзелмагии=0
if опытзелмагии=нужныйопытзелмагии and зелмагия<14 then зелмагия=зелмагия+1 & опытзелмагии=0 & нужныйопытзелмагии=999999
p #%name$ произносит вслух текст заклинания "Шипастая рука" и удивлённ
if впол=1 then p ый 
if впол=2 then p ая 
if впол=3 then p ое 
pln #%enemy$ видит, как вашу руку начинают обвивать непонятно откуда взявшиеся стебли лианоподобного растения. Стебли плотно прижимаются друг к другу и переплетаются между пальцами. Когда всю вашу руку перекрывает это растение, из наружной стороны стеблей внезапно выскакивают очень острые и длинные шипы. Весь этот процесс происходит настолько быстро, что #%enemy$ не успевает ничего понять.
goto fightbegin
end

:fightusebranch
pln ______________________________________________________________________________
act=0
вловкость=вловкость-3
spellwait=0
spellcasting=0
опытзелмагии=опытзелмагии+1
if опытзелмагии=нужныйопытзелмагии and зелмагия<14 then зелмагия=зелмагия+1 & опытзелмагии=0
if опытзелмагии=нужныйопытзелмагии and зелмагия<14 then зелмагия=зелмагия+1 & опытзелмагии=0 & нужныйопытзелмагии=999999
p #/$#/$#%name$ ловкими движениями рук имитирует рост растения и произносит заклинание. Из земли напротив вашего противника с бешенной скоростью начинают расти лианоподобные ветви. Прежде, чем #%enemy$ успевает что-либо понять, ветви обвивают 
if впол=1 or впол=3 then p его 
if впол=2 then p её 
p ноги и руки. Некоторое время #%enemy$ будет пытаться вырвать с корнем обвивающие его лианы, ну, а пока, 
if впол=1 then p он 
if впол=2 then p она 
if впол=3 then p оно 
pln - прекрасная мишень.
confuse=1
confusetime=0
confuseending=2+зелмагия
if полученныйопыт<11 then confuseending=confuseending+2
if полученныйопыт>10 and полученныйопыт<21 then confuseending=confuseending+1
if confuseending>5 then confuseending=5
goto fightbegin
end

:fightuseaiming
pln ______________________________________________________________________________
act=0
здоровье=здоровье+зелмагия
if здоровье>максздоровье+0.9 then здоровье=максздоровье+0.9
яд=0
точность=точность+слезливость
слезливость=0
проклятие=0
spellwait=0
spellcasting=0
опытзелмагии=опытзелмагии+1
if опытзелмагии=нужныйопытзелмагии and зелмагия<14 then зелмагия=зелмагия+1 & опытзелмагии=0
if опытзелмагии=нужныйопытзелмагии and зелмагия<14 then зелмагия=зелмагия+1 & опытзелмагии=0 & нужныйопытзелмагии=999999
pln #/$#/$Вокруг вас начинается круговорот мелких листьев, излучающих зелёный свет. Начинает пахнуть мятой. Свет листьев питает вас энергией и убирает различные болезни. Через несколько секунд листья отдают всю свою энергию и падают сухими и жёлтыми, но вы чувствуете себя рождённым заново.
goto fightbegin
end

:fightuseluck
pln ______________________________________________________________________________
act=0
удача=удача+1+уровень
spellwait=0
spellcasting=0
pln #/$#/$#%name$ произносит слова заклинания "Удача" на тайном языке кобольдов. Язык этот слегка похож на козлиное мэканье, и человек просто не сможет на нём говорить, не запинаясь. Всё вокруг вас начинает играть яркими красками, а прямо над вашей головой появляется маленькая радуга. Закончив читать заклинание, #%name$ чувствует, что в этой битве ему будет сопутствовать удача.
goto fightbegin
end

:fightuseshock
pln ______________________________________________________________________________
act=0
вздоровье=вздоровье-(8+белмагия)
spellwait=0
spellcasting=0
опытбелмагии=опытбелмагии+1
if опытбелмагии=нужныйопытбелмагии and белмагия<14 then белмагия=белмагия+1 & опытбелмагии=0
if опытбелмагии=нужныйопытбелмагии and белмагия<14 then белмагия=белмагия+1 & опытбелмагии=0 & нужныйопытбелмагии=999999
p #/$#/$#%name$ поднимает руку, и та начинает блистать белым цветом. Прежде, чем противник успевает что-либо понять, из раскрытой ладони начинает бить поток электричества. Несколько секунд #%enemy$ корчится в муках, пока по 
if впол=1 or впол=3 then p нему 
if впол=1 then p ней 
pln проходят электролучи с огромным зарядом. & Style_Dos_TextColor=12 & p (-#8+белмагия$). & Style_Dos_TextColor=9 & p Когда заклинание иссякает, 
if вздоровье<1 then pln #%enemy$, а точнее та дымящаяся туша, что от него осталась, лежит бездыханно.
if вздоровье>вмаксздоровье*2/3 then pln #%enemy$ выглядит довольно дееспособно. Ваша молния не намного повредила ему.
if вздоровье<=вмаксздоровье*2/3 and вздоровье>1 then pln #%enemy$ выглядит уже как смертник. Независимо от того, выиграет он этот бой или нет, #%enemy$ всё равно умрёт от множества ран.
goto fightbegin
end

:fightusestearing
pln ______________________________________________________________________________
act=0
вточность=вточность-(1+синмагия)
вслезливость=вслезивость+1+синмагия
if вточность<0 then вслезливость=вслезливость+(0-вточность) & вточность=0
spellwait=0
spellcasting=0
опытсинмагии=опытсинмагии+1
if опытсинмагии=нужныйопытсинмагии and синмагия<14 then синмагия=синмагия+1 & опытсинмагии=0
if опытсинмагии=нужныйопытсинмагии and синмагия<14 then синмагия=синмагия+1 & опытсинмагии=0 & нужныйопытсинмагии=999999
p #%name$ колдует заклинание "Слезливость" и видит, как #%enemy$ начинает часто моргать и пытаться вытереть мокрые от воды глаза руками. Взгляд #%enemy1$ мутнеет и 
if впол=1 then p он 
if впол=2 then p она 
if впол=3 then p оно 
pln пытается атаковать вас, однако бьёт совершенно не в том направлении, где находитесь вы. Водяная пелена почти полностью ослепила #%enemy3$.
goto fightbegin
end

:fightchosespell
pln Заклинание какого цвета следует выбрать?
btn fightchosespellwhite, Белая магия
btn fightchosespellblack, Чёрная магия
btn fightchosespellblue, Синяя магия
btn fightchosespellred, Красная магия
btn fightchosespellgreen, Зелёная магия
if magicluck=1 then btn fightluck, Заклинание "Удача"
btn fightchoseaction, Вернуться
end

:fightchosespellwhite
pln Выберите одно из имеющихся у вас заклинаний белой магии.
if magicshock=1 then btn fightchoosespellwhiteshock, Удар шоком
btn fightchosespell, Вернуться
end

:fightchosespellblack
pln Выберите одно из имеющихся у вас заклинаний чёрной магии.
if magicdeadhand=1 then btn fightchoosespellblackdeadhand, Умерщвляющая рука
btn fightchosespell, Вернуться
end

:fightchosespellblue
pln Выберите одно из имеющихся у вас заклинаний синей магии.
if magicstearing=1 then btn fightchoosespellbluestearing, Слезливость
btn fightchosespell, Вернуться
end

:fightchosespellred
pln Выберите одно из имеющихся у вас заклинаний красной магии.
if magicsmart=1 then btn fightchoosespellredsmart, Пылкость
btn fightchosespell, Вернуться
end

:fightchosespellgreen
pln Выберите одно из имеющихся у вас заклинаний зелёной магии.
if magicbranch=1 then btn fightchoosespellgreenbranch, Опутывающие ветви
if magicthornhand=1 then btn fightchoosespellgreenthornhand, Шипастая рука
if magicaiming=1 then btn fightchoosespellgreenaiming, Исцеление
btn fightchosespell, Вернуться
end

:fightchoosespellwhiteshock
выборзаклинания=1
instr spell=shock
instr sorcery=Удар шоком
pln #%name$ взял заклинание "Удар шоком" на изготовку.
goto fightchoseaction
end

:fightchoosespellblackdeadhand
выборзаклинания=1
instr spell=deadhand
instr sorcery=Умерщвляющая рука
pln #%name$ взял заклинание "Умерщвляющая рука" на изготовку.
goto fightchoseaction
end

:fightchoosespellredsmart
выборзаклинания=1
instr spell=smart
instr sorcery=Пылкость
pln #%name$ взял заклинание "Пылкость" на изготовку.
goto fightchoseaction
end

:fightchoosespellbluestearing
выборзаклинания=1
instr spell=stearing
instr sorcery=Слезливость
pln #%name$ взял заклинание "Слезливость" на изготовку.
goto fightchoseaction
end

:fightchoosespellgreenbranch
выборзаклинания=1
instr spell=branch
instr sorcery=Опутывающие ветви
pln #%name$ взял заклинание "Опутывающие ветви" на изготовку.
goto fightchoseaction
end

:fightchoosespellgreenthornhand
выборзаклинания=1
instr spell=thornhand
instr sorcery=Шипастая рука
pln #%name$ взял заклинание "Шипастая рука" на изготовку.
goto fightchoseaction
end

:fightchoosespellgreenaiming
выборзаклинания=1
instr spell=aiming
instr sorcery=Исцеление
pln #%name$ взял заклинание "Исцеление" на изготовку.
goto fightchoseaction
end

:common_2
if dialog=0 and здоровье>0.9 then instr style_formpicture=heroimages/#%imagearmor$/#%imageshoes$/#%imagecap$/1.bmp
darklocs=0
kickclothes=0
instr ins=instr
if tavernstraiderrooms=1 and tavernstraiderroomday=day and tavernstraiderroommonth=month and tavernstraiderroomyear and tavernstraiderroomhour=hour then tavernstraiderrooms=0
steals=0
сундукхранения=0
if здоровье<1.9 then pln #$name$ умер от ран и ушибов... & goto gameover
if похмелье>0 then похмелье=похмелье-1
if похмелье=0 then интеллект=интдопохмелья & восприятие=восдопохмелья & похмелье=-1
if бодрость<1.7 then pln Вы очень устали!
if бодрость<1.6 and здоровье<4 and dangerplace=0 then pln От переутомления и слабости #%name$ потерял сознание. Он очнулся только через три часа и немного пришёл в себя. #/$ & бодрость=бодрость+1.5 & hour=hour+3 & изнеможение=0 & сила=голодсила+1 & голодсила=0 & ловкость=голодловкость+1 & голодловкость=0 & точность=голодточность+1 & голодточность=0 & скорость=голодскорость+1 & голодскорость=0 & удача=голодудача+1 & голодудача=0 & харизма=голодхаризма+1 & голодхаризма=0 & интеллект=голодинтеллект+1 & голодинтеллект=0 & восприятие=голодвосприятие+1 & голодвосприятие=0 & максмана=голодмана*3+3 & голодмана=0 & максздоровье=голодздоровье*3+3 & голодздоровье=0
if выносливость<1.5 then pln Вы ужасно хотите есть!
if выносливость<1 then pln Из-за голода #%name$ сильно устаёт. #/$ & выносливость=выносливость+0.4 & бодрость=бодрость-0.4
бодрость=бодрость-0.025
if бодрость<1.9 and сила>1 or бодрость<1.9 and ловкость>1 or бодрость<1.9 and точность>1 or бодрость<1.9 and скорость>1 or бодрость<1.9 and восприятие>1 or бодрость<1.9 and удача>1 or бодрость<1.9 and интеллект>1 or бодрость<1.9 and харизма>1 or бодрость<1.9 and максмана>3 or бодрость<1.9 and максздоровье>3 then p От сильного переутомления у вас 
if бодрость<1.9 and сила=1 and ловкость=1 and точность=1 and скорость=1 and восприятие=1 and удача=1 and интеллект=1 and харизма=1 and максмана=3 and максздоровье>3 then максздоровье=максздоровье-3 & голодздоровье=голодздоровье+1 & pln понизилось здоровье.
if бодрость<1.9 and сила=1 and ловкость=1 and точность=1 and скорость=1 and восприятие=1 and удача=1 and интеллект=1 and харизма=1 and максмана>3 then максмана=максмана-3 & голодмана=голодмана+1 & pln понизилась мана.
if бодрость<1.9 and сила=1 and ловкость=1 and точность=1 and скорость=1 and восприятие=1 and удача=1 and интеллект=1 and харизма>1 then харизма=харизма-1 & голодхаризма=голодхаризма+1 & pln понизилась харизма.
if бодрость<1.9 and сила=1 and ловкость=1 and точность=1 and скорость=1 and восприятие=1 and удача=1 and интеллект>1 then интеллект=интеллект-1 & голодинтеллект=голодинтеллект+1 & pln понизился интеллект.
if бодрость<1.9 and сила=1 and ловкость=1 and точность=1 and скорость=1 and восприятие=1 and удача>1 then удача=удача-1 & голодудача=голодудача+1 & pln понизилась удача.
if бодрость<1.9 and сила=1 and ловкость=1 and точность=1 and скорость=1 and восприятие>1 then восприятие=восприятие-1 & голодвосприятие=голодвосприятие+1 & pln понизилось восприятие.
if бодрость<1.9 and сила=1 and ловкость=1 and точность=1 and скорость>1 then скорость=скорость-1 & голодскорость=голодскорость+1 & pln понизилась скорость.
if бодрость<1.9 and сила=1 and ловкость=1 and точность>1 then точность=точность-1 & голодточность=голодточность+1 & pln понизилась точность.
if бодрость<1.9 and сила=1 and ловкость>1 then ловкость=ловкость-1 & голодловкость=голодловкость+1 & pln понизилась ловкость.
if бодрость<1.9 and сила>1 then сила=сила-1 & голодсила=голодсила+1 & pln понизилась сила.
if здоровье>максздоровье+0.9 then здоровье=максздоровье+0.9
if мана>максмана+0.9 then мана=максмана+0.9
if весоружия>0 then бодрость=бодрость-(весоружия/20-сила/30)
if весброни>0 then бодрость=бодрость-(весброни/20-сила/30)
if весшлема>0 then бодрость=бодрость-(весшлема/20-сила/30)
if весперчаток>0 then бодрость=бодрость-(весперчаток/20-сила/30)
if веспояса>0 then бодрость=бодрость-(веспояса/20-сила/30)
if весобуви>0 then бодрость=бодрость-(весобуви/20-сила/30)
выносливость=выносливость-0.025
if бодрость>максбодрость+0.9 then бодрость=максбодрость+0.9
sec=sec+10
if light=1 then lighttime=lighttime-1
if light=1 and lighttime<1 then light=0 & pln Огонь потух.#/$#/$
if sec>59 then minute=minute+1 & sec=sec-60
if minute>59 then hour=hour+1 & minute=minute-60
if hour>23 and Яблоко then годностьяблок=годностьяблок-1
if not Яблоко then годностьяблок=3
if hour>23 and Сырое_мясо then годностьмяса=годностьмяса-1
if not Сырое_мясо then годностьмяса=4
if hour>23 and Жаренное_мясо then годностьжмяса=годностьжмяса-1
if not Жаренное_мясо then годностьжмяса=4
if hour>23 then day=day+1 & hour=hour-24 
if day>7 and week=1 then week=2
if day>14 and week=2 then week=3
if day>21 and week=3 then week=4
if day>28 and week=4 then week=5
if month=1 then месяцдни=31
if month=2 then месяцдни=28
if month=3 then месяцдни=31
if month=4 then месяцдни=30
if month=5 then месяцдни=31
if month=6 then месяцдни=30
if month=7 then месяцдни=31
if month=8 then месяцдни=31
if month=9 then месяцдни=30
if month=10 then месяцдни=31
if month=11 then месяцдни=30
if month=12 then месяцдни=31

;Блин, это всё очень громоздко... Но URQ 1.4 жутко тупит, а игра-то везде должна идти.

if day>месяцдни then month=month+1 & week=week-3 & day=day-месяцдни
if month>12 then year=year+1 & month=month-12
if month=1 then месяцдни=31 & instr месяц=январь& instr месяцдень1=суббота& instr месяцдень2=восскресенье& instr месяцдень3=понедельник& instr месяцдень4=вторник& instr месяцдень5=среда& instr месяцдень6=четверг& instr месяцдень7=пятница
if month=2 then месяцдни=28 & instr месяц=февраль& instr месяцдень1=вторник& instr месяцдень2=среда& instr месяцдень3=четверг& instr месяцдень4=пятница& instr месяцдень5=суббота& instr месяцдень6=восскресенье& instr месяцдень7=пятница
if month=3 then месяцдни=31 & instr месяц=март& instr месяцдень1=понедельник& instr месяцдень2=вторник& instr месяцдень3=среда& instr месяцдень4=четверг& instr месяцдень5=пятница& instr месяцдень6=суббота& instr месяцдень7=восскреснье
if month=4 then месяцдни=30 & instr месяц=апрель& instr месяцдень1=четверг& instr месяцдень2=пятница& instr месяцдень3=суббота& instr месяцдень4=восскресенье& instr месяцдень5=понедельник& instr месяцдень6=вторник& instr месяцдень7=среда
if month=5 then месяцдни=31 & instr месяц=май& instr месяцдень1=суббота& instr месяцдень2=восскресенье& instr месяцдень3=понедельник& instr месяцдень4=вторник& instr месяцдень5=среда& instr месяцдень6=четверг& instr месяцдень7=пятница
if month=6 then месяцдни=30 & instr месяц=июнь& instr месяцдень1=вторник& instr месяцдень2=среда& instr месяцдень3=четверг& instr месяцдень4=пятница& instr месяцдень5=суббота& instr месяцдень6=восскреснье& instr месяцдень7=понедельник
if month=7 then месяцдни=31 & instr месяц=июль& instr месяцдень1=четверг& instr месяцдень2=пятница& instr месяцдень3=суббота& instr месяцдень4=восскресенье& instr месяцдень5=понедельник& instr месяцдень6=вторник& instr месяцдень7=среда
if month=8 then месяцдни=31 & instr месяц=август& instr месяцдень1=восскресенье& instr месяцдень2=понедельник& instr месяцдень3=вторник& instr месяцдень4=среда& instr месяцдень5=четверг& instr месяцдень6=пятница& instr месяцдень7=суббота
if month=9 then месяцдни=30 & instr месяц=сентябрь& instr месяцдень1=среда& instr месяцдень2=четверг& instr месяцдень3=пятница& instr месяцдень4=суббота& instr месяцдень5=восскресенье& instr месяцдень6=понедельник& instr месяцдень7=вторник
if month=10 then месяцдни=31 & instr месяц=октябрь& instr месяцдень1=пятница& instr месяцдень2=суббота& instr месяцдень3=восскреснье& instr месяцдень4=понедельник& instr месяцдень5=вторник& instr месяцдень6=среда& instr месяцдень7=четверг
if month=11 then месяцдни=30 & instr месяц=ноябрь& instr месяцдень1=понедельник& instr месяцдень2=вторник& instr месяцдень3=среда& instr месяцдень4=четверг& instr месяцдень5=пятница& instr месяцдень6=суббота& instr месяцдень7=восскреснье
if month=12 then месяцдни=31 & instr месяц=декабрь& instr месяцдень1=среда& instr месяцдень2=четверг& instr месяцдень3=пятница& instr месяцдень4=суббота& instr месяцдень5=восскресенье& instr месяцдень6=понедельник& instr месяцдень7=вторник

if day=1 and year=1764 or day=8 and year=1764 or day=15 and year=1764 or day=22 and year=1764 or day=29 and year=1764 then instr день=#%месяцдень1$
if day=2 and year=1764 or day=9 and year=1764 or day=16 and year=1764 or day=23 and year=1764 or day=30 and year=1764 then instr день=#%месяцдень2$
if day=3 and year=1764 or day=10 and year=1764 or day=17 and year=1764 or day=24 and year=1764 or day=31 and year=1764 then instr день=#%месяцдень3$
if day=4 and year=1764 or day=11 and year=1764 or day=18 and year=1764 or day=25 and year=1764 then instr день=#%месяцдень4$
if day=5 and year=1764 or day=12 and year=1764 or day=19 and year=1764 or day=26 and year=1764 then instr день=#%месяцдень5$
if day=6 and year=1764 or day=13 and year=1764 or day=20 and year=1764 or day=27 and year=1764 then instr день=#%месяцдень6$
if day=7 and year=1764 or day=14 and year=1764 or day=21 and year=1764 or day=28 and year=1764 then instr день=#%месяцдень7$

if valmesdie=0 and tavernstraiderrooms=1 and tavernstraiderroomday=day and tavernstraiderroomhour=hour and tavernstraiderroommonth=month and tavernstraiderroomyear=year then tavernstraiderrooms=0
end

:about
pln Выражаю благодарность Виктору Корянову, Евгению Бычкову, Elven Ranger'у и DroZ'у за тестирование игры и помощь при разработке.#/$
pln Трион - это текстовая ролевая игра в стиле фэнтези. Для игры необходим интерпретатор текстовых квестов Universal Ripsoft Quest версии 1.4 или URQ_DOS версии 130b4ds5b или выше. Действие игры происходит в Трионе - фэнтезийном мире, населённом десятками различных рас и сотнями видов монстров. Цель игры - спасти этот мир, а от чего и как, станет ясно во время прохождения. При новой игре, вам нужно будет выбрать одну из 20 доступных рас и свою склонность к силе или магии. Затем вам предстоит выбрать стартовую точку персонажа (в демо-версии доступна лишь одна такая точка).
btn about2, Дальше
btn mainmenu, Вернуться в главное меню
end

:about2
pln Все действия в игре производятся при нажатии на кнопки. С каждым предметом в инвентаре можно совершить хотя бы одно действие. Предмет "Инвентарь" отвечает за использование способности "Воровство", просмотр статуса и управление опциями игры. Здесь вы также сможете просмотреть точное время и дату в игре, просмотреть свои характеристики и статус, выключить/включить фоновую музыку и начать игру с начала.
btn about3,Дальше
btn mainmenu, Вернуться в главное меню
end

:about3
pln После каждого вашего действия, кроме просмотра инвентаря, проходит определённое время. Чаще всего, это - 10 секунд. В игре многое зависит от времени, даже описание локации меняется в зависимости от того, когда вы на неё попали. Когда проходит 30 (или 31) день, меняется месяц. Также некоторое оружие действует лучше днём или ночью.
btn about4, Дальше
btn mainmenu, Вернуться в главное меню
end

:about4
pln Навыки персонажа делятся на три группы: характеристики, умения и магия. К характеристикам относятся сила, ловкость, точность, скорость, удача, здоровье, бодрость, выносливость, интеллект, харизма, восприятие и мана. Чтобы повышать свои характеристики, нужно зарабатывать опыт в сражениях или квестах и повышать свой уровень. К умениям относятся воровство, торговля, а также владение мечами и кинжалами, посохами и копьями, кастетами, тупым оружием, топорами и рукопашной. К магии относятся белая, чёрная, красная, синяя и зелёная школы. Чтобы повышать свои умения или магию, нужно просто постоянно их использовать.
btn about5, Дальше
btn mainmenu, Вернуться в главное меню
end

:about5
pln Сила - скорость уставаемости, количество повреждений, возможность   ношения оружия.
pln #/$Ловкость - шанс увернуться от удара.
pln #/$Точность - противовес к ловкости.
pln #/$Скорость - при удачном соотношении вашей скорости и скорости противника, вы сможете атаковать по нескольку раз за ход.
pln #/$Удача - шанс найти что-либо. Слегка влияет на попадание и
увёртливость.
pln #/$Здоровье - индикатор вашей жизненной силы.
pln #/$Бодрость - индикатор усталости, восстанавливается при сне.
pln #/$Выносливость - индикатор голода, восстанавливается при приёме пищи.
pln #/$Интеллект - влияет на опознавание. Нужен для познания заклинаний. При малом интеллекте вы не можете общаться.
pln #/$Харизма - влияет на количество получаемого опыта и на отношение окружающих существ к вам.
pln #/$Восприятие - шанс просмотра статуса существа.
pln #/$Мана - индикатор магического резерва игрока.
btn about6, Дальше
btn mainmenu, Вернуться в главное меню
end

:about6
pln Существуют пять типов магии: белая, чёрная, красная, синяя и зелёная. У каждой из них есть своя собственная система заклинаний. Для использования заклинания, его нужно сначала изучить (обычно это можно сделать за деньги у любого волшебника), а затем использовать в бою. Каждое заклинание требует определённое количество маны, зависящее от уровня магии соответствующего цвета. Все заклинания в игре делятся на две группы: моментальные и кастующиеся не один ход. Если моментальное заклинание действует, как только вы его использовали, то чтобы использовать немоментальное, нужно пропустить некоторое количество ходов.
btn about7, Дальше
btn mainmenu, Вернуться в главное меню
end

:about7
pln Все существа делятся на маленьких, средних и огромных. Огромные существа обычно сильнее, но они не могут носить никакую броню и обычное оружие. Также размер врага влияет на то, по какой части тела вы ему попадёте. Некоторые существа, например сатиры, не могут надевать что-либо на ноги или на голову, притом, что они нормального роста. Всего, существуют восемь частей тела, на которые можно что-то надеть: голова, тело с ногами, ступни, шея, руки и три пальца. Оружие в игре не надевается, а выбирается из имеющегося перед началом сражения. Чтобы носить любое оружие, нужна определённая сила. При этом, даже обладая большой силой, вы сможете носить не более двух одноручных оружий. Тоже самое относиться ко второй броне, шлему, обуви. Чтобы хранить вторые комплекты (да и облегчить их), нужен мешок. Мешок позволяет складывать в него небольшое оружие, но при этом сам занимает одну руку.
btn mainmenu, Вернуться в главное меню
end

:advices
pln Для самых нетерпеливых есть один совет - как говорил Яша (герой легендарной эпопеи): "Туты главное кнопоцьки понажимать".#/$Если вы увидите где-нибудь баг, посылайте инфу о нём на мой е-мэйл tqstru@tqst.ru - буду очень благодарен.
pln Просто так: #/$Читайте Толкиена, Перумова... В общем, фэнтези читайте!
btn mainmenu, В главное меню
end

:newgame
magicshock=0
magicdeadhand=0
magicstearing=0
magicsmart=0
magicbranch=0
Image=0
pln                                 Выберите расу.
btn newhuman, Человек
btn newelf, Эльф
btn newhelf, Полу-эльф
btn newdelf, Тёмный эльф
btn newdwarf, Гном
btn newhobbit, Хоббит
btn neworc, Орк
btn newhorc, Полу-орк
btn newkobold, Кобольд
btn newgib, Гибберлин
btn newgoblin, Гоблин
btn newgiant, Гигант
btn newdevil, Дьявол
btn newhdevil, Полудьявол
btn newmino, Минотавр
btn newogr, Огр
btn newsatyr, Сатир
btn newdragon, Дракон
btn newduott, Дуотт
btn newent, Энт
btn newrandom, Случайная раса
btn newgod, Бог :)
end

:newrandom
число=10
proc rnd
if рнд=1 then goto newhuman
if рнд=2 then goto newelf
if рнд=3 then goto newhelf
if рнд=4 then goto newdelf
if рнд=5 then goto newdwarf
if рнд=6 then goto newhobbit
if рнд=7 then goto neworc
if рнд=8 then goto newhorc
if рнд=9 then goto newkobold
if рнд=10 then goto newgib
if рнд=11 then goto newgoblin
if рнд=12 then goto newgiant
if рнд=13 then goto newdevil
if рнд=14 then goto newhdevil
if рнд=15 then goto newmino
if рнд=16 then goto newogr
if рнд=17 then goto newsatyr
if рнд=18 then goto newdragon
if рнд=19 then goto newduott
if рнд=20 then goto newent
goto newrandom
end

:newgod
image=1
instr race=бог
раса=1
размер=2
pln Этот чит-режим создан специально для того, чтобы почувствовать все скрытые прелести демки Триона. Все характеристики, магия и умения равны 99.
торговля=99
воровство=99
знаниемеча=99
знаниепалицы=99
знаниешеста=99
знаниетопора=99
знаниекастета=99
знаниекулака=99
броняног=0
бронятела=0
броняголовы=0
сила=99
точность=99
восприятие=99
ловкость=99
удача=99
харизма=99
скорость=99
интеллект=99
максздоровье=297
максмана=297
максвыносливость=297
максбодрость=297
зелмагия=99
синмагия=99
красмагия=99
чёрмагия=99
белмагия=99
бодрость=99
здоровье=99
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newhuman
image=1
instr race=человек
раса=1
размер=2
pln Люди, они же Хумансы. Презираемые многими народами, в частности некоторыми племенами эльфов, люди - единственные существа, которые воюют как за одну сторону, так и за другую. Почти все народы живут дольше людей. Основная человеческая слабость - генная жажда Власти. 
pln #/$ Все ваши характеристики равны 1, интеллект равен 2. Вы - чистокровное создание нормального роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=1
точность=1
восприятие=1
ловкость=1
удача=1
харизма=1
скорость=1
интеллект=2
максздоровье=3
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newelf
image=2
instr race=эльф
раса=2
размер=2
pln Эльфы, они же Перворождённые. Не смотря на то, что попали в Трион одновременно со всеми другими расами, называют себя Перворождёнными. Являются бессмертными, то есть совершенно не стареют, хотя могут умереть в бою. Имеют своё собственное понятие о возрасте - к примеру, триста лет для них - ещё юность. Основная слабость эльфов - их непомерная гордыня и ненависть к тёмным эльфам.
pln #/$ Ваша зелёная магия изначально повышена. Имеете минус к силе, но плюс к ловкости, точности, скорости и восприятию. Вы - чистокровное создание нормального роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=0
точность=2
восприятие=2
ловкость=2
харизма=0
удача=0
скорость=2
интеллект=1
максздоровье=3
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=1
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newhelf
image=3
instr race=полу-эльф
раса=3
размер=2
pln Полу-эльфы - это смесь человека и эльфа. От эльфов им в наследство досталось бессмертие, ловкость и восприятие, а вместе тем и их гордыня и презрение любых смертных. Между тем, тело полу-эльфа менее утончённое и тонкое, чем у обычного эльфа и у них имеется вся человеческая сила. В помеси с человеческой, эльфийская кровь потеряла всю свою природную эльфийскую магию. 
pln #/$ Вы имеете плюс к ловкости, точности и восприятию, а также обычную скорость и силу. Вы - нечистокровное создание нормального роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=1
точность=2
восприятие=2
ловкость=2
харизма=0
удача=0
скорость=1
интеллект=1
максздоровье=3
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=1
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newdelf
image=4
instr race=тёмный эльф
раса=4
размер=2
pln Тёмные эльфы, они же Перворождённые. В отличие от светлых эльфов, почитающих зелёных драконов, тёмные эльфы поклоняются гидрам. Являются бессмертными, то есть совершенно не стареют, хотя могут умереть в бою. Имеют своё собственное понятие о возрасте - к примеру, триста лет для них - ещё юность. Основная слабость тёмных эльфов - их непомерная гордыня и ненависть к светлым эльфам.
pln #/$ Ваша чёрная и зелёная магии изначально повышены. Имеете минус к силе, но плюс к ловкости, точности и восприятию. Вы - чистокровное создание нормального роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=0
точность=2
восприятие=2
ловкость=2
харизма=0
удача=0
скорость=1
интеллект=1
максздоровье=3
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=1
синмагия=0
красмагия=0
чёрмагия=1
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newdwarf
image=5
instr race=гном
раса=5
размер=1
pln Гномы, они же карлики, они же Подгорное племя. Если эльфы в бою могут струсить и сбежать, люди реже теряют голову в панике и чаще бьются до конца, то среди гномов трусов нет совсем - они рады умереть ради своего общего дела. Эти небольшие бородатые существа лишь кажутся уязвимыми - на самом деле они сильны, как гора, которая когда-то их и породила. К тому же гномы - превосходные торговцы и знатоки топора. Правда, есть у них и слабости - они медлительны и неповоротливы, а также абсолютно лишены дара волшебства.
pln #/$ Ваши мастерства торговли и владения топором изначально повышены. Имеете большой плюс к силе, жизненной силе и бодрости, но минусы к ловкости, точности, восприятию, мане и не можете стать на путь магии. Вы - чистокровное создание маленького роста.
торговля=1
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=1
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=3
точность=1
восприятие=0
ловкость=0
харизма=0
удача=0
скорость=1
интеллект=1
максздоровье=6
максмана=0
максвыносливость=0
максбодрость=6
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=1
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newhobbit
image=6
instr race=хоббит
раса=6
размер=1
pln Хоббиты, они же невысоклики, они же половинчики. В большей степени спокойный, фермерский, не любящий приключений народ. Живут себе в норе и питаются пять раз на день. Но бывает, что среди них появляется какой-нибудь бойкий малый, который не может усидеть на одном месте. Вот тогда и проявляется их спящее веками в крови и передаваемое из поколения в поколение, воинское искусство. Хоббиты превосходно владеют кинжалами и кастетами, очень точны и ловки, хоть и не выносливы. А также, хоббиты - прирождённые воры.
pln #/$ Ваши мастерства воровства, владения мечом и кастетом изначально повышены. Имеете большой плюс к точности и ловкости, но минус к жизненной силе. Вы - чистокровное создание маленького роста.
торговля=0
воровство=1
знаниемеча=1
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=1
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=1
точность=3
восприятие=0
ловкость=1
харизма=0
удача=0
скорость=2
интеллект=1
максздоровье=0
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:neworc
image=7
instr race=орк
раса=7
размер=2
pln Орки - одно из первых племён зеленокожих в Трионе. Существуют три теории их появления: первая - они полулюди-полукабаны (у некоторых особей на лице чётко выражены черты кабана), вторая - то, что первые орки были эльфами, попавшими в плен и потерявшими свой благородный облик и душу во время пыток (это объясняет природную ненависть орков к эльфам, к тому же у орков, как и у эльфов заострённые уши), и, наконец, третья теория гласит, что орки - это полностью чистокровная раса и попала в Трион точно так же, как и все остальные, но слегка опоздав (века на два).
pln #/$Вы, как и все зеленокожие - воинственное племя. Каждое поколение орков - это воины, а это не может не оставить отпечаток в крови. Дети орков начинают играть со своим первым топориком ещё до того, как встают на ноги. Отличаются всеми физическими характеристиками, но чрезвычайно глупы. Вы - чистокровное создание нормального роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=1
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=3
точность=2
восприятие=1
ловкость=1
харизма=0
удача=0
скорость=2
интеллект=0
максздоровье=3
максмана=0
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=1
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newhorc
image=8
instr race=полу-орк
раса=8
размер=2
pln Полу-орки, они же Урукхаи. Их черты лица более правильные, клыки, хоть и острее, чем у людей, но не так сильно выпирают из-под нижней губы. Кожа либо светло-зелёного, либо коричневого цвета, в зависимости от цвета кожи отца(матери)-человека. В цивилизованном обществе их примерно столько же, сколько и остальных человекоподобных рас. Чаще всего работают телохранителями, бандитами или являются слугами. Сильнее обычного человека, но страстью к человеческому мясу не обладают.
pln #/$Вы умнее своих звероподобных предков, сильны, более удачливы, хоть и теряете своё врождённое умение владения оружием. Вы - нечистокровное создание нормального роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=2
точность=2
восприятие=1
ловкость=1
харизма=0
удача=1
скорость=2
интеллект=1
максздоровье=3
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newkobold
image=9
instr race=кобольд
раса=9
размер=2
pln Кобольды - это подгорное племя наполовину орков, наполовину сатиров. Занимаются исключительно охотой (в этом им помогают их копыта), среди людей появляются довольно редко. Прекрасно владеют копьями и имеют самую, что ни на есть обыкновенную, удачливость. Ловки и быстры, однако тонкие ноги - их основная слабость.
pln #/$Вы ловки, быстры, да и сильнее обычного человека. Ваши копыта не позволяют вам надевать что-либо на ноги. Вы - нечистокровное создание нормального роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=1
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=-1
бронятела=0
броняголовы=0
сила=2
точность=2
восприятие=1
ловкость=2
харизма=1
удача=1
скорость=2
интеллект=0
максздоровье=3
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=1
копыта=1
btn newabilities, Дальше
btn newgame, Назад
end

:newgib
image=10
instr race=гибберлин
раса=10
размер=1
pln Гибберлины - это смесь хоббита с орком. Маленькие смуглые создания неприятной внешности чаще всего служат ворами или шпионами. Из оружия предпочитают кинжалы. В толпе их просто невозможно заметить - быстро шныряют между ходящими, попутно срезая их кошельки.
pln #/$Вы точны, быстры, являетесь хорошими ворами и неплохо владеете мечами и кинжалами. Вы - нечистокровное создание маленького роста.
торговля=0
воровство=1
знаниемеча=1
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=1
точность=3
восприятие=0
ловкость=1
харизма=0
удача=0 скорость=3
интеллект=1
максздоровье=0
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=1
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newgoblin
image=11
instr race=гоблин
раса=11
размер=1
pln Гоблины - это маленькие зеленокожие создания. В отличие от своих сородичей орков, гоблины не так воинственны, часто исполняют мирную работу. Чаще всего работают шахтёрами, хотя, бывает, что и слугами.
pln #/$Вы ничем особенным не выделяетесь, но и ничем не отстаёте от остальных рас. Вы - чистокровное создание маленького роста. С детства умеете хорошо орудовать палицами, как и все из вашего рода.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=1
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=2
точность=2
восприятие=0
ловкость=2
харизма=0
удача=1
скорость=2
интеллект=0
максздоровье=0
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=1
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newgiant
image=12
instr race=гигант
раса=12
размер=3
pln Гиганты, они же титаны. Огромные люди, живущие на юге. По росту достигают до пятнадцати метров, имеют грубые варварские черты лица. На своей родине охотятся на птиц Рух, тем самым добывая себе пищу. Имеют собственное независимое ни от кого королевство. 
pln #/$Вы имеете большую силу, здоровье, бодрость и выносливость, однако в силу своего размера вы медлительны, неточны, неловки и не обладаете большой харизмой. Вы умны, а ваше восприятие повышено благодаря острым как у орла глазам. Вы не можете использовать магию. Вы - чистокровное создание огромного роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
 броняног=0
бронятела=0
броняголовы=0
сила=3
точность=1
восприятие=2
ловкость=0
харизма=0
удача=0
скорость=1
интеллект=1
максздоровье=9
максмана=0
максвыносливость=6
максбодрость=6
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=3
выборзаклинания=0
magicno=1
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newdevil
image=13
instr race=дьявол
раса=13
размер=3
pln Дьяволы - это высшие демоны Преисподней. Громадные, покрытые рогами, эти существа очень сильны. Вместо воды пьют лаву. Имеют некоторую власть над огнём и считают своими природными врагами ангелов.
pln #/$Вы чертовски сильны и, при этом, довольно быстры. Имеете плюс к красной магии, но из-за огромного роста не можете что-либо надеть. Вы - чистокровное создание огромного роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=4
точность=1
восприятие=0
ловкость=0
харизма=0
удача=0
скорость=2
интеллект=1
максздоровье=6
максмана=3
максвыносливость=6
максбодрость=3
зелмагия=0
синмагия=0
красмагия=1
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=1
btn newabilities, Дальше
btn newgame, Назад
end

:newhdevil
image=14
instr race=полудьявол
раса=14
размер=2
pln Полудьяволы, смесь человека и дьявола, внешне ничем не отличаются от обычных людей. Однако в них скрыта внутренняя нелюдская сила. Довольно часто полудьяволы сами не знают, что они не люди. Тем не менее, они сильнее обычных людей, точнее и быстрее.
pln #/$Вы имеете плюсы к точности, скорости, силе. Хорошо владеете красной магией. Вы - нечистокровное создание нормального роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=2
точность=2
восприятие=1
ловкость=1
харизма=0
удача=0 скорость=2
интеллект=1
максздоровье=3
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newmino
image=15
instr race=минотавр
раса=15
размер=2
pln Минотавры - полулюди-полубыки, славятся своей силой и удачей в бою. С самого рождения их единственная игрушка - боевой топор. Минотавров-магов довольно мало, так как с рождения эти создания не получают магической силы.
pln #/$У вас большая сила, удача, умение владения топором. Ваши копыта не позволяют вам надевать что-либо на ноги. У вас понижена мана. Вы - чистокровное создание нормального роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=1
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=3
точность=1
восприятие=0
ловкость=1
харизма=0
удача=2
скорость=2
интеллект=1
максздоровье=3
максмана=0
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=1
btn newabilities, Дальше
btn newgame, Назад
end

:newogr
image=16
instr race=огр
раса=16
размер=3
pln Огры, они же людоеды. Цвет кожи - зелёный, розоватый, тёмно-красный, в зависимости от местности. Чаще всего лысые, живут в горах. Ростом примерно в три метра, питаются исключительно мясом. Так как кроме коз в горах трудно что-либо найти, человек для них - деликатес. Свою неповоротливость компенсируют силой.
pln #/$У вас огромные сила, здоровье, большая бодрость, но остальные характеристики очень низкие. Вы - чистокровное создание огромного роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=5
точность=1
восприятие=0
ловкость=0
харизма=0 удача=0
скорость=1
интеллект=0
максздоровье=9
максмана=0
максвыносливость=3
максбодрость=6
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=3
выборзаклинания=0
magicno=0
зеленокожий=1
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newsatyr
image=17
instr race=сатир
раса=17
размер=2
pln Сатиры - чертовски удачливые существа, обычно занимающиеся торговлей. Живут среди людей, хотя встречаются и лесные поселения сатиров. На голове растут бараньи рожки, на волосатых ногах - копытца.
pln #/$Все ваши характеристики немного приподняты, особенно большая удача и мастерство торговли - сатиры бесспорные лидеры по заговариванию зубов. Вам с рождения доступно заклинание "Удача". Однако сила, ловкость и здоровье очень малы. Ваши копыта не позволяют вам надевать что-либо на ноги, а также являются очень уязвимым местом. Вы - чистокровное создание нормального роста.
торговля=2
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=-1
бронятела=0
броняголовы=0
сила=1
точность=1
восприятие=1
ловкость=0
харизма=1
удача=3
скорость=1
интеллект=1
максздоровье=0
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=1
magicluck=1
inv+ Заклинания
btn newabilities, Дальше
btn newgame, Назад
end

:newdragon
image=18
instr race=дракон
раса=18
размер=3
pln Драконы - хранители знаний, стражи сокровищ. Вылупившись из яйца, драконы растут примерно до трёхсот лет. После они улетают в какую-то пещеру со всеми собранными сокровищами.
pln #/$Вы очень сильны и имеете познания во всех пяти областях магии. Ваша кожа вся покрыта крепкой чешуёй, что создаёт природные доспехи. Однако, из-за телосложения, вы не можете брать любое оружие или надевать на себя какие-либо вещи. Вы - чистокровное создание огромного роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=1
бронятела=1
броняголовы=1
сила=3
точность=1
восприятие=1
ловкость=0
харизма=0
удача=0
скорость=1
интеллект=2
максздоровье=0
максмана=3
максвыносливость=3
максбодрость=3
зелмагия=1
синмагия=1
красмагия=1
чёрмагия=1
белмагия=1
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=1
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newduott
image=19
instr race=дуотт
раса=19
размер=2
pln Дуотты - одна из самых малочисленных рас в Трионе. Основав в пустыне одно единственное государство, и никуда из него не выходя, дуотты никого в него и не пускают. С этими однополыми полуящерами ни одно государство не держит мир, так как знают - эта раса живёт войной. Каждый второй дуотт - некромант, так как дуотты считают чёрную магию наиболее действенной во время битвы.
pln #/$Ваши характеристики выше среднего, в особенности сила, точность, мана и интеллект, но вы излучаете очень плохую харизму. У вас хорошее знание чёрной магии. Вы - чистокровное существо нормального роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=2
точность=2
восприятие=1
ловкость=1
харизма=-1
удача=0
скорость=1
интеллект=2
максздоровье=0
максмана=6
максвыносливость=3
максбодрость=3
зелмагия=0
синмагия=0
красмагия=0
чёрмагия=1
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newent
image=20
instr race=энт
раса=20
размер=3
pln Энты, они же древни, они же дендроиды, они же древопасы. Так как онты - тоже деревья, то имеют внутреннюю силу леса. Энты - довольно добродушные создания, однако питают давнюю неприязнь ко всем зеленокожим. В принципе, у онтов есть целое государство, имеющее серьёзную силу и постоянно увеличивающееся - это их огромный лес. И они части этого леса.
pln #/$Все ваши характеристики, кроме ловкости и скорости, на уровне. При этом у вас неплохая сила, выносливость и интеллект. Вы имеете плюс к зелёной магии. Вы - чистокровное существо огромного роста.
торговля=0
воровство=0
знаниемеча=0
знаниепалицы=0
знаниешеста=0
знаниетопора=0
знаниекастета=0
знаниекулака=0
броняног=0
бронятела=0
броняголовы=0
сила=2
точность=1
восприятие=1
ловкость=0
харизма=1
удача=1
скорость=1
интеллект=2
максздоровье=3
максмана=3
максвыносливость=6
максбодрость=3
зелмагия=2
синмагия=0
красмагия=0
чёрмагия=0
белмагия=0
бодрость=0
здоровье=0
выносливость=0
мана=0
выборзаклинания=0
magicno=0
зеленокожий=0
копыта=0
btn newabilities, Дальше
btn newgame, Назад
end

:newabilities
instr imagearmor=noarmor
instr imageshoes=noshoes
instr imagecap=nocap
imageweapon=1
instr style_formpicture=heroimages\noarmor\noshoes\nocap\1.bmp
pln В душе любого существа может быть лишь один истинный талант. Выберите жизненный путь, по которому вы будете следовать.
image=0
btn newmight, Сила
if magicno=0 then btn newmagic, Магия
end

:newmight
image=21
pln Вы выбрали путь силы. Вы получаете бонусы к почти всем немагическим навыкам, в особенности, к бодрости, выносливости, здоровью и к силе. Но ваш максимальный магический уровень любой из школ магии не превысит четвёртого.
herotype=1
знаниемеча=знаниемеча+1
знаниепалицы=знаниепалицы+1
знаниешеста=знаниешеста+1
знаниетопора=знаниетопора+1
знаниекастета=знаниекастета+1
знаниекулака=знаниекулака+1
сила=сила+2
максздоровье=максздоровье+6
точность=точность+1
ловкость=ловкость+1
удача=удача+1
скорость=скорость+1
максвыносливость=максвыносливость+6
максбодрость=максбодрость+6
btn newname, Дальше
end

:newmagic
if not Заклинания then inv+ Заклинания
image=22
pln Вы выбрали путь магии. Вы получаете большой бонус к мане, а также бонус к удаче и восприятию. Все цвета магии у вас прокачаны до первого уровня. К сожалению, вы не сможете прокачать любое из боевых умений выше, чем до четвёртого уровня.
herotype=2
максмана=максмана+6
восприятие=восприятие+1
удача=удача+1
интеллект=интеллект+1
if сила<3 then сила=сила+1
максздоровье=максздоровье+3
белмагия=белмагия+1
зелмагия=зелмагия+1
чёрмагия=чёрмагия+1
синмагия=синмагия+1
красмагия=красмагия+1
pln Итак, вы родились с даром Могущества. Своё первое заклинание вы знали ещё без никакого обучения. Какое это было заклинание?
btn newmagicshock, Удар шоком
btn newmagicdeadhand, Умерщвляющая рука
btn newmagicstearing, Слезливость
btn newmagicsmart, Пылкость
btn newmagicbranch, Опутывающие ветви
btn newmagicinfo, Информация о заклинаниях
end

:newmagicinfo
instr locname=newmagicinfo
pln О каком заклинании вы хотите узнать побольше?
btn infoshock, Удар Шоком
btn infodeadhand, Умерщвляющая рука
btn infostearing, Слезливость
btn infosmart, Пылкость
btn infobranch, Опутывающие ветви
btn newmagic, Вернуться
end

:newmagicshock
magicshock=1
pln Вы знаете заклинание "Удар шоком" (Белая магия).
btn newname, Дальше
end

:newmagicdeadhand
magicdeadhand=1
pln Вы знаете заклинание "Умерщвляющая рука" (серая магия).
btn newname, Дальше
end

:newmagicstearing
magicstearing=1
pln Вы знаете заклинание "Слезливость" (Синяя магия).
btn newname, Дальше
end

:newmagicsmart
magicsmart=1
pln Вы знаете заклинание "Пылкость" (Красная магия).
btn newname, Дальше
end

:newmagicbranch
magicbranch=1
pln Вы знаете заклинание "Опутывающие ветви" (Зелёная магия).
btn newname, Дальше
end

:newname
image=0
instr name=
p Введите своё имя:  
input name
pln #%name$
btn checkstatus, Дальше
end

:checkstatus
плюсксиле=0
плюсквосприятию=0
плюскловкости=0
плюскскорости=0
плюскудаче=0
плюскточности=0
плюскинтеллекту=0
плюсккулаку=0
плюскмечу=0
плюскпалице=0
плюскшесту=0
плюсктопору=0
плюсккастету=0
плюскчёрмагии=0
плюскчёрмагии=0
плюскбелмагии=0
плюсккрасмагии=0
плюсксинмагии=0
плюскзелмагии=0
forestprotsmarts=0
boxгилs=0
boxяблокоs=0
boxтопордровосекаs=0
boxлечебнаятраваs=0
boxманноваяромашкаs=0
boxсоксинегогрибаs=0
boxдневникркs=0
boxrkrings=0
boxкусокпанциряs=0
от=2
до=7
proc rnd()
tavernstraiderroom=рнд
tavernstraiderrooms=0
tavernstraiderbarvalmess=1
alliraknow=0
furgotknow=0
furgotaxes=1
valmesknow=0
valmesgold=100
колоружия=0
выборзаклинания=0
весоружия=0
весброни=0
весшлема=0
весперчаток=0
веспояса=0
весобуви=0
весинв=0
мешок=0
уровень=0
опыт=0
acthead=0
actbody=0
pause 100
actlegs=0
acthands=0
actneck=0
нужныйопыт1=15
нужныйопыт2=30
нужныйопыт3=60
нужныйопыт4=90
нужныйопыт5=120
нужныйопыт6=150
нужныйопыт7=200
нужныйопыт8=250
нужныйопыт9=300
нужныйопыт10=350
нужныйопыт11=450
нужныйопыт12=550
нужныйопыт13=700
нужныйопыт14=850
нужныйопыт15=1000
нужныйопыт16=1250
нужныйопыт17=1500
нужныйопыт18=1800
нужныйопыт19=2100
нужныйопыт20=2500
beerstatus=0
нужныйопытворовство=5
нужныйопытзнаниемеча=10
нужныйопытзнаниепалицы=10
нужныйопытзнаниешеста=10
нужныйопытзнаниетопора=10
нужныйопытзнаниекастета=10
нужныйопытзнаниекулака=10
нужныйопытторговли=10
опытворовство=0
опытзнаниемеча=0
опытзнание
опытзнаниешеста=0
опытзнаниетопора=0
опытзнаниекастета=0
опытзнаниекулака=0
опытторговли=0
похмелье=0
интдопохмелья=интеллект
восдопохмелья=восприятие
forestprotwolvess=0
rkrings=0
healrings=0
traydie=0
krildie=0
magicaiming=0
magicthornhand=0
boxrkrings=0
boxкольцолеченияs=0
boxдневникркs=0
krilrobes=1
krilsandaless=1
krilwands=1
alliragold=30
krilgold=0
instr weapexp=a
опытa=-999999
нужныйопытa=999999
allirahplant=3
allirabmush=3
alliramplant=3
robes=0
sandaless=0
tavernstraidertablesallirarun=0
tavernstraidertablesalliras=1
tavernstraidertableskrils=1
forestprothouseaxes=1
furgottalkvalmes=0
tavernstraidertablesfurgots=0
traybeer=0
forestprotrmknow=0
trayaxes=1
traymatches=1
traygold=16
matches=0
boxmatchess=0
tavernstraidertablestraytalktotor=0
forestprotrmtors=1
forestprotrmtorblock=1
tordie=0
torknow=0
torgold=10
toraxes=1
torhplant=1
tavernstraidertablestraytalktotor=0
голодсила=0
голодловкость=0
голодточность=0
голодскорость=0
голодвосприятие=0
голодудача=0
голодхаризма=0
голодмана=0
голодздоровье=0
голодинтеллект=0
redmountainscampfire=1
redmountainsnearlakegoblins=1
furgotmeat=1
traymeat=1
krilmeat=1
allirameat=1
forestprotfieldbugss=0
forestprotbugraiderdie=0
forestprotfieldbugsdieplates=2
goto forestprothousebegin
end

:newter
pln Выберите пункт, в котором начнётся ваше приключение.
;btn newtorn, Цитадель Торнхэйм
;btn newshturm, Город Штурмфорд
btn forestprothousebegin, Хижина в лесу
end

:forestprothousebegin
if musicno=0 then music="2.ogg"
valmesknow=1
common=2
dangerplace=0
ter=3
year=1764
month=3
week=2
day=10
hour=6
minute=30
sec=0
бодрость=максбодрость+0.9
выносливость=максвыносливость+0.9
здоровье=максздоровье+0.9
мана=максмана+0.9
forestprothousewindow=0
pln #%name$ - обычный лесник небольшого леса Протгорн. С самого рождения ему отведена эта работа. Когда-то и его отец был лесником... И все почему-то решили, что и #%name$ должен им стать... #/$#/$Но уже около недели вас не покидает одна мысль - кинуть это всё и отправиться на поиски приключений. И вот, #%name$ просыпается и окончательно решает покинуть это скучное место. Нужно только собрать всё необходимое и предупредить Валмеса, старого друга вашего ныне покойного отца.
btn forestprothouse, Встать с кровати
end

:forestprothouse
instr locname=forestprothouse
p #%name$ находится в небольшом деревянном домике. 
if forestprothousewindow=0 then proc forestprothousewindows & btn forestprothousewindowc, Закрыть окно
if forestprothousewindow=1 then p Массивные ставни полностью закрывают окно. & btn forestprothousewindowo, Открыть окно
if forestprothouseaxes=1 then p В углу лежит небольшой топорик & btn forestprothouseaxet, Взять топорик
if forestprothouseaxes=1 and ter=3 then p - наследство от вашего отца.
if forestprothouseaxes=1 and ter<>3 then p .
p Недалеко от вас стоит маленький обеденный стол, а за вашей спиной находится деревянная, накрытая какими-то лохмотьями, кровать. Прямо перед вами входная дверь.
btn forestprothousetable, Осмотреть стол
btn bed, Прилечь на кровать
btn forestprotnh, Выйти из хижины
;btn forestprotfieldbugs, Cheat!
end

:bed
if dangerplace=1 and forestprothids=0 then pln #%name$ не может отдыхать, пока рядом враги! & sec=sec-20 & goto #%locname$
pln #%name$ лежит на кровати.
btn wait, Ждать
btn sleep, Спать
btn #%locname$, Встать с кровати
end

:sleep
if бодрость>максбодрость-0.8 then pln #%name$ не хочет спать. #/$ #/$ & goto bed
pln Сколько #%name$ должен спать?
sec=sec-10
btn sleep3, 3 часа
btn sleep8, 8 часов
btn sleep12, 12 часов
btn #%locname$, Встать
end

:sleep3
sec=sec-10
hour=hour+3
pln #%name$ проспал три часа.
бодрость=бодрость+2+максвыносливость/9
мана=мана+1+максмана/9
здоровье=здоровье+1+максздоровье/9
if бодрость>(максбодрость+0.9) then бодрость=(максбодрость+0.9)
if мана>(максмана+0.9) then мана=(максмана+0.9)
if здоровье>(максздоровье+0.9) then здоровье=(максздоровье+0.9)
if похмелье>0 then похмелье=похмелье-50
btn #%locname$, Встать
end

:sleep8
sec=sec-10
hour=hour+8
pln #%name$ проспал восемь часов.
бодрость=бодрость+6+максвыносливость/3
мана=мана+3+максмана/3
здоровье=здоровье+3+максздоровье/3
if бодрость>(максбодрость+0.9) then бодрость=(максбодрость+0.9)
if мана>(максмана+0.9) then мана=(максмана+0.9)
if здоровье>(максздоровье+0.9) then здоровье=(максздоровье+0.9)
if похмелье>0 then похмелье=похмелье-100
btn #%locname$, Встать
end

:sleep12
sec=sec-10
hour=hour+12
pln #%name$ проспал двенадцать часов.
бодрость=бодрость+10+максвыносливость/1.5
мана=мана+5+максмана/1.5
здоровье=здоровье+5+максздоровье/1.5
if бодрость>(максбодрость+0.9) then бодрость=(максбодрость+0.9)
if мана>(максмана+0.9) then мана=(максмана+0.9)
if здоровье>(максздоровье+0.9) then здоровье=(максздоровье+0.9)
if похмелье>0 then похмелье=похмелье-150
btn #%locname$, Встать
end

:wait
sec=sec-10
pln Сколько ждать?
btn wait10, 10 минут
btn wait30, 30 минут
btn wait1, 1 час
btn #%locname$, Встать
end

:wait10
pln #%name$ отдыхал 10 минут, от нечего делать, отстукивая пальцами знакомую мелодию.
minute=minute+10
бодрость=бодрость+0.3+выносливость/20
sec=sec-10
if бодрость>(максбодрость+0.9) then бодрость=(максбодрость+0.9)
btn #%locname$, Встать
end

:wait30
pln #%name$ отдыхал полчаса, приводя свои мысли в порядок.
minute=minute+30
бодрость=бодрость+0.6+выносливость/10
sec=sec-10
if бодрость>(максбодрость+0.9) then бодрость=(максбодрость+0.9)
btn #%locname$, Встать
end

:wait1
pln #%name$ отдыхал час, обдумывая свои будущие действия.
hour=hour+1
бодрость=бодрость+1.2+выносливость/5
sec=sec-10
if бодрость>(максбодрость+0.9) then бодрость=(максбодрость+0.9)
btn #%locname$, Встать
end

:forestprothousetable
if danderplace=1 and forestprothids=0 then pln #%name$ не успел сделать и шагу до того, как дикое существо запрыгнуло в дом через окно и начало сражение. & goto forestprothousegibfight
p #%name$ подошёл к немного пыльному обеденному столу. 
if forestprothousetables=0 then pln На нём лежат несколько свежих яблок. & btn forestprothousetablea, Взять яблоки
if forestprothousetables=1 then pln На нём ничего нет.
btn forestprothouse, Отойти от стола
end

:forestprothousetablea
p #%name$ взял со стола три яблока
if мешок=0 then pln  и спрятал их себе за пазуху.
if мешок=1 then pln и положил их в свой дорожный мешок.
inv+ 3,Яблоко
forestprothousetables=1
годностьяблок=3
btn forestprothouse, Отойти от стола
end

:forestprothouseaxet
instr cname=forestprothouse
proc takeaxe
if dangerplace=1 and forestprothids=0 then pln #%name$ только и успел взять топор, перед тем как дикое существо запрыгнуло в хижину через окно и начало сражение. & goto forestprothousegibfight
btn forestprothouse, Перестать рассматривать топор
end

:forestprothousewindows
if hour<7 and hour>4 then p Через широкое окно пробиваются слабые лучи рассвета. 
if hour>6 and hour<17 then p Через широкое окно на такой же деревянный пол падает свет солнца. 
if hour>16 and minute>29 or hour<5 then p За окном темно и почти ничего не видно. 
end

:forestprothousewindowc
if dangerplace=1 and forestprothids=0 then pln Как только #%name$ подошёл к окну, из него выпрыгнуло маленькое существо и начало сражение. & goto foresrprothousegibfight
forestprothousewindow=1
pln #%name$ подошёл к окну и закрыл его. #/$
btn forestprothouse, Отойти от окна
end

:forestprothousewindowo
if dangerplace=1 and forestprothids=0 then pln Как только #%name$ подошёл к окну, из него выпрыгнуло маленькое существо и начало сражение. & goto foresrprothousegibfight
p #%name$ 
if сила<3 then p с трудом 
pln открыл окно.
forestprothousewindow=0
btn forestprothouse, Отойти от окна
end

:forestprotnh
p #%name$ стоит возле небольшой хижины. 
if hour<19 and hour>4 then p Слабо светит солнце. 
if hour>16 and minute>29 or hour<5 then p Вокруг совсем темно. 
pln Между двумя соснами начинается слабо заметная тропа, ведущая в лес.
if восприятие>2 and удача>0 and forestprotnhgolds=0 then pln #/$ Ваш острый глаз увидел лежащий под странным углом камень неподалёку от хижины. Вам повезло, ведь под ним оказались 3 Гил! & btn forestprotnhgold, Взять найденные деньги
btn forestprothouse, Зайти в хижину
btn forestprothid, Идти по тропинке
end

:forestprothid
if forestprothids=0 then dangerplace=1
if forestprothids=0 and восприятие>2 then pln #/$Вам показалось, что в кустах кто-то пошевелился... & pause 2000 & btn forestprothid1, Осмотреться повнимательнее
if forestprothids=0 and восприятие<3 then pln Пройдя несколько метров, #%name$ услышал слабый шорох позади него... & btn forestprotgibfight, Повернуться & btn forestprothid2, Бежать без оглядки
if forestprothids=0 and восприятие<3 and magicsmart=1 and мана>4.8 then btn forestprothidsmart, Использовать заклинание "Пылкость"
if forestprothids=1 then goto forestprotcross
end

:forestprothid1
pln #%name$ осторожно осматривает всё вокруг себя, но ничего не замечает. 
btn forestprothid2, Бежать вглубь леса
btn forestprothid3, Осмотреть близлежащие кусты
btn forestprothid4, Медленно отходить к хижине
if magicsmart=1 and мана>4.9 then btn forestprothidsmart, Использовать заклинание "Пылкость"
end

:forestprothidsmart
мана=мана-4
forestprotsmarts=1
pln #%name$ колдует заклинание "Пылкость" и видит, как трава вокруг него сгорает высоким пламенем. Насытившись такой пищей, огонь поднимается всё выше и выше, окутывая вас во что-то вроде кокона. Когда абсолютно вся трава в радиусе двух метров от вас сгорает, огонь начинает поедать саму почву. Закутав вас так, что не видно даже вашей макушки, пламя через рот попадает в вас. #%name$ чувствует тепло внутри себя, но не более того. Приятное и питательное тепло... Когда огонь полностью впитывается в вас, ваше тело настолько полно энергии, что способно выжимать из своих мышц всё и даже больше.
btn forestprotgibsmartfight, Повернуться
btn forestprotcross, Бежать без оглядки
end

:forestprothid2
if скорость>1 then pln #%name$ со всего духа побежал вглубь леса. Наконец, задыхаясь от недостатка воздуха, #%name$ осознал, что его уже никто не преследует. & бодрость=бодрость-2 & goto forestprotcross
p Как #%name$ ни старался, а неведомый враг всё-таки настиг его.
if интеллект>2 and раса<>10 then pln #%name$ узнал, что за ним гнался дикий гибберлин - разновидность гибберлинов, обитающая в лесах и считающаяся уже не зеленокожей.
if интеллект>2 and раса=10 then pln #%name$ узнал, что за ним гнался дикий гибберлин - такой же крови, как и он, но одичалый и выросший в лесу. Вся спина этого "собрата" покрыта длинной шерстью, стоящей торчком.
if интеллект<3 then pln #%name$ увидел перед собой маленькое лохматое существо с крючковатыми лапками и тонкими, но длинными клыками.
btn forestprotgibfight, Сражаться
end

:forestprothid3
число=2
proc rnd
if рнд=1 then pln В кустах #%name$ заметил маленькое мохнатое существо. Оно мгновенно ринулось в атаку.
if рнд=2 then p #%name$ никого не нашёл в кустах, однако видно было, что тут совсем недавно кто-то сидел. Внезапно какое-то мохнатое маленькое существо укусило вас за ногу.
if броняног>1 then pln К счастью, ваши качественные боты спасли вас.
if броняобуви<2 then pln Тонкие, но длинные и острые клыки глубоко впились в вашу кожу. & здоровье=здоровье-2
btn forestprotgibfight, Сражаться
end

:forestprotnhgold
if мешок=1 then pln #%name$ положил найденные монеты в свою дорожную сумку.
if мешок=0 then pln #%name$ поспешно положил найденные деньги в карман.
forestprotnhgolds=1
inv+ 3,Гил
btn forestprotnh, Положить камень на место
end

:forestprothousegibdie
pln #%name$ обыскал побеждённого, но так ничего и не нашёл.
if зеленокожий=1 then btn forestprothousegibdiemeat, Забрать мясо
forestprothids=1
goto forestprothouse
end

:forestprothid4
p #%name$, стоя лицом к лесу, сделал несколько шагов к хижине. Вдруг из недалеко растущих кустов что-то вынырнуло, за несколько мгновений подбежало и прыгнуло прямо на вас.
if ловкость>3 or удача>2 then pln #%name$ инстинктивно извернулся и ушёл от удара.
if ловкость<4 and удача<3 then pln Это "что-то" начало бой. & goto forestprotgibfight
pln У вас есть несколько секунд на решение, пока существо не атаковало снова: бежать в хижину или сражаться насмерть.
btn forestprothouse, Бежать в хижину
btn forestprotgibfight, Сражаться
end

:forestprotgibdie
dangerplace=0
forestprothids=1
pln Обыскав мёртвого врага, #%name$ ничего не нашёл.
if зеленокожий=1 then btn forestprotgibdiemeat, Забрать мясо
btn forestprotnh, К хижине
btn forestprotcross, В лес
end

:forestprotgibdiemeat
pln #%name$ разделал тушу и забрал мясо врага.
inv+ Сырое_мясо
весинв=весинв+1
freshmeat=#inv_Сырое_мясо$
btn forestprotnh, К хижине
btn forestprotcross, В лес
end

:forestprothousegibdiemeat
pln #%name$ разделал тушу и забрал мясо врага.
inv+ Сырое_мясо
весинв=весинв+1
freshmeat=#inv_Сырое_мясо$
goto forestprothouse
end

:forestprotcross
dangerplace=0
forestprotcrosstime=26-скорость
if forestprotcrosstime<11 then forestprotcrosstime=10
if forestprotcrosstime>25 then forestprotcrosstime=25
minute=minute+forestprotcrosstime darklocs=1
instr darkloc=forestprotcross
if forestprotsmarts=1 and forestprotwgibdie=0 then pln #/$ #%name$ сумел убежать от своего преследователя, однако эта "пробежка" длилась так долго, что действие заклинания уже закончилось. В любом случае, по той дороге лучше больше не ходить.#/$
forestprotsmarts=0
if hour<19 and hour>5 then p #%name$ находится на развилке тропинок. На указателе написано, что одна ведёт к хижине лесника, другая к окраине леса, третья - к Красным горам. Через огромные кроны деревьев почти не проходит солнечный свет. & btn forestprotnh, К хижине лесника & btn forestprotnt, К окраине леса & btn forestprotrm, К Красным горам
if hour>18 and light=0 or hour<6 and light=0 then p #%name$ находится на развилке трёх тропинок. Он с трудом нащупал указатель, но так и не смог ничего на нём увидеть из-за кромешной тьмы. Отсюда идут три тропы: на юго-восток, на юг и на север. & btn forestprotnh, Идти на север & btn forestprotnt, Идти на юг & btn forestprotrm, Идти на юго-восток
if hour>18 and light=1 or hour<6 and light=1 then p #%name$ находится на развилке трёх тропинок. Вокруг темно, но благодаря вешему осветителю, вы видите указатель и то, что на нём написано. Отсюда идут три тропы: одна ведёт к хижине лесника, другая к окраине леса, третья - к Красным горам. & btn forestprotnh, Идти к хижине & btn forestprotnt, Идти к окраине леса & btn forestprotrm, Идти к Красным горам
if forestprotwolvess=0 and hour>18 then pln С запада доносится злобный волчий рёв. & btn forestprottowc, Идти на волчий рёв
if tavernstraidertablesalliratalkworks=1 and forestprotfindginkas=0 then btn forestprotfindginka, Искать растение Гинка
end

:forestprotrm
forestprotrmblock=0
dangerplace=0
proc screenpar
instr locname=forestprotrm
instr stealloc=forestprotrmsteal
p #%name$ вышел к подножию Красных гор. Говорят, что когда-то эта гора была действующим вулканом, но когда гномы покинули эти горы, их покинула и жизнь, и они заснули. В, почти что перпендикулярной земле, горе пробит довольно большой проход. В нём видна лишь тьма, ничего более. 
if torknow=0 and интеллект<2 then instr cname=существо
if torknow=0 and интеллект>1 then instr cname=гном
if torknow=1 then instr cname=Тор
if torknow=0 and интеллект<2 then instr cname1=существо
if torknow=0 and интеллект>1 then instr cname1=гнома
if torknow=1 then instr cname1=Тора
if hour<7 and tordie=0 or hour=24 and tordie=0 then pln Недалеко от прохода прямо на земле, слегка похрапывая, спит  #%cname$. & forestprotrmblock=0 & steals=1 & btn forestprotrmtorfight, Атаковать #%cname1$
if torknow=0 and интеллект<2 then instr cname1=существом
if torknow=0 and интеллект>1 then instr cname1=гномом
if torknow=1 then instr cname1=Тором
if hour>=7 and tordie=0 and hour<24 and tordie=0 then pln Недалеко от прохода сидит на земле и покуривает трубку #%cname$. & forestprotrmblock=1 & btn forestprotrmtortalk, Поговорить с #%cname1$& steals=1
btn forestprotrmenter, Войти в проход
if torknow=0 and интеллект<2 then instr cname1=ое существо
if torknow=0 and интеллект>1 then instr cname1=ый гном
if torknow=1 then instr cname1=ый Тор
if tordie=1 and forestprotrmtors=1 then pln Прямо на траве лежит мёртв#%cname1$. & btn forestprotrmtordie, Обыскать труп
btn forestprotcross, Идти в глубь леса
end

:forestprotrmenter
instr cname1=
instr cname=гном
if интеллект<2 then instr cname=существо& instr cname1=о
if torknow=1 then instr cname=Тор
if forestprotrmtorblock=1 and forestprotrmblock=1 then pln Вы попытались пройти, но дорогу вам преградил#%cname1$ #%cname$, угрожающе приподняв свой двуручный топор.#/$& goto forestprotrm
pln #%name$ вошёл в длинный туннель, ведущий вглубь горы. На стене не висело никаких ламп или факелов, так что, пройдя двадцать шагов, #%name$ уже ничего не мог видеть перед собой в кромешной тьме. Каменный пол под вашими ногами не облицован, поэтому вы постоянно спотыкаетесь об какие-то кочки. Без света дальше идти довольно опасно.
darklocs=1
instr darkloc=redmountainsnenter
btn forestprotrmenterfall, Идти дальше
btn forestprotrm, Выйти из туннеля
end
 :forestprotrmenterfall
p #%name$ сделал несколько шагов вперёд и споткнулся об камень. Он упал и стукнулся обо что-то головой. 
урон=12-броняголовы*2
if урон>=здоровье+0.9 then pln От сильного удара по голове #%name$ потерял сознание и так и не пришёл в себя. & goto gameover
pln К счастью, #%name$ отделался лишь хорошей шишкой и дальше побрёл уже на четвереньках.
minute=minute+10
goto redmountainsnenterlab
end

:redmountainsnenter
pln Благодаря вашему светилу, стали видны многочисленные неровности на полу. Идти без света здесь было действительно опасно! Зато теперь #%name$ видит где и на что можно наступать, чтобы не споткнуться и не закончить свои дни в этих горах.
btn redmountainsnenterlab, Идти вперёд
btn forestprotrm, Выйти из туннеля
end

:redmountainsnenterlab
minute=minute+5
pln #%name$ дошёл до конца туннеля, завернул на повороте и оказался в самом настоящем лабиринте. Здесь было уже не так темно, так как из маленьких окошечек, пробитых на каждом повороте, шёл слабый свет. #%name$ сначала удивился этому, но затем разглядел в окошках небольшие зеркала, передающие яркий солнечный свет, наверно, с самых вершин Красных гор.
btn redmountainsenterlabs, Войти в лабиринт
btn forestprotrm, Выйти из туннеля
end

:redmountainstunnel
pln #%name$ начал пробирать по длинному туннелю. Прямо вам в лицо дует холодный сквозняк, а где-то недалеко, мерно, капля за каплей в лужицу стекает вода. Отсюда можно пройти в небольшой гномий лабиринт или идти прямо по туннелю.
btn redmountainslabs, Войти в лабиринт
btn redmoutainstunnel1, Идти по туннелю
end

:redmoutainstunnel1
tunneltime=26-скорость
if tunneltime<11 then tunneltime=10
if tunneltime>25 then tunneltime=25
minute=minute+tunneltime
p #%name$ довольно долгое время шёл по прямому, лишённому всяческих изгибов, туннелю. С каждым шагом усиливался какой-то омерзительный запах. В конце концов, вы вышли из туннеля и оказались в просторной пещере. #%name$ поднял голову и увидел острые концы сталактитов, свисающих с потолка. Хорошо протоптанная тропа ведёт в другой конец пещеры. В сорока шагах от вас #%name$ видит небольшое озерце.
if redmountainscampfire=1 then p Рядом с озером горит разожжённый кем-то костёр. Вы пытаетесь вглядеться и увидеть там хоть что-нибудь, но ничего не замечаете на таком расстоянии.
btn redmountainsnearlake, Подойти к костру ближе
btn redmountainstunnel, Возвращаться обратно в туннель
end

:redmoutainstunnel2
tunneltime=26-скорость
if tunneltime<11 then tunneltime=10
if tunneltime>25 then tunneltime=25
minute=minute+tunneltime
goto redmountainstunnel
end

:redmountainsnearlake
p #%name$ подошёл поближе к костру 
instr cname=существа
if интеллект>1 then instr cname=гоблина
instr cname=существами& 
if интеллект>1 then instr cname=гоблинами
if redmountainsnearlakegoblins=1 then pln и тут же лёг на землю - возле костра сидят три #%cname$ и, пережёвывая какое-то мясо, негромко переговариваются. Если вы хотите проползти к дальнему выходу из пещеры, то сильно рискуете быть замеченным. Однако вас вряд ли заметят, полезь вы к озеру или в туннель. & btn redmountainsnearlakegoblintalk, Поговорить с #%cname$& instr cname=существ
if интеллект>1 then instr cname=гоблинов
if redmountainsnearlakegoblins=1 then btn redmountainsnearlakegoblinhear, Послушать их разговор & btn redmountainsnearlakegoblin1fight, Атаковать #%cname$ & btn redmountainsnearlaketrytogo, Проползти мимо #%cname$ & btn redmountainslake, Ползти к озеру & btn redmoutainstunnel2, Медленно ползти обратно

end

:redmountainsnearlakegoblinhear
p #%name$ прислушался к разговору трёх #%cname$ - 
if redmountainsnearlakegoblinhears=0 then p те что-то бурно обсуждали
redmountainsnearlakegoblinhearlang=0
if раса=7 or раса=11 or интеллект>2 then redmountainsnearlakegoblinhearlang=1
if redmountainsnearlakegoblinhears=0 and redmountainsnearlakegoblinhearlang=0 then pln - Но не понял ни слова из их нечленоразборчивого языка.
if redmountainsnearlakegoblinhears=0 and redmountainsnearlakegoblinhearlang=1 then pln :#/$- Нееее, нееет, Сугхрук, нееее пойдёёт такоеее мясцо сееегодня. Ты, плееешивый, можешь Большого травить-то, а мнеее давай нормально готовь!#/$- Я теее дам, поговори мне, свинья харя! Спасибо скажитеее, дармоеееды, что готовить умееею. Эта меертвечина уже недеееляю как лежит, я ж неее виноват, что она малёёёнё испоганилась, да.#/$- А мнеее какая разница? Укрух тебя поставил поваром, тебеее и готовить хорошо!#/$- Ах ты бошка лысая, думаееешь сам я питаться неее хочу? Пусть ещёё гномики заходют, Большой их прихлопнеееет, а мы попитаемя, да значит. & redmountainsnearlakegoblinhears=1
if redmountainsnearlakegoblinhears=1 then всё тот же бессмысленный трёп о своей горькой жизни.
instr cname=существами
if интеллект>1 then instr cname=гоблинами
btn redmountainsnearlakegoblintalk, Поговорить с #%cname$
instr cname=существ
if интеллект>1 then instr cname=гоблинов
btn redmountainsnearlakegoblin1fight, Атаковать #%cname$
btn redmountainsnearlaketrytogo, Проползти мимо #%cname$
btn redmountainslake, Ползти к озеру
btn redmoutainstunnel2, Медленно ползти обратно
end

:forestprotrmsteal
cls
instr cname=гном
if интеллект<2 then instr cname=существо
if torknow=1 then instr cname=Тор
pln Рядом с вами находится #%cname$.
instr cname=гнома
if интеллект<2 then instr cname=существа
if torknow=1 then instr cname=Тора
btn torsteal, Воровать у #%cname$
btn #%locname$, Вернуться
end

:torsteal
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
instr locname=forestprotrm
instr lookand=
p У #%cname$ 
if toraxes=0 and torgold=0 and torhplant=0 then p ничего нет
if toraxes=1 or torgold>0 or torhplant=1 then p есть 
if toraxes=1 then p двуручный топор& btn torstealaxe, Воровать топор & instr lookand=,& instr style_formpicture=heroimages/noarmor/noshoes/nocap/5.bmp
if torgold>0 then p #%lookand$#torgold$ Гил& btn torstealgold, Воровать деньги& instr lookand= и 
if torhplant=1 then p #%lookand$лечебная трава& btn torstealhplant, Воровать лечебную траву
pln .
btn #%locname$, Вернуться
end

:torstealaxe
число=12
proc rnd
instr cname=tor удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<9 then опытворовство=опытворовство+1 & pln Вас заметили! & instr locname=forestprotrmtorfight & btn forestprotrmtorfight, Сражаться насмерть
if удачливость=9 or удачливость=10 then instr locname=forestprotrmtorfight & pln Кража удалась, но вас заметили! #%name$ украл двуручный топор. & опытворовство=опытворовство+1 & опыт=опыт+харизма & proc takeaxe2 & btn forestprotrmtorfight, Сражаться насмерть & proc checklevup
if удачливость>10 and удачливость<=14 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>14 then опытворовство=опытворовство+1 & опыт+2+харизма & instr locname=forestprotrm & pln Кража удалась! #%name$ украл двуручный топор. & proc takeaxe2 & proc checklevup
if удачливость>10 and toraxes=1 then btn torstealaxe, Попробовать ещё раз 
if удачливость>10 then btn #%locname$, Вернуться
proc stealup
end

:torstealgold
число=7
proc rnd
instr cname=tor
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<=5 then опытворовство=опытворовство+1 & pln Вас заметили! & btn forestprotrmtorfight, Сражаться насмерть
if удачливость>5 and удачливость<=6.5 then p Кража удалась, но вас заметили! & proc checkstealgold & опытворовство=опытворовство+1 & опыт=опыт+харизма & instr locname=forestprotrmtorfight & proc checklevup & btn forestprotrmtorfight, Сражаться насмерть
if удачливость>6.5 and удачливость<=8.5 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>8.5 then опытворовство=опытворовство+1 & опыт=опыт+2+харизма & p Кража удалась! & proc checkstealgold & proc checklevup
proc stealup
instr cname=гном
if torknow=1 then instr cname=Тор
if удачливость>6.5 and torgold=0 then pln У #%cname$а больше нет денег. & goto #%locname$
if удачливость>6.5 then btn torstealgold, Попробовать ещё раз & btn #%locname$, Вернуться
end

:torstealhplant
число=12
proc rnd
instr locname=torsteal
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<9 and удачливость>3 then опытворовство=опытворовство+1 & pln Вас заметили! & instr locname=forestprotrmtorfight & btn forestprotrmtorfight, Сражаться насмерть
if удачливость=9 or удачливость=10 then torhplant=0 & inv+ Лечебная_трава & pln Кража удалась, но вас заметили! #%name$ украл траву лечения. & опытворовство=опытворовство+1 & опыт=опыт+2+харизма & instr locname=forestprotrmtorfight & proc checklevup & btn forestprotrmtorfight, Сражаться насмерть
if удачливость>10 and удачливость<15 or удачливость<=4 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>14 then torhplant=0 & опытворовство=опытворовство+1 & опыт=опыт+харизма & inv+ Лечебная_трава & pln Кража удалась! #%name$ украл лечебную траву. & proc checklevup
if удачливость>10 then btn torstealhplant, Попробовать ещё раз 
if удачливость>10 then btn #%locname$, Вернуться
proc stealup
end

:forestprotrmtordie
p У гнома 
if toraxes=0 and torgold=0 and torhplant=0 then p ничего нет
if toraxes=1 or torgold>0 or torhplant=1 then p есть 
if toraxes=1 then p двуручный топор& btn forestprotrmtordieaxe, Взять топор & instr lookand=,
if torgold>0 then p #%lookand$#torgold$ Гил& btn forestprotrmtordiegold, Взять деньги& instr lookand= и 
if torhplant=1 then p #%lookand$лечебная трава& btn forestprotrmtordiehplant, Взять лечебную траву
if tormeat=1 and зеленокожий=1 then btn forestprotrmtordiemeat, Забрать мясо
pln .
btn forestprotrm, Вернуться
end

:forestprotrmtordiemeat
pln #%name$ забрал ещё свежее мясо мёртвого гнома
inv+ Сырое_мясо
весинв=весинв+1
if годностьмяса<1 then годностьмяса=6
freshmeat=#inv_Сырое_мясо$
tormeat=0
goto tavernstraiderbarroomfurgotdie
end

:forestprotrmtordieaxe
instr cname=tor
proc takeaxe2
goto forestprotrmtordie
end

:forestprotrmtordiegold
inv+ #torgold$, Гил& pln #%name$ взял #torgold$ Гил.
torgold=0
goto forestprotrmtordie
end

:forestprotrmtordiehplant
inv+ Лечебная_трава
torhplant=0
pln #%name$ взял лечебную траву.
goto forestprotrmtordie
end

:forestprotrmtortalk
proc dialogpar
if forestprotrmtorblock=1 then goto forestprotrmtortalkstop
число=5
proc rnd
proc replicbye
число=7
proc rnd
proc replichello
pln - #%hello$, #%name$!
число=7
proc rnd
proc replichello
if интеллект>=0 then btn forestprotrmtortalkhello, - #%hello$, Тор!
if интеллект<0 then btn forestprotrmtortalkstupid, - Эээ...Ммм...Дык...А?
if интеллект>=0 then btn forestprotrm, - #%bye$, Тор.
if интеллект<0 then btn forestprotrm, Шатаясь, отойти
btn forestprotrmtorfight, Атаковать Тора
end

:forestprotrmtortalkstupid
pln - Э, нет. Эту тему можешь обсудить с кем-то другим.
btn forestprotrm, Отойти
end

:forestprotrmtortalkhello
число=5
proc rnd
proc replicbye
pln - А я вот сижу тут, понимаешь, от скуки маюсь.
btn forestprotrmtortalktunnel, - Из-за чего произошёл завал?
btn forestprotrmtortalkrm, - Расскажи мне о Красных Горах
btn forestprotrm, - #%bye$, Тор.
btn forestprotrmtorfight, Атаковать Тора
end

:forestprotrmtortalktunnel
число=5
proc rnd
proc replicbye
pln - Пока что почти ничего не известно, но воины, охраняющие другой выход из прохода, говорят, что отчётливо слышали сильный взрыв. Наши послали туда небольшой отряд, чтоб те выяснили что к чему, да вот только он так и не вернулся.
btn forestprotrmtortalkrm, - Расскажи мне о Красных горах
btn forestprotrm, - #%bye$, Тор.
btn forestprotrmtorfight, Атаковать Тора
end

:forestprotrmtortalkrm
if forestprotrmtortalkrms=1 and minute<=forestprotrmtortalkrmminute and hour=forestprotrmtortalkrmhour or hour<forestprotrmtortalkrmhour then pln - Да дай глотке отдохнуть, я долгие речи говорить не привык.& btn forestprotrmtortalkhello, Спросить о чём-то другом
if forestprotrmtortalkrms=1 and minute>forestprotrmtortalkrmminute and hour>=forestprotrmtortalkrmhour then goto forestprotrmtortalkrm2
if forestprotrmtortalkrms=0 then minute=minute+30 & forestprotrmtortalkrms=1 & pln - Красные горы... Да, весьма печальная история...#/$   Когда-то в этих горах ковали лучшее оружие и броню для всего войска Подгорного Племени. Здешние гномы, их ещё называли лавовыми, спускались в самые недра Красных Гор, там где и бушевала лава. Место это обладало каким-то особым волшебством, оружие там ковалось легко и быстро, в него втекала немалая магическая сила. Обычный человек, не говоря уже об эльфе, просто потерял бы сознание от жары, спустись он так глубоко под землю. Лавовые гномы же, оттуда не поднимались по нескольку недель, без устали делая топоры, шлемы и кольчуги. Были они молчаливы и... очень жестоки. Слишком много времени пробыли они наедине с одним лишь оружием, слишком многое от него переняли.#/$   В то время мы, считай, через год ссорились с эльфами - и со светлыми, и с тёмными. Однажды обычная наша ссора с лесными эльфами переросла во что-то большее. Сам их король прилюдно обозвал всех до единого гномов грязным ругательством. И тогда каждый гном, от самого города Флудзина до здешних земель, взялся покрепче за свой топор и пошёл в атаку на проклятых эльфов. Поднялись из своих подземелий и гномы Красных гор. Главное сражение произошло на границе с Ваммурнелем, эльфийским лесом. Хотя больше оно было похоже на кровавую бойню. Да, почти каждый наш брат, даже умерев со стрелой в шее, захватывал с собой хотя бы одного врага, но лавовые гномы... Они все как один были в огромных тёмных доспехах, с двуручными топорами. Мифрильная броня была сделана так, что между устрашающим рогатым шлемом и сверкающим панцирем совершенно не проглядывала незащищённая от стрел кожа гномов. О, эльфийский король сильно пожалел о том, что позволил себе забыть о лавовых гномах. Они пробивали себе дорогу, кромсая на части подвернувшихся эльфов. Эльфийское войско было разбито полностью. Сдавшихся эльфов, коих было несколько десятков, лавовые гномы порубили, не предупреждая. Не смотря на приказы свыше. Вставших на их пути собратьев, они тоже уничтожили. Ибо была задета их гордость, и они не успокоились бы, пока не перебили бы всех эльфов, не взирая на цвет их кожи.#/$- И что же, что же было дальше?#/$- Они пошли дальше, прямо в центр Ваммурнеля. Как отдельное войско. Остальные гномы отстранились от них. То, что они увидели, было не весёлым боем, когда, умирая, ликуешь, потому что захватил с собой и врага. Это было молчаливой беспощадностью и жестокостью...& btn forestprotrmtortalkrm1, - Почему ты замолчал? Что же случилось дальше?
end

:forestprotrmtortalkrm1
число=5
proc rnd
proc replicbye
forestprotrmtortalkrmhour=hour
forestprotrmtortalkrmminute=minute+10
if forestprotrmtortalkrmminute>59 then forestprotrmtortalkrmminute=60-forestprotrmtortalkrm & forestprotrmtortalkrmhour=forestprotrmtortalkrmhour+1
pln #forestprotrmtortalkrmminute$
pln - А что могло случиться? Как видишь эльфы пока ещё не перевелись, да и столица их на месте... Догадаться, что же было дальше, не трудно.#/$- Но ведь они были полностью в мифриле. Как их могли одолеть?#/$- Уф, утомил ты меня, мил #%race$, чес слово. Дай хоть глотке поостынуть, а то вот уже полчаса говорю и говорю...
btn forestprotrmtortalktunnel, - Из-за чего произошёл завал?
btn forestprotrm, - #%bye$, Тор.
btn forestprotrmtorfight, Атаковать Тора
end

:forestprotrmtortalkrm2
pln - Так, на чём я остановился-то? А, ну так вот. Лавовые гномы шли через эльфийский лес, Ваммурнель. Не думай, что на их недолгом пути не было препятствий. Через каждые сто шагов их поджидала засада. Даже сами деревья не хотели пускать жестоких мстителей. Но что они могли сделать с закованными в крепчайший металл машинами для убийства? Словно сами Красные горы вторглись в этот лес...#/$   Уже через день, несмотря на все ловушки, они добрались до эльфийской столицы. Тогда и произошла решающая битва. Беркаг, глава клана Красной горы вышел в поединке один на один с эльфийским королём, Муэлькэром. Огромный двусторонний топор встретился с тонким эльфийским мечом. Огромная сила величайшего из гномьих кузнецов встретилась с невероятной скоростью и ловкостью одного из первых вошедших в этот мир. Мало кто из смертных смог бы просто взмахнуть рукой так быстро, как атаковал своим неподъёмным оружием Беркаг, но движения эльфа были просто неразличимы, разве что ветер смог бы посоревноваться с ним в скорости. Окружающие их эльфы и гномы, на время опустившие оружие, думали, что противники равносильны - с таким постоянством Муэлькэр уворачивался от убийственных взмахов Беркага и всё так же безуспешно рубил его броню. Но оба противника понимали, кто из них сильнее. Ещё час, день, неделя, - какая сейчас уже разница? - и эльф не успеет увернуться. И тогда Муэлькэр использовал свой последний резерв - всё своё тайное магическое знание, что успел почерпнуть в Трионе и не только. Он высосал до остатка всю силу своего тела, своей души, души священных деревьев в своём городе и искромсал могучее тело Беркага всей этой мощью. Уже погибая, уходя в Хаос, так как с этим миром его не связывало больше ни его тело, ни его душа, Муэлькэр почерпнул ещё немного из души умершего Беркага и направил эту силу на лавовых гномов.#/$   Погибли почти все гномы. Лишь два десятка осталось стоять - видимо удар прошёл мимо них. Эльфов же оставалось ещё несколько сотен. Им предложили остановиться, уйти как можно дальше от этих мест, хотя эльфы мало верили в благоразумие гномов. Но, как ни странно, те согласились. Не сказав ни слова, повернулись и всё так же тихо ушли куда-то на запад. Никто не знает где они сейчас, возможно, что и вымерли... А горы, Красные горы, тоже заснули, потом и вовсе умерли. Из них ушла жизнь, волшебство иссякло.#/$- Фух, аж слеза берёт. Да, жалко мне их, жалко...
btn forestprotrmtortalkhello, - Ещё кое-что...
end

:forestprotrmtortalkstop
число=5
proc rnd
proc replicbye
torknow=1
pln - Здесь ты не пройдёшь.#/$- Это ещё чего?#/$- Потому что так сказал я. Я, Тор из клана Белого Камня, должен охранять этот проход от таких вот, как ты.#/$- И как же мне тогда пройти?#/$- Никак. Просто поворачивай и уходи. Ради собственной безопасности. - Гном поднял повыше свой двуручный топор.
btn forestprotrmtortalkmenace, - А так ли ты уверен в своих силах?
btn forestprotrmtortalktrick, - Возможно благородный гном пропустит меня за вознаграждение?
if tavernstraidertablestraytalktotor=1 then btn forestprotrmtortalkfromtray, - Трэй сказал, что я могу здесь пройти
btn forestprotrm, - #%bye$, Тор.
btn forestprotrmtorfight, Атаковать Тора
end

:forestprotrmtortalkmenace
число=5
proc rnd
proc replicbye
pln - Я более, чем уверен! А ещё я уверен в остроте своего топора!
btn forestprotrmtortalktrick, - Возможно благородный гном пропустит меня за вознаграждение?
if tavernstraidertablestraytalktotor=1 then btn forestprotrmtortalkfromtray, - Трэй сказал, что я могу здесь пройти
btn forestprotrm, - #%bye$, Тор.
btn forestprotrmtorfight, Атаковать Тора
end

:forestprotrmtortalktrick
число=5
proc rnd
proc replicbye
pln - Ты за кого меня держишь, чтоб я, Тор из клана Белого Камня, брал какие-то взятки? Ты, дружище, начинаешь мне уже надоедать.
btn forestprotrmtortalkmenace, - А так ли ты уверен в своих силах?
if tavernstraidertablestraytalktotor=1 then btn forestprotrmtortalkfromtray, - Трэй сказал, что я могу здесь пройти
btn forestprotrm, - #%bye$, Тор.
btn forestprotrmtorfight, Атаковать Тора
end

:forestprotrmtortalkfromtray
число=5
proc rnd
proc replicbye
forestprotrmtorblock=0
pln - Знаешь Трэя? Хмм, ну ладно, мой брат кому попало тайную информацию не расскажет. Погодь, погодь, а он там не пьяный случаем?#/$- Да нет, в полной трезвости ума.#/$- Ну тогда ладно, проходи. Правда опасно там, темно. Того и гляди споткнёшься обо что-то да шею сломаешь. Так что ты там того, поосторожней.
btn forestprotrmtortalktunnel, - Из-за чего произошёл завал?
btn forestprotrmtortalkrm, - Расскажи мне о Красных Горах
btn forestprotrm, - #%bye$, Тор.
btn forestprotrmtorfight, Атаковать Тора
end

:forestprottowc
p #%name$ пошёл навстречу злобному вою голодного дикого зверя. 
if удача>1 and forestprottowcwolfs=0 then goto forestprottowcwolf
minute=minute+5
число=3
proc rnd
if рнд<3 then goto forestprottowcwolftrap
goto forestprottowcfindbody
end

:forestprottowcwolftrap
pln Пройдя довольно большой путь, #%name$ наконец нашёл то, что искал - натолкнулся на волка, пирующего над останками какого-то искателя приключений.
instr locname=forestprottowcfindbody
btn forestprotwolffight, Сражаться
end

:forestprottowcwolf
dangerplace=1
minute=minute+5
pln #%name$ шёл на волчий вой, как вдруг к нему сзади подошёл здоровый волк.
instr locname=forestprottowcwolf1
forestprottowcwolvess=1
btn forestprotwolffight, Сражаться
end

:forestprottowcfindbody
dangerplace=0
p #%name$ нашёл труп загрызенного молодого человека.
if forestprottowcfindbodys=0 then pln Вся его одежда порвана на части и запятнана кровью, но из кармана куртки вылезает кончик какого-то блокнота. & btn forestprottowcfindbodypaper, Обыскать труп
btn forestprotcross, Вернуться к перекрёстку
end

:forestprottowcfindbodypaper
forestprottowcfindbodys=1
pln Кроме дневника, у этого бедолаги на пальце вы обнаружили золотое кольцо. Недолго думая, вы всё это взяли.
inv+ Дневник_Рилла_Криома
inv+ Кольцо_Рилла_Криома
btn forestprotcross, Вернуться к перекрёстку
end

:forestprottowcwolf1
dangerplace=0
pln Обыскав мёртвого волка, #%name$ ничего не нашёл.
if зеленокожий=1 then btn forestprottowcwolfdie, Забрать мясо волка
btn forestprottowc, Идти на волчий вой
btn forestprotcross, Вернуться к перекрёстку
end

:forestprotfindginka
от=3
до=5
proc rnd()
findginkatimes=рнд
goto forestprotfindginka1

:forestprotfindginka1
pln #%name$ сошёл с тропинки и зашагал навстречу высоким, покрытым мхом, деревьям, растущим чуть ли не на каждом шагу. Отойдя на порядочное расстояние, #%name$ задумался, идти ли навстречу опасностям или повернуть, пока ещё не поздно.
btn forestprotfindginka3, Искать растение Гинка
btn forestprotcross, Вернуться к перекрёстку
end

:forestprotfindginka2
dangerplace=0
pln Обыскав мёртвого волка, #%name$ ничего не нашёл.
if зеленокожий=1 then btn forestprotfindginkawolfdie, Забрать мясо волка
btn forestprotfindginka3, Искать растение Гинка
btn forestprotcross, Вернуться к перекрёстку
end

:forestprotfindginkawolfdie
pln #%name$ разделал тушу и забрал мясо волка.
inv+ Сырое_мясо
весинв=весинв+1
freshmeat=#inv_Сырое_мясо$
btn forestprotfindginka3, Искать растение Гинка
btn forestprotcross, Вернуться к перекрёстку
end

:forestprotfindginka3
minute=minute+5
findginkatimes=findginkatimes-1
if findginkatimes=0 then pln #%name$ наткнулся на коричневое растение, растущее в тени от большого дуба. Найдя предмет своих поисков, #%name$ вырвал растение с корнем и спрятал у себя понадёжней.#/$#/$ & inv+ Корень_гинка & forestprotfindginkas=1 & goto forestprotcross
dangerplace=1
pln Пока #%name$ искал растение Гинка, дикий волк незаметно подкрался сзади.
instr locname=forestprotfindginka2
btn forestprotwolffight, Сражаться
end

:forestprotnt
btn tavernstraider, Зайти в таверну
p #%name$ находится около таверны "Заблудший странник". Таверна находится метрах в тридцати от окраины леса. 
if hour<7 and hour>5 then p Лучи рассвета пылают на востоке. 
if hour>6 and hour<18 then p Солнце светит вам прямо в голову. 
if hour<6 or hour>17 then p Темнота окутала всё вокруг вас. 
p Из-за двери таверны доносятся громкие голоса. 
if furgotdie=0 and hour>8 and hour<17 then p Слышно, как за таверной кто-то колит дрова. 
btn tavernstraideraround, Обойти таверну
p На юге виднеются пшеничные поля - значит где-то там есть деревня или город.
btn forestprotfield, Идти на юг
btn forestprotcross, Идти в лес
end

:tavernstraideraround
proc screenpar
p #%name$ обошёл таверну кругом и увидел 
if hour<9 and hour>16 and furgotdie=0 or tavernstraidertablesfurgots=1 then tavernstraideraroundfurgots=0
if furgotdie=0 and hour>8 and hour<17 and tavernstraidertablesfurgots=0 and tavernstraiderbarroomfurgots=0 and интеллект<2 and furgotknow=0 then pln существо, колющее дрова. Существо выглядит совсем уставшим, с него просто рекой течёт пот. & tavernstraideraroundfurgots=1 & btn tavernstraideraroundfurgottalk, Поговорить с существом
if furgotdie=0 and hour>8 and hour<17 and tavernstraidertablesfurgots=0 and tavernstraiderbarroomfurgots=0 and furgotknow=1 then pln Фургота, колющего дрова. Фургот выглядит совсем уставшим, с него просто рекой течёт пот. & tavernstraideraroundfurgots=1 & btn tavernstraideraroundfurgottalk, Поговорить с Фурготом
if furgotdie=0 and hour>8 and hour<17 and tavernstraidertablesfurgots=0 and tavernstraiderbarroomfurgots=0 and интеллект>1 and furgotknow=0 then pln молодого полу-орка, колющего дрова. Полу-орк выглядит совсем уставшим, с него просто рекой течёт пот. & tavernstraideraroundfurgots=1 & btn tavernstraideraroundfurgottalk, Поговорить с полу-орком
if furgotdie=0 and tavernstraideraroundfurgots=1 then steals=1
instr locname=tavernstraideraround
instr stealloc=tavernstraideraroundsteal
if tavernstraideraroundfurgots=0 and hour<9 then pln кучу неколотых дров.
if tavernstraideraroundfurgots=0 and hour>8 then pln кучу щепок, лежащих на земле.
if furgotdie=1 and tavernstraideraroundfurgots=1 then pln мёртвого полу-орка, лежащего в луже собственной крови. & btn tavernstraideraroundfurgotdie, Обыскать труп
btn forestprotnt, Идти ко входу в таверну
end

:tavernstraideraroundfurgotdie
p У полу-орка 
if furgotaxes=1 then pln в руке зажат топорик. & btn tavernstraideraroundfurgotdieaxe, Взять топорик
if furgotaxes=0 then pln ничего нет.
if furgotmeat=1 and зеленокожий=1 then btn tavernstraideraroundfurgotdiemeat, Забрать мясо
btn tavernstraideraround, Отойти от трупа
end

:tavernstraideraroundfurgotdieaxe
instr cname=furgot
proc takeaxe
goto tavernstraideraroundfurgotdie
end
 :tavernstraideraroundfurgotdiemeat
pln #%name$ забрал ещё свежее мясо мёртвого полу-орка
inv+ Сырое_мясо
весинв=весинв+1
if годностьмяса<1 then годностьмяса=6
freshmeat=#inv_Сырое_мясо$
furgotmeat=0
goto tavernstraideraroundfurgotdie
end

:tavernstraideraroundfurgottalk
proc dialogpar
if furgotknow=1 then instr cname=, Фургот
if furgotknow=0 then instr cname=
число=5
proc rnd
proc replicbye
if furgotknow=1 then число=7 & proc rnd & proc replichello & pln - #%hello$, #%name$!
if furgotknow=0 then число=7 & proc rnd & proc replichello & pln - #%hello$!
число=7
proc rnd
proc replichello
if интеллект>=0 then btn tavernstraideraroundfurgottalkhello, - #%hello$#%cname$!
if интеллект<0 then btn tavernstraideraroundfurgottalkstupid, Пробормотать что-то невнятное
if интеллект>=0 then btn tavernstraideraround, - #%bye$#%cname$.
if интеллект<0 then btn tavernstraideraround, Отойти
instr cname=полу-орка
if интеллект<2 then instr cname=существо
if furgotknow=1 then instr cname=Фургота
btn tavernstraideraroundfurgotfight, Атаковать #%cname$
end

:tavernstraideraroundfurgottalkstupid
p - А? Ничё не понял, что ты сказал! Ты
if зеленокожий=1 then p , братец, 
p иди протрезвей, а уж потом в разговоры вступай!
btn tavernstraideraround, Отойти
end

:tavernstraideraroundfurgottalkhello
proc replicbye
число=2
proc rnd
instr locname=tavernstraideraroundfurgotdie
if рнд=1 then pln - Я ваще щас занят, паря... Но... Э... Ладно, минутка у меня найдётся.
if рнд=2 then pln - Дык, чего тебе? Не видишь - я работаю. Ну ладно, говори - чё надо?
btn tavernstraideraroundfurgottalkwork, - Ты работаешь в таверне?
if tavernstraideraroundfurgottalkwoods=0 then btn tavernstraideraroundfurgottalkwood, - Много ещё наколоть нужно? 
if tavernstraideraroundfurgottalkwoods=1 then btn tavernstraideraroundfurgottalkwoodyes, Колоть дрова
if furgotknow=0 then btn tavernstraideraroundfurgottalkabout, - Будем знакомы, меня зовут #%name$
if furgotknow=1 then instr cname=, Фургот
if furgotknow=0 then instr cname=
btn tavernstraideraround, - #%bye$#%cname$
if furgotknow=0 then instr cname=полу-орка
if furgotknow=1 then instr cname=Фургота
btn tavernstraideraroundfurgotfight, Атаковать #%cname$
end

:tavernstraideraroundfurgottalkwork
furgottalkvalmes=1
pln - Ага. Меня нанял этот старый сатир Валмес. И теперя я должен каждый день ему дровки колоть, - а то, посетители, видите ли, замёрзнуть совсем! Бррр, эта работа совсем не для меня! Не, ну конечно, сила-то у меня есть... Но я б лучше с силой этой вражин рубил, а не дрова колол! Бррр!!!
btn tavernstraideraroundfurgottalkwork, - Ты работаешь в таверне?
if tavernstraideraroundfurgottalkwoods=0 then btn tavernstraideraroundfurgottalkwood, - Много ещё наколоть нужно?
if tavernstraideraroundfurgottalkwoods=1 then btn tavernstraideraroundfurgottalkwoodyes, Колоть дрова
if furgotknow=0 then btn tavernstraideraroundfurgottalkabout, - Будем знакомы, меня зовут #%name$
if furgotknow=1 then instr cname=, Фургот
if furgotknow=0 then instr cname=
btn tavernstraideraround, - #%bye$#%cname$
if furgotknow=0 then instr cname=полу-орка
if furgotknow=1 then instr cname=Фургота
btn tavernstraideraroundfurgotfight, Атаковать #%cname$
end

:tavernstraideraroundfurgottalkwoodyes
p #%name$ около 
if сила>4 then p часа & hour=hour+1
if сила=4 then p полутора часа & hour=hour+1 & minute=minute+30
if сила=2 or сила=3 then p двух часов & hour=hour+2
if сила=1 then p трёх часов & hour=hour+3
p колол дрова из здоровой охапки, которую принёс 
if furgotknow=0 then pln полу-орк.
if furgotknow=1 then pln Фургот.
бодрость=бодрость-2
выносливость=выносливость-2
опыт=опыт+3+харизма
instr weapname=владения топором
instr weapexp=знаниетопора
weapbonus=знаниетопора
опытзнаниетопора=опытзнаниетопора+2
if опыт>=нужныйопыт#уровень+1$ then proc checklevup
tavernstraideraroundfurgottalkwoods=2
instr locname=tavernstraideraroundfurgottalkwooddone
goto #%locname$
end

:tavernstraideraroundfurgottalkwooddone
proc dialogpar
instr cname=furgot
p #/$- Ну, дык, вроде как спасибо! Не забуду!
if харизма>1 and furgotaxes=1 then p Вот, держи - для хорошего че& proc tavernstraideraroundfurgottalkwoodyesrace & pln ничего не жалко! (Он протягивает вам свой топор) & proc takeaxe
btn tavernstraideraroundfurgottalkhello, Продолжить разговор
btn tavernstraideraround, Закончить разговор
end
 :tavernstraideraroundfurgottalkwoodyesrace
if раса=1 then p ловека 
if раса>1 then p ...#%race$а
end

:takeaxe
if сила<3 and мешок=0 then pln Подержав топорик немного, #%name$ понял, что это оружие не для него - слишком уж оно тяжёлое.
if колоружия=1 and сила<весоружия+3 then pln У вас уже есть одно оружие, а чтобы поднять второе, вам не хватает силы.
if колоружия=2 and мешок=0 then pln У вас заняты обе руки.
if колоружия>0 and сила>2 and мешок=1 then pln #%name$ взял простенький самодельный топор и положил его в свой мешок.#/$ & inv+ Топор_дровосека & весинв=весинв+2 & #%cname$axes=#%cname$axes-1
if колоружия=0 and сила>2 and мешок=0 or колоружия=1 and сила>весоружия+3 and мешок=0 then pln #%name$ взял простенький самодельный топор.#/$ & inv+ Топор_дровосека & весоружия=весоружия+3 & колоружия=колоружия+1 & #%cname$axes=#%cname$axes-1
end

:takeaxe1
if сила<4 and мешок=0 then pln Подержав топорик немного, #%name$ понял, что это оружие не для него - слишком уж оно тяжёлое.
if колоружия=1 and сила<весоружия+4 and мешок=0 then pln У вас уже есть одно оружие, а чтобы поднять второе, вам не хватает силы.
if колоружия=2 & мешок=0 then pln У вас заняты обе руки.
if колоружия>0 and сила>3 and мешок=1 then pln #%name$ взял малый топор и положил его в свой мешок.#/$ & inv+ Малый_топор & весинв=весинв+3 & #%cname$axes=#%cname$axes-1
if колоружия=0 and сила>3 and мешок=0 or колоружия=1 and сила>весоружия+4 and мешок=0 then pln #%name$ взял малый топор.#/$ & inv+ Малый_топор & весоружия=весоружия+4 & колоружия=колоружия+1 & #%cname$axes=#%cname$axes-1
end

:takeaxe2
if сила<5 or колоружия>0 and мешок=0 and размер<3 or колоружия=1 and размер=3 and сила<весоружия+5 then pln #%name$ с трудом поднял двуручный топор, попытался взмахнуть и тут же выронил - настолько он показался вам неподъёмным.
if сила>4 and колоружия=0 and размер=3 or сила>=весоружия+5 and колоружия=1 and размер=3 then pln #%name$ взял довольно большой топор в одну свободную руку. & колоружия=колоружия+1 & весоружия=весоружия+5 & inv+ Двуручный_топор & #%cname$axes=0
if сила>4 and колоружия=0 and размер<3 or сила>4 and колоружия=1 and размер<3 and мешок=1 then pln #%name$ поднял тяжёлый двуручный топор и закинул увесистое остриё себе на плечо. & колоружия=колоружия+2 & весоружия=весоружия+5 & inv+ Двуручный_топор & #%cname$axes=0
end

:takewand
if сила<2 or колоружия>0 and мешок=0 then pln #%name$ взял посох в руку, однако ходить, переставляя его, оказалось не таким уж лёгким делом. Немного поразмыслив, #%name$ решил, что легче будет идти, ни обо что не опираясь.
if сила>1 and колоружия=0 or сила>1 and колоружия=1 and мешок=1 then pln #%name$ взял посох в руку, немного повертел его, и решил взять с собой. & колоружия=колоружия+2 & весоружия=весоружия+3 & inv+ Посох_друида & #%cname$wands=0 & максмана=максмана+6
end

:takewand(i)
if сила<2 or колоружия>0 and мешок=0 then pln #%name$ взял посох в руку, однако ходить, переставляя его, оказалось не таким уж лёгким делом. Немного поразмыслив, #%name$ решил, что легче будет идти, ни обо что не опираясь.
if сила>1 and колоружия=0 or сила>1 and колоружия=1 and мешок=1 then pln #%name$ взял посох в руку, немного повертел его, и решил взять с собой. & колоружия=колоружия+2 & весоружия=весоружия+3 & inv+ Посох_маны & #%cname$wands=0 & максмана=максмана+6
end

:tavernstraideraroundfurgottalkwood
tavernstraideraroundfurgottalkwoods=1
pln - Эээ... Ну работы тут часа на два. Если хош, то помоги. Только сразу говорю - денёг в меня нету, так шо ничего я тебе за это не дам.
btn tavernstraideraroundfurgottalkwoodyes, Колоть дрова
btn tavernstraideraroundfurgottalkhello, - Может, как-нибудь потом
end

:tavernstraideraroundfurgottalkabout
pln - А меня Фурготом, значить кличат. Ох, и надоела ж мне эта скучная работа!
tavernstraideraroundfurgottalkabouts=1
furgotknow=1
btn tavernstraideraroundfurgottalkwork, - Ты работаешь в таверне?
if tavernstraideraroundfurgottalkwoods=0 then btn tavernstraideraroundfurgottalkwood, - Много ещё наколоть нужно? 
if tavernstraideraroundfurgottalkwoods=1 then btn tavernstraideraroundfurgottalkwoodyes, Колоть дрова
if furgotknow=0 then btn tavernstraideraroundfurgottalkabout, - Будем знакомы, меня зовут #%name$
число=5
proc rnd
proc replicbye
if furgotknow=1 then instr cname=, Фургот
if furgotknow=0 then instr cname=
btn tavernstraideraround, - #%bye$#%cname$
if furgotknow=0 then instr cname=полу-орка
if furgotknow=1 then instr cname=Фургота
btn tavernstraideraroundfurgotfight, Атаковать #%cname$
end

:tavernstraideraroundsteal
cls
proc screenpar
pln Выберите жертву.
if furgotdie=0 and furgotknow=0 then btn furgotsteal, полу-орк
if furgotdie=0 and furgotknow=1 then btn furgotsteal, Фургот
btn #%locname$, Вернуться
end

:furgotsteal
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
if furgotknow=1 then p У Фургота
if furgotknow=0 then p У полу-орка
if furgotaxes=1 then instr style_formpicture=heroimages/noarmor/noshoes/nocap/2.bmp& pln есть топор дровосека. & btn furgotstealaxe, Воровать топор дровосека
if furgotaxes=0 then pln ничего нет.
btn #%locname$, Вернуться
end

:furgotstealaxe
число=12
proc rnd
instr cname=furgot
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<9 then опытворовство=опытворовство+1 & pln Вас заметили! & instr locname=tavernstraideraroundfurgotdie & btn tavernstraideraroundfurgotfight, Сражаться насмерть
if удачливость=9 or удачливость=10 then instr locname=tavernstraideraroundfurgotfight & pln Кража удалась, но вас заметили! #%name$ украл топор дровосека. & опытворовство=опытворовство+1 & опыт=опыт+харизма & proc takeaxe & btn tavernstraideraroundfurgotfight, Сражаться насмерть & proc checklevup
if удачливость>10 and удачливость<=14 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>14 then опытворовство=опытворовство+1 & опыт+2+харизма & instr locname=tavernstraideraround & pln Кража удалась! #%name$ украл топор дровосека. & proc takeaxe & proc checklevup
if удачливость>10 and furgotaxes=1 then btn furgotstealaxe, Попробовать ещё раз 
if удачливость>10 then btn #%locname$, Вернуться
proc stealup
end

:tavernstraider
p #%name$ находится в таверне "Заблудший странник". В небольшом помещении стоят несколько деревянных столиков. 
if hour>5 and hour<18 then p Свет солнца отражается на полу четырьмя квадратами, проходя через широкое окно.
if hour>17 or hour<6 then p Все окна закрыты, а на стенах горят несколько масляных ламп.
p Недалеко от вас находится барная стойка. В дальнем конце помещения есть лестница, ведущая на второй этаж, к постоялым номерам.
btn tavernstraidertables, К столикам
btn tavernstraiderbar, К барной стойке
btn tavernstraiderstairsup, Подняться по лестнице
if not Кружка_пива then btn forestprotnt, Выйти из таверны
if Кружка_пива then btn tavernstraidernoexit, Выйти из таверны
end

:tavernstraidernoexit
pln Прежде, чем выйти из таверны, нужно каким-либо образом распрощаться с кружкой пива - либо выпить, либо оставить не выпитой.#/$
goto tavernstraider

:tavernstraidertables
proc screenpar
instr locname=tavernstraidertables
instr stealloc=tavernstraidertablessteal
if krildie=0 then tavernstraidertableskrils=0
if hour>6 or hour<23 then tavernstraidertableskrils=1
if traydie=0 then tavernstraidertablestrays=0
if hour>6 or hour<23 then tavernstraidertablestrays=1
if alliradie=0 then tavernstraidertablesalliras=0
if month=3 and year=1764 and day=10 and hour<10 and tavernstraidertablesallirarun=0 then tavernstraidertablesalliras=1
if tavernstraideralert=1 and tavernstraidertablesalliras=1 and alliradie=0 and tavernstraiderbarvalmess=1 and valmesdie=1 and tavernstraidertableskrils=1 and krildie=1 and tavernstraidertablestrays=1 and traydie=1 then pln Полу-эльфийка благоразумно решила выбежать из таверны, увидев, как #%name$ убил всех кроме неё. & tavernstraidertablesallirarun=1
if tavernstraiderbarvalmess=1 and valmesdie=1  and tavernstraidertableskrils=1 and krildie=1 and furgotdie=1 and tavernstraidertablestrays=1 and traydie=1 and furgotdie=1 then tavernstraideralert=0 & dangerplace=0
if tavernstraidertableskrils=1 and krildie=1 and tavernstraideralert=1 or tavernstraidertablesalliras=1 and alliradie=1 and tavernstraideralert=1 or tavernstraidertablestrays=1 and traydie=1 and tavernstraideralert=1 then pln То, что вы совершили, явно не понравилось другим посетителям таверны. & goto tavernstraiderenemy
p #%name$ подошёл к четырём столикам. 
if tavernstraidertablesalliras=1 and alliradie=0 or tavernstraidertableskrils=1 and krildie=0 or tavernstraidertablestrays=1 and traydie=0 then p За ними сидит & steals=1
if tavernstraidertablesalliras=0 and tavernstraidertablestrays=0 and tavernstraiderkrils=0 then p никто не сидит.
if tavernstraidertablesalliras=1 and alliraknow=0 and alliradie=0 then p полу-эльфийка и  & btn tavernstraidertablesalliratalk, Поговорить с полу-эльфийкой
if tavernstraidertablesalliras=1 and alliraknow=1 and alliradie=0 then p полу-эльфийка Аллира и  & btn tavernstraidertablesalliratalk, Поговорить с Аллирой
if tavernstraidertableskrils=1 and krilknow=0 and krildie=0 then p человек в тёмно-коричневом плаще. & btn tavernstraidertableskriltalk, Поговорить с человеком в плаще
if tavernstraidertableskrils=1 and krilknow=1 and krildie=0 then p друид Крил. & btn tavernstraidertableskriltalk, Поговорить с Крилом
if tavernstraidertablestrays=1 and traydie=0 then p За третьим столиком спит, уткнувшись лицом в тарелку, 
if tavernstraidertablestrays=1 and trayknow=0 and traydie=0 then p гном& btn tavernstraidertablestraytalk, Поговорить с гномом
if tavernstraidertablestrays=1 and trayknow=1 and traydie=0 then p гном Трэй& btn tavernstraidertablestraytalk, Поговорить с Трэем
if tavernstraidertablesalliras=1 and alliradie=0 or tavernstraidertablestrays=1 and traydie=0 then p .
if tavernstraidertablesalliras=1 and alliradie=1 then p На полу лежит бездыханная полу-эльфийка. & btn tavernstraidertablesalliradie, Обыскать полу-эльфийку
if tavernstraidertableskrils=1 and krildie=1 then p С предсмертной яростью на лице здесь лежит человек в плаще. & btn tavernstraidertableskrildie, Обыскать человека
if tavernstraidertablestrays=1 and traydie=1 then p В луже собственной крови около вас валяется мёртвый гном. & btn tavernstraidertablestraydie, Обыскать гнома
if tavernstraidertablesfurgots=1 and furgotdie=1 then p Под массивным телом мёртвого полу-орка прогинаются половицы. & btn tavernstraidertablesfurgotdie, Обыскать полу-орка
btn tavernstraider, Отойти от столиков
end

:tavernstraiderenemy
if tavernstraidertablestrays=1 and traydie=0 then pln - Эй, мне совсем не понравилось, как ты поступил и, похоже, теперь тебе придётся за это ответить! - Крикнул гном, вскочил из-за стола и ринулся в атаку. & goto tavernstraidertablestrayfight
if tavernstraiderbarvalmess=1 and valmesdie=0 then pln - Я не позволю, чтобы такой мусор как ты убивал честных посетителей в моей таверне! - Разъярённый сатир вышел из-за барной стойки и начал драку. & goto tavernstraiderbarvalmesfight
if tavernstraidertableskrils=1 and krildie=0 and tavernstraiderbarvalmess=1 and valmesdie=1 then pln - Ты нарушил мой покой и убил ни в чём не повинного владельца таверны, моего старого друга. Умри с честью, подлец! - Друид встал из-за стола и на вас пала тяжесть его тёмно-карих глаз. & goto tavernstraidertablesfightkril
if furgotdie=0 then pln Через несколько секунд в таверну вбежал полу-орк и бросился в атаку.#/$ & tavernstraideraroundfurgots=0 & tavernstraidertablesfurgots=1 & goto tavernstraidertablesfurgotfight
end

:tavernstraidertablestraydie
if trayknow=1 then p У Трэя 
if trayknow=0 then p У гнома 
if trayaxes=0 and traymatches=0 and traygold=0 then p ничего нет, 
if traygold>0 then p есть #traygold$ Гил, & btn tavernstraidertablestraydiegold, Взять деньги
if trayaxes=1 then p в руке зажат малый топор, & btn tavernstraidertablestraydieaxe, Взять топор
if traymatches=1 then p из кармана выглядывает край коробка спичек, & btn tavernstraidertablestraydiematches, Взять коробок со спичками
pln всё его тело в страшных ранах.
if traymeat=1 and зеленокожий=1 then btn tavernstraidertablestraydiemeat, Забрать мясо
btn tavernstraidertables, Вернуться
end

:tavernstraidertablestraydieaxe
instr cname=tray
proc takeaxe1
goto tavernstraidertablestraydie
end

:tavernstraidertablestraydiegold
pln #%name$ взял #traygold$ Гил.
inv+ #traygold$, Гил
traygold=0
goto tavernstraidertablestraydie
end

:tavernstraidertablestraydiemeat
pln #%name$ забрал ещё свежее мясо мёртвого гнома
inv+ Сырое_мясо
весинв=весинв+1
if годностьмяса<1 then годностьмяса=6
freshmeat=#inv_Сырое_мясо$
traymeat=0
goto tavernstraidertablestraydie
end

:tavernstraidertablestraydiematches
pln #%name$ взял коробок спичек и положил его себе в карман.
inv+ Коробок_спичек
matches=matches+50
traymatches=0
goto tavernstraidertablestraydie
end

:tavernstraidertablesfurgotdie
p У полу-орка 
if furgotaxes=1 then pln в руке зажат топорик. & btn tavernstraidertablesfurgotdieaxe, Взять топорик
if furgotaxes=0 then pln ничего нет.
if furgotmeat=1 and зеленокожий=1 then btn tavernstraidertablesfurgotdiemeat, Забрать мясо
btn tavernstraidertables, Отойти от трупа
end

:tavernstraidertablesfurgotdieaxe
instr cname=furgot
proc takeaxe
goto tavernstraidertablesfurgotdie
end

:tavernstraidertablesfurgotdiemeat
pln #%name$ забрал ещё свежее мясо мёртвого полу-орка
inv+ Сырое_мясо
весинв=весинв+1
if годностьмяса<1 then годностьмяса=6
freshmeat=#inv_Сырое_мясо$
furgotmeat=0
goto tavernstraidertablesfurgotdie
end

:tavernstraidertableskrildie
if krilknow=1 then p У мёртвого Крила 
if krilknow=0 then p У мёртвого человека 
if krilrobess=0 and krilsandaless=0 and krilwands=0 and krilgold=0 then p ничего нет, 
if krilgold>0 then p есть #krilgold$ Гил, & btn tavernstraidertableskrildietakegold, Взять деньги
if krilwands=1 then p в руке зажат деревянный посох, & btn tavernstraidertableskrildietakewand, Взять посох
if krilrobes=1 then p на нём надет плащ тёмно-коричневого цвета, & btn tavernstraidertableskrildietakerobe, Взять плащ
if krilsandaless=1 then p на ногах простые сандалии, & btn tavernstraidertableskrildietakesandales, Взять сандалии
pln по его лбу стекает тонкая струйка крови.
if krilmeat=1 and зеленокожий=1 then btn tavernstraidertableskrildiemeat, Забрать мясо
btn tavernstraidertables, Вернуться
end

:tavernstraidertableskrildiemeat
pln #%name$ забрал ещё свежее мясо мёртвого друида
inv+ Сырое_мясо
весинв=весинв+1
if годностьмяса<1 then годностьмяса=6
freshmeat=#inv_Сырое_мясо$
krilmeat=0
goto tavernstraidertableskrildie
end

:tavernstraidertableskrildietakegold
pln #%name$ взял #krilgold$ Гил.
inv+ #krilgold$, Гил
krilgold=0
goto tavernstraidertableskrildie
end

:tavernstraidertableskrildietakerobe
instr cname=kril
proc takerobe
goto tavernstraidertableskrildie
end

:tavernstraidertableskrildietakewand
instr cname=kril
proc takewand
goto tavernstraidertableskrildie
end

:tavernstraidertableskrildietakesandales
instr cname=kril
proc takesandales
goto tavernstraidertableskrildie
end

:tavernstraidertablesalliradie
p У лежащей на полу полу-эльфийки 
if alliraknow=1 then p Аллиры 
if alliragold=0 and allirahplant=0 and alliramplant=0 and allirabmush=0 then pln ничего нет.
if alliragold>0 or allirahplant>0 or alliramplant>0 or allirabmush>0 then p есть 
if alliragold>0 then p #alliragold$ Гил, & btn tavernstraidertablesalliradiegil, Взять деньги
if allirahplant>1 then p #allirahplant$ лечебные травы, & btn tavernstraidertablesalliradiehplant, Взять лечебную траву
if allirahplant=1 then p лечебная трава, & btn tavernstraidertablesalliradiehplant, Взять лечебную траву
if alliramplant>1 then p #alliramplant$ манновые ромашки, & btn tavernstraidertablesalliradiemplant, Взять манновую ромашку
if alliramplant=1 then p манновая ромашка, & btn tavernstraidertablesalliradiemplant, Взять манновую ромашку
if allirabmush>1 then p #allirabmush$ пакетика с соком синего гриба, & btn tavernstraidertablesalliradiebmush, Взять сок синего гриба
if allirabmush=1 then p пакетик с соком синего гриба, & btn tavernstraidertablesalliradiebmush, Взять сок синего гриба
if alliragold>0 or allirahplant>0 or alliramplant>0 or allirabmush>0 then pln  её безжизненные зелёные глаза с ужасом смотрят куда-то перед собой.
if allirameat=1 and зеленокожий=1 then btn tavernstraidertablesalliradiemeat, Забрать мясо
btn tavernstraidertables, Вернуться
end

:tavernstraidertablesalliradiemeat
pln #%name$ заvernstraidertableskrildie
if krilknow=1 then p У мёртвого Крила 
if krilknow=0 then p У мёртвого человека 
if krilrobess=0 and krilsandaless=0 and krilwands=0 and krilgold=0 then p ничего нет, 
if krilgold>0 then p есть #krilgold$ Гил, & btn tavernstraidertableskrildietakegold, Взять деньги
if krilwands=1 then p в руке зажат деревянный посох, & btn tavernstraidertableskrildietakewand, Взять посох
if krilrobes=1 then p на нём надет плащ тёмно-коричневого цвета, & btn tavernstraidertableskrildietakerobe, Взять плащ
if krilsandaless=1 then p на ногах простые сандалии, & btn tavernstraidertableskrildietakesandales, Взять сандалии
pln по его лбу стекает тонкая струйка крови.
if krilmeat=1 and зеленокожий=1 then btn tavernstraidertableskrildiemeat, Забрать мясо
btn tavernstraidertables, Вернуться
endл ещё свежее мясо мёртвой полу-эльфийки inv+ Сырое_мясо
весинв=весинв+1
if годностьмяса<1 then годностьмяса=6
freshmeat=#inv_Сырое_мясо$
allirameat=0
goto tavernstraidertablesalliradie
end

:tavernstraidertablesalliradiehplant
pln #%name$ взял лечебную траву.#/$
allirahplant=allirahplant-1
inv+ Лечебная_трава
goto tavernstraidertablesalliradie
end

:tavernstraidertablesalliradiemplant
pln #%name$ взял манновую ромашку.#/$
alliramplant=alliramplant-1
inv+ Манновая_ромашка
goto tavernstraidertablesalliradie
end

:tavernstraidertablesalliradiebmush
pln #%name$ взял сок синего гриба.#/$
allirabmush=allirabmush-1
inv+ Сок_синего_гриба
goto tavernstraidertablesalliradie
end

:tavernstraidertablesalliradiegil
pln #%name$ обыскал мёртвую полу-эльфийку и вытащил из маленького мешочка на её поясе #alliragold$ Гил.
inv+ #alliragold$,Гил
alliragold=0
btn tavernstraidertablesalliradie, Назад
end

:takerobe
if actbody=1 and мешок=0 and размер<3 then pln На вас уже что-то надето, а положить плащ некуда.
if размер=3 then pln #%name$ слишком велик для этого плаща.
if actbody=0 and размер<3 then pln #%name$ надел на себя длинный коричневый плащ. & inv+ Плащ & весинв=весинв+1 & actbody=1 & бронятела=бронятела+1 & максмана=максмана+6 & #%cname$robes=0& instr imagearmor=robe& robes=1
if actbody=1 and размер<3 and мешок=1 then pln #%name$ взял коричневый плащ и положил его в мешок. & inv+ Плащ & весинв=весинв+1 & #%cname$robes=0
if мана>максмана+0.9 then мана=максмана+0.9
end

:takesandales
if actlegs=1 and мешок=0 and размер<3 then pln На вас уже что-то надето, а положить сандалии некуда.
if размер=3 then pln #%name$ слишком велик для этих сандалий.
if actlegs=0 and размер<3 then pln #%name$ надел на себя простые сандалии. & inv+ Сандалии & весобуви=весобуви+1 & sandaless=1 & actlegs=1 & броняног=броняног+1 & instr imageshoes=sandales& #%cname$sandaless=0
if actlegs=1 and размер<3 and мешок=1 then pln #%name$ взял сандалии и положил их в мешок. & inv+ Сандалии & весинв=весинв+1 & #%cname$sandaless=0
end

:tavernstraidertablessteal
cls
proc screenpar
pln Выберите свою жертву.
if tavernstraidertablesalliras=1 and alliraknow=0 then btn allirasteal, Полу-эльфийка
if tavernstraidertablesalliras=1 and alliraknow=1 then btn allirasteal, Аллира
if tavernstraidertableskrils=1 and krilknow=0 then btn krilsteal, Человек в плаще
if tavernstraidertableskrils=1 and krilknow=1 then btn krilsteal, Друид Крил
if tavernstraidertablestrays=1 and trayknow=0 then btn traysteal, Гном
if tavernstraidertablestrays=1 and trayknow=1 then btn traysteal, Гном Трэй
btn #%locname$, Вернуться
end

:traysteal
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
instr locname=tavernstraidertables
if trayknow=1 then p У Трэя 
if trayknow=0 then p У гнома 
if trayaxes=1 or traygold>0 or traymatches=1 then p есть 
if trayaxes=0 and traygold=0 and traymatches=0 then p ничего нет, 
if traygold>0 then p #traygold$ Гил, & btn traystealgold, Воровать деньги
if trayaxes=1 then instr style_formpicture=heroimages/noarmor/noshoes/nocap/3.bmp& p небольшой топор, & btn traystealaxe, Воровать топор
if traymatches=1 then p коробок спичек, & btn traystealmatches, Воровать спички
pln гном явно не в лучшем состоянии.
btn #%locname$, Вернуться
end
 :traystealmatches
число=3
proc rnd
instr locname=traysteal
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<3 then inv+ Коробок_спичек & matches=matches+50 & traymatches=0 & instr locname=tavernstraidertables & pln Кража удалась, но вас заметили! #%name$ украл коробок спичек. & опытворовство=опытворовство+1 & опыт=опыт+2+харизма & instr locname=tavernstraidertablestrayfight & proc checklevup & btn tavernstraidertablestrayfight, Сражаться насмерть
if удачливость>=3 then опытворовство=опытворовство+1 & опыт=опыт+харизма & inv+ Коробок_спичек & matches=matches+50 & traymatches=0 & pln Кража удалась! #%name$ украл коробок спичек. & proc checklevup
if удачливость>=3 then btn #%locname$, Вернуться
proc stealup
end

:traystealgold
число=7
proc rnd
instr cname=tray
instr locname=traysteal
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<=5 then опытворовство=опытворовство+1 & pln Вас заметили! & btn tavernstraidertablestrayfight, Сражаться насмерть
if удачливость>5 and удачливость<=6.5 then p Кража удалась, но вас заметили! & proc checkstealgold & опытворовство=опытворовство+1 & опыт=опыт+харизма & instr locname=tavernstraidertablestrayfight & proc checklevup & btn tavernstraidertablestrayfight, Сражаться насмерть
if удачливость>6.5 and удачливость<=8.5 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>8.5 then опытворовство=опытворовство+1 & опыт=опыт+2+харизма & p Кража удалась! & proc checkstealgold & proc checklevup
proc stealup
if удачливость>6.5 and traygold=0 then pln У Трэя больше нет денег. & goto traysteal
if удачливость>6.5 then btn traystealgold, Попробовать ещё раз & btn #%locname$, Вернуться
end

:traystealaxe
число=12
proc rnd
instr cname=tray
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<9 then опытворовство=опытворовство+1 & pln Вас заметили! & instr locname=tavernstraidertablestraydie & btn tavernstraidertablestrayfight, Сражаться насмерть
if удачливость=9 or удачливость=10 then instr locname=tavernstraidertablestrayfight & pln Кража удалась, но вас заметили! #%name$ украл малый топор. & опытворовство=опытворовство+1 & опыт=опыт+харизма & proc takeaxe1 & btn tavernstraideraroundfurgotfight, Сражаться насмерть & proc checklevup
if удачливость>10 and удачливость<=14 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>14 then опытворовство=опытворовство+1 & опыт+2+харизма & instr locname=tavernstraidertables & pln Кража удалась! #%name$ украл малый топор. & proc takeaxe1 & proc checklevup
if удачливость>10 and trayaxes=1 then btn traystealaxe, Попробовать ещё раз 
if удачливость>10 then btn #%locname$, Вернуться
proc stealup
end

:krilsteal
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
instr locname=tavernstraidertables
if krilknow=1 then p У Крила 
if krilknow=0 then p У человека 
if krilrobess=1 or krilsandaless=1 or krilwands=1 then p есть 
if krilrobes=1 and krilsandaless=1 and krilwands=0 then p плащ и сандалии.& instr style_formpicture=heroimages/robe/sandales/nocap/1.bmp& btn krilstealrobe, Воровать плащ& btn krilstealsandales, Воровать сандалии
if krilrobes=1 and krilsandaless=0 and krilwands=1 then p плащ и посох.& instr style_formpicture=heroimages/robe/noshoes/nocap/4.bmp& btn krilstealrobe, Воровать плащ& btn krilstealwand, Воровать посох
if krilrobes=0 and krilsandaless=1 and krilwands=1 then p сандалии и посох.& instr style_formpicture=heroimages/noarmor/sandales/nocap/4.bmp& btn krilstealsandales, Воровать сандалии& btn krilstealwand, Воровать посох
if krilrobes=1 and krilsandaless=1 and krilwands=1 then p плащ, сандалии и посох.& instr style_formpicture=heroimages/robe/sandales/nocap/4.bmp& btn krilstealrobe, Воровать плащ& btn krilstealsandales, Воровать сандалии& btn krilstealwand, Воровать посох
if krilrobes=1 and krilsandaless=0 and krilwands=0 then p плащ.& instr style_formpicture=heroimages/robe/noshoes/nocap/1.bmp& btn krilstealrobe, Воровать плащ
if krilrobes=0 and krilsandaless=1 and krilwands=0 then p сандалии.& instr style_formpicture=heroimages/noarmor/sandales/nocap/1.bmp& btn krilstealsandales, Воровать сандалии
if krilrobes=0 and krilsandaless=0 and krilwands=1 then pln посох.& instr style_formpicture=heroimages/noarmor/noshoes/nocap/4.bmp& btn krilstealwand, Воровать посох
if krilrobess=0 and krilsandaless=0 and krilwands=0 and krilgold<1 then p ничего нет, 
if krilgold>0 then p #krilgold$ Гил, & btn krilstealgold, Воровать деньги
pln судя по внешнему виду, этот человек - какой-то бродяга.
btn #%locname$, Вернуться
end

:krilstealsandales
число=12
proc rnd
instr cname=kril
instr locname=krilsteal
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<11 then опытворовство=опытворовство+1 & pln Вас заметили! & instr locname=tavernstraidertableskrildie & btn tavernstraidertablesfightkril, Сражаться насмерть
if удачливость=11 or удачливость=12 then instr locname=tavernstraidertablesfightkril & pln Кража удалась, но вас заметили! #%name$ украл сандалии. & опытворовство=опытворовство+1 & опыт=опыт+харизма & proc takesandales & btn tavernstraidertablesfightkril, Сражаться насмерть & proc checklevup
if удачливость>12 and удачливость<=16 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>16 then опытворовство=опытворовство+1 & опыт+2+харизма & instr locname=krilsteal & pln Кража удалась! #%name$ украл сандалии. & proc takesandales & proc checklevup
if удачливость>12 and krilsandaless=1 then btn krilstealsandales, Попробовать ещё раз 
if удачливость>12 then btn #%locname$, Вернуться
proc stealup
end

:krilstealrobe
число=12
 proc rnd
instr locname=krilsteal
instr cname=kril
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<11 then опытворовство=опытворовство+1 & pln Вас заметили! & instr locname=tavernstraidertableskrildie & btn tavernstraidertablesfightkril, Сражаться насмерть
if удачливость=11 or удачливость=12 then instr locname=tavernstraidertablesfightkril & pln Кража удалась, но вас заметили! #%name$ украл коричневый плащ. & опытворовство=опытворовство+1 & опыт=опыт+харизма & proc takerobe & btn tavernstraidertablesfightkril, Сражаться насмерть & proc checklevup
if удачливость>12 and удачливость<=16 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>16 then опытворовство=опытворовство+1 & опыт+2+харизма & instr locname=krilsteal & pln Кража удалась! #%name$ украл коричневый плащ. & proc takerobe & proc checklevup
if удачливость>12 and krilrobes=1 then btn krilstealrobe, Попробовать ещё раз 
if удачливость>12 then btn #%locname$, Вернуться
proc stealup
end

:krilstealwand
число=12
proc rnd
instr locname=krilsteal
instr cname=kril
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<11 then опытворовство=опытворовство+1 & pln Вас заметили! & instr locname=tavernstraidertableskrildie & btn tavernstraidertablesfightkril, Сражаться насмерть
if удачливость=11 or удачливость=12 then instr locname=tavernstraidertablesfightkril & pln Кража удалась, но вас заметили! #%name$ украл посох друида. & опытворовство=опытворовство+1 & опыт=опыт+харизма & proc takewand & btn tavernstraidertablesfightkril, Сражаться насмерть & proc checklevup
if удачливость>12 and удачливость<=16 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>16 then опытворовство=опытворовство+1 & опыт+2+харизма & instr locname=krilsteal & pln Кража удалась! #%name$ украл посох друида. & proc takewand & proc checklevup
if удачливость>12 and krilwands=1 then btn krilstealwand, Попробовать ещё раз 
if удачливость>12 then btn #%locname$, Вернуться
proc stealup
end

:krilstealgold
число=7
proc rnd
instr cname=kril
instr locname=krilsteal
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<=5 then опытворовство=опытворовство+1 & pln Вас заметили! & btn tavernstraidertablesfightkril, Сражаться насмерть
if удачливость>5 and удачливость<=6.5 then p Кража удалась, но вас заметили! & proc checkstealgold & опытворовство=опытворовство+1 & опыт=опыт+харизма & instr locname=tavernstraidertablesfightkril & proc checklevup & btn tavernstraidertablesfightkril, Сражаться насмерть
if удачливость>6.5 and удачливость<=8.5 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>8.5 then опытворовство=опытворовство+1 & опыт=опыт+2+харизма & p Кража удалась! & proc checkstealgold & proc checklevup
proc stealup
if удачливость>6.5 and krilgold=0 then pln У Крила больше нет денег. & goto krilsteal
if удачливость>6.5 then btn krilstealgold, Попробовать ещё раз & btn #%locname$, Вернуться
end

:allirasteal
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
instr locname=tavernstraidertables
if alliraknow=1 then p У Аллиры 
if alliraknow=0 then p У полу-эльфийки 
p есть лечебные травы, манновые ромашки, сок синего гриба 
if alliragold>0 then p и #alliragold$ Гил& btn allirastealgold, Воровать деньги
pln .
btn allirastealhplant, Воровать лечебную траву
btn allirastealmplant, Воровать манновую ромашку
btn allirastealbmush, Воровать сок синего гриба
btn #%locname$, Вернуться
end

:allirastealgold
число=7
proc rnd
instr cname=allira
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<=5 then опытворовство=опытворовство+1 & pln Вас заметили! & btn tavernstraidertablesallirafight, Сражаться насмерть
if удачливость>5 and удачливость<=6.5 then p Кража удалась, но вас заметили! & proc checkstealgold & опытворовство=опытворовство+1 & опыт=опыт+харизма & instr locname=tavernstraidertablesallirafight & proc checklevup & btn tavernstraidertablesallirafight, Сражаться насмерть
if удачливость>6.5 and удачливость<=8.5 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>8.5 then опытворовство=опытворовство+1 & опыт=опыт+2+харизма & p Кража удалась! & proc checkstealgold & proc checklevup
proc stealup
if удачливость>6.5 and alliragold=0 then pln У Аллиры больше нет денег. & goto allirasteal
if удачливость>6.5 then btn allirastealgold, Попробовать ещё раз & btn #%locname$, Вернуться
end

:allirastealhplant
число=12
proc rnd
instr locname=allirasteal
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<9 and удачливость>3 then опытворовство=опытворовство+1 & pln Вас заметили! & instr locname=tavernstraidertablesalliradie & btn tavernstraidertablesallirafight, Сражаться насмерть
if удачливость=9 or удачливость=10 then inv+ Лечебная_трава & instr locname=tavernstraidertables & pln Кража удалась, но вас заметили! #%name$ украл траву лечения. & опытворовство=опытворовство+1 & опыт=опыт+2+харизма & instr locname=tavernstraidertablesallirafight & proc checklevup & btn tavernstraidertablesallirafight, Сражаться насмерть
if удачливость>10 and удачливость<15 or удачливость<=4 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>14 then опытворовство=опытворовство+1 & опыт=опыт+харизма & inv+ Лечебная_трава & pln Кража удалась! #%name$ украл лечебную траву. & proc checklevup
if удачливость>10 then btn allirastealhplant, Попробовать ещё раз 
if удачливость>10 then btn #%locname$, Вернуться
proc stealup
end

:allirastealmplant
число=12
proc rnd
instr locname=allirasteal
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<9 and удачливость>3 then опытворовство=опытворовство+1 & pln Вас заметили! & instr locname=tavernstraidertablesalliradie & btn tavernstraidertablesallirafight, Сражаться насмерть
if удачливость=9 or удачливость=10 then inv+ Манновая_ромашка & instr locname=tavernstraidertables & pln Кража удалась, но вас заметили! #%name$ украл манновую ромашку. & опытворовство=опытворовство+1 & опыт=опыт+2+харизма & instr locname=tavernstraidertablesallirafight & proc checklevup & btn tavernstraidertablesallirafight, Сражаться насмерть
if удачливость>10 and удачливость<15 or удачливость<=4 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>14 then опытворовство=опытворовство+1 & опыт=опыт+харизма & inv+ Манновая_ромашка & pln Кража удалась! #%name$ украл манновую ромашку. & proc checklevup
if удачливость>10 then btn allirastealmplant, Попробовать ещё раз 
if удачливость>10 then btn #%locname$, Вернуться
proc stealup
end

:allirastealbmush
число=12
proc rnd
instr locname=allirasteal
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<9 and удачливость>3 then опытворовство=опытворовство+1 & pln Вас заметили! & instr locname=tavernstraidertablesalliradie & btn tavernstraidertablesallirafight, Сражаться насмерть
if удачливость=9 or удачливость=10 then inv+ Сок_синего_гриба & instr locname=tavernstraidertables & pln Кража удалась, но вас заметили! #%name$ украл сок синего гриба. & опытворовство=опытворовство+1 & опыт=опыт+2+харизма & instr locname=tavernstraidertablesallirafight & proc checklevup & btn tavernstraidertablesallirafight, Сражаться насмерть
if удачливость>10 and удачливость<15 or удачливость<=4 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>14 then опытворовство=опытворовство+1 & опыт=опыт+харизма & inv+ Сок_синего_гриба & pln Кража удалась! #%name$ украл сок синего гриба. & proc checklevup
if удачливость>10 then btn allirastealbmush, Попробовать ещё раз 
if удачливость>10 then btn #%locname$, Вернуться
proc stealup
end

:tavernstraidertablestraytalk
proc dialogpar
if trayknow=1 then instr cname=, Трэй
if trayknow=0 then instr cname=
if traybeer=0 then pln Гном с трудом поднял голову из тарелки, взглянул приблизительно в ту сторону, где стоит #%name$, пробормотал:#/$- Не, ты уж извини, но на разговоры меня не тянет. Голова раскалывается... Пивка бы мне, в общем.
число=5
proc rnd
proc replicbye
if trayknow=1 and traybeer=1 then число=7 & proc rnd & proc replichello & pln - #%hello$, #%name$!
if trayknow=0 and traybeer=1 then число=7 & proc rnd & proc replichello & pln - #%hello$!
число=7
proc rnd
proc replichello
if traybeer=1 then btn tavernstraidertablestraytalkhello, - #%hello$#%cname$! 
if traybeer=0 and Кружка_пива then btn tavernstraidertablestraytalkgivebeer, - Держи, хорошему гному ничего не жалко
if интеллект>=0 then btn tavernstraidertables, - #%bye$#%cname$.
if интеллект<0 then btn tavernstraidertables, Шатаясь, отойти
instr cname=гнома
if интеллект<2 then instr cname=существо
if trayknow=1 then instr cname=Трэя
btn tavernstraidertablestrayfight, Атаковать #%cname$
end

:tavernstraidertablestraytalkgivebeer
traybeer=1
inv- Кружка_пива
trayknow=1
instr cname=а, хоть и рожа-то не гномья
if раса=5 then instr cname=а
pln Гном сразу как-то оживился, живенько протянул свои здоровые руки, сжал кружку с пивом так, что та чуть не треснула. Затем выпил половину содержимого, на время поставил тару на стол. Вам показалось, что он даже протрезвел.#/$- Ну, уж спасибо, браток. Считай, что спас меня. Чего хотел-то?#/$- Да так, поговорить...#/$- Я так и понял, что у тебя родная мне душ#%cname$. Ну что - будем знакомы, что ли. Меня Трэем зовут.#/$- #%name$.
btn tavernstraidertablestraytalkwhy, - Чего здесь без дела сидишь?
btn tavernstraidertablestraytalknnews, - Есть какие-нибудь слухи?
число=5
proc rnd
proc replicbye
btn tavernstraidertables, - #%bye$, Трэй
btn tavernstraidertablestrayfight, Атаковать Трэя
end

:tavernstraidertablestraytalkhello
pln - Что тебя интересует, #%name$?
btn tavernstraidertablestraytalkwhy, - Чего здесь без дела сидишь?
btn tavernstraidertablestraytalknnews, - Есть какие-нибудь слухи?
число=5
proc rnd
proc replicbye
btn tavernstraidertables, - #%bye$, Трэй
btn tavernstraidertablestrayfight, Атаковать Трэя
end

:tavernstraidertablestraytalknnews
pln -Все вокруг только и говорят о том, что скоро начнётся новая война с нежитью. Приближаются тяжёлые времена. Ещё слышал, что где-то недалеко от Иболаса был обнаружен какой-то сверхмощный артефакт. Говорят, что это - глефа. Лавамансеры совсем обнаглели и требуют, чтобы мы, Подгорное племя, отдали им здоровый кусок Южных гор, мол до Великих войн он принадлежал им. Пусть и не надеются.
btn tavernstraidertablestraytalkhello, - Ещё пара вопросов
end

:tavernstraidertablestraytalkwhy
p - А чё - я на работе. Понимаешь, задание мне дали такое: без дела сидеть, казённые деньги пропивать. Уже пропил. А если по-чесноку, то я тут с братом один проход должен стеречь. А вообще, это - военная тайна, а ты чё думал? 
if харизма>0 then pln Эх, ну ладно, ты мне пива принёс, так уж и быть, сдам родину частично. Короче недалеко отсюда, в Красных горах, есть проход. Используется он для быстрого перехода через горы в этой области. Вот только уже неделю как проход в каком-то месте завалило. Ну, послали наши небольшой отряд, чтобы разведали что там и к чему. Да вот только не вернулись они. Ни один. Вот и ждём мы тут дальнейших распоряжений.#/$- А проход-то где?#/$- А ты как дойдёшь до перекрестья тропинок в Протгорне, то иди на юго-восток.#/$- Может я смогу узнать, что там произошло?#/$- Дело твоё. Я своей шкурой рисковать не собираюсь. Скажешь братану моему, что ты от меня, чтоб он тебя пропустил. & tavernstraidertablestraytalktotor=1
btn tavernstraidertablestraytalkhello, - Ещё пара вопросов
end

:tavernstraidertableskriltalk
proc dialogpar
if krilknow=1 then instr cname=, Крил
if krilknow=0 then instr cname=
число=5
proc rnd
proc replicbye
if krilknow=1 then число=7 & proc rnd & proc replichello & pln - #%hello$, #%name$!
if krilknow=0 then число=7 & proc rnd & proc replichello & pln - #%hello$!
число=7
proc rnd
proc replichello
if интеллект>=0 then btn tavernstraidertableskriltalkhello, - #%hello$#%cname$!
if интеллект<0 then btn tavernstraidertableskriltalkstupid, - Эээ...Ммм...Дык...А?
if интеллект>=0 then btn tavernstraidertables, - #%bye$#%cname$.
if интеллект<0 then btn tavernstraidertables, Шатаясь, отойти
instr cname=человека
if интеллект<2 then instr cname=существо
if krilknow=1 then instr cname=Крила
btn tavernstraidertablesfightkril, Атаковать #%cname$
end

:tavernstraidertableskriltalkstupid
pln - Извини, приятель, но я не могу ничего понять из твоих пьяных речей. Если хочешь, я могу снять с тебя запой.
btn tavernstraidertableskriltalkstupidyes, Кивнуть
btn tavernstraidertables, Пригрозить пальцем и отойти
end

:tavernstraidertableskriltalkstupidyes
instr cname=Существо
if интеллект>1 then instr cname=Человек
if krilknow=1 then instr cname=Крил
instr cname=ёл
instr cname2=
if интеллект<2 then instr cname1=ело& instr cname2=о
pln #%cname$ несколько раз пров#%cname1$ ладонью перед вашим лицом, прошептал#%cname2$: "Скажи водке нет! Изыди!". Затем вы действительно почувствовали, как голова перестаёт кружиться, а язык заплетаться.
интеллект=интдопохмелья
восприятие=восдопохмелья
похмелье=0
btn tavernstraidertableskriltalk, Поговорить
btn tavernstraidertables, Отойти
end

:tavernstraidertableskriltalkhello
if krilknow=1 then instr cname=, #%name$ 
if krilknow=0 then instr cname=
p - Вы что-то хотели#%cname$?
btn tavernstraidertableskriltalkwho, - Кто вы?
btn tavernstraidertableskriltalkmagic, - Какие услуги вы предлагаете?
число=5
proc rnd
proc replicbye
if krilknow=1 then instr cname=, Крил
btn tavernstraidertables, - #%bye$#%cname$
if krilknow=0 then instr cname=человека
if krilknow=1 then instr cname=Крила
btn tavernstraidertablesfightkril, Атаковать #%cname$
end

:tavernstraidertableskriltalkmagic
pln - Я маг по своей специальности и могу обучить вас тем заклинаниям земли, которые сам знаю. Однако мой орден налагает на меня запрет обучать кого-либо постороннего любым заклинаниям выше второго уровня. Короче говоря, я могу обучить вас заклинаниям лишь первого и второго уровня, а дальше - обращайтесь к главе ордена. Точное местонахождение нашего ордена я не имею права называть, но если в лесу Дендрос вы его поищите, то непременно найдёте. Ах, да - за свои услуги я беру небольшую плату в фонд ордена.
btn tavernstraidertableskriltalkmagiclev1, - Обучите меня заклинанию первого уровня
btn tavernstraidertableskriltalkmagiclev2, - Обучите меня заклинанию второго уровня
btn tavernstraidertableskriltalkhello, - Ещё несколько вопросов...
end

:tavernstraidertableskriltalkmagiclev1
if magicno=1 then pln - Извини, но #%race$ не может владеть магией.#/$ & goto tavernstraidertableskriltalkmagic
magiccost=20
p - Я могу обучить вас заклинаниям "Шипастая рука", "Опутывающие ветви" и "Исцеление" всего за 
magiccost=magiccost-торговля
if magiccost<12 then magiccost=12
pln #magiccost$ Гил.
btn tavernstraidertableskriltalkmagiclev1info, Информация о заклинаниях
if inv_Гил>=magiccost then btn tavernstraidertableskriltalkmagiclev1thornhand, Купить заклинание "Шипастая рука" & btn tavernstraidertableskriltalkmagiclev1branch, Купить заклинание "Опутывающие ветви" & btn tavernstraidertableskriltalkmagiclev1aiming, Купить заклинание "Исцеление"
btn tavernstraidertableskriltalkmagic, Ещё несколько вопросов...
end

:tavernstraidertableskriltalkmagiclev1thornhand
if magicthornhand=1 then pln #%name$ уже знает это заклинание! & goto tavernstraidertableskriltalkmagiclev1
if интеллект<1 then pln #%name$ слишком глуп для этого! & goto tavernstraidertableskriltalkmagiclev1
if krilknow=0 then instr cname=Друид
if krilknow=1 then instr cname=Крил
pln #%cname$ за некоторое время обучил вас заклинанию "Шипастая рука".
minute=minute+15
sec=0
magicthornhand=1
inv- #magiccost$, Гил
if not Заклинания then inv+ Заклинания
krilgold=krilgold+magiccost
btn tavernstraidertableskriltalkmagiclev1, Продолжить разговор
btn tavernstraidertables, Закончить разговор
end

:tavernstraidertableskriltalkmagiclev1branch
if magicbranch=1 then pln #%name$ уже знает это заклинание! & goto tavernstraidertableskriltalkmagiclev1
if интеллект<1 then pln #%name$ слишком глуп для этого! & goto tavernstraidertableskriltalkmagiclev1
if krilknow=0 then instr cname=Друид
if krilknow=1 then instr cname=Крил
pln #%cname$ за некоторое время обучил вас заклинанию "Опутывающие ветви".
minute=minute+15
sec=0
magicbranch=1
if not Заклинания then inv+ Заклинания
inv- #magiccost$, Гил
krilgold=krilgold+magiccost
btn tavernstraidertableskriltalkmagiclev1, Продолжить разговор
btn tavernstraidertables, Закончить разговор
end

:tavernstraidertableskriltalkmagiclev1aiming
if magicaiming=1 then pln #%name$ уже знает это заклинание! & goto tavernstraidertableskriltalkmagiclev1 if интеллект<1 then pln #%name$ слишком глуп для этого! & goto tavernstraidertableskriltalkmagiclev1
if krilknow=0 then instr cname=Друид
if krilknow=1 then instr cname=Крил
pln #%cname$ за некоторое время обучил вас заклинанию "Исцеление".
minute=minute+15
sec=0
magicaiming=1
inv- #magiccost$, Гил
if not Заклинания then inv+ Заклинания
krilgold=krilgold+magiccost
btn tavernstraidertableskriltalkmagiclev1, Продолжить разговор
btn tavernstraidertables, Закончить разговор
end 
:tavernstraidertableskriltalkmagiclev2
if magicno=1 then pln - Извини, но #%race$ не может владеть магией.#/$ & goto tavernstraidertableskriltalkmagic
magiccost=50
p - Я могу обучить вас заклинаниям "Отравленный клинок", "Удар зверя" и "Снятие иллюзий" всего за 
magiccost=magiccost-торговля
if magiccost<25 then magiccost=25
pln #magiccost$ Гил.
btn tavernstraidertableskriltalkmagiclev2info, Информация о заклинаниях
;if inv_Гил>=magiccost and зелмагия>0 then btn tavernstraidertableskriltalkmagiclev2pblade, Купить заклинание "Отравленный клинок" & btn tavernstraidertableskriltalkmagiclev2beastkick, Купить заклинание "Удар зверя" & btn tavernstraidertableskriltalkmagiclev2noilluses, Купить заклинание "Снятие иллюзий"
btn tavernstraidertableskriltalkmagic, Ещё несколько вопросов...
end

:tavernstraidertableskriltalkmagiclev2info
instr locname=tavernstraidertableskriltalkmagiclev2info
pln Выберите заклинание.
btn infobeastkick, Информация о заклинании "Удар зверя"
btn infopblade, Информация о заклинании "Отравленный клинок"
btn infonoilluses, Информация о заклинании "Снятие иллюзий"
btn tavernstraidertableskriltalkmagiclev2, Назад
end

:tavernstraidertableskriltalkmagiclev1info
instr locname=tavernstraidertableskriltalkmagiclev1info
pln Выберите заклинание.
btn infothornhand, Информация о заклинании "Шипастая рука"
btn infobranch, Информация о заклинании "Опутывающие ветви"
btn infoaiming, Информация о заклинании "Исцеление"
btn tavernstraidertableskriltalkmagiclev1, Назад
end

:tavernstraidertableskriltalkwho
pln - Моё имя - Крил. Да, знаю, знаю - это не человеческое имя. Но друидам, в состав которых я вхожу, даются новые имена. Кто такие друиды? Друиды - это маги леса и земли. Мы владеем зелёной магией и поддерживаем союз с монахами и фирамантами. Свет - это жизнь, а в любом дереве есть жизнь. Огонь, по нашему убеждению - это не разрушение, а преобразование, преобразование всего в пепел. А пепел подобен земле. Своими заклятыми врагами мы считаем аквамантов и некромантов, ибо вода - это иллюзии, за которыми лишь обман, который мы презираем. Смерть же, несёт в себе только всеобщее уничтожение и уподобление хаосу, что для нас, хранителей жизни, неприемлемо. Я мог бы начать более тонкие дискуссии, но на это у нас нет времени. Теперь, когда я представился и рассказал о себе, позволь мне узнать твоё имя.
pln - #%name$ - произнесли вы, слегка оторопело.
pln - Ну, вот и чудно, будем знакомы.
krilknow=1
btn tavernstraidertableskriltalkhello, - Ещё несколько вопросов...
end

:tavernstraidertableskriltalkstupid
pln - Нет, нет, так дело не пойдёт! Вот когда приведёшь себя в порядок, тогда и поговорим!
btn tavernstraidertables, Шатаясь, отойти
end

:tavernstraidertablesalliratalk
proc dialogpar
if alliraknow=1 then instr cname=, Аллира
if alliraknow=0 then instr cname=
число=5
proc rnd
proc replicbye
if alliraknow=1 then число=7 & proc rnd & proc replichello & pln - #%hello$, #%name$!
if alliraknow=0 then число=7 & proc rnd & proc replichello & pln - #%hello$!
число=7
proc rnd
proc replichello
if интеллект>=0 then btn tavernstraidertablesalliratalkhello, - #%hello$#%cname$!
if интеллект<0 then btn tavernstraidertablesalliratalkstupid, - Эээ...Ммм...Дык...А?
if интеллект>=0 then btn tavernstraidertables, - #%bye$#%cname$.
if интеллект<0 then btn tavernstraidertables, Шатаясь, отойти
instr cname=полу-эльфийку
if интеллект<2 then instr cname=существо
if furgotknow=1 then instr cname=Аллиру
btn tavernstraidertablesallirafight, Атаковать #%cname$
end

:tavernstraidertablesalliratalkstupid
pln -Фи! Ну и несёт же от тебя, #%race$! Вот, понюхай.
if alliraknow=0 then p Полу-эльфийка 
if alliraknow=1 then p Аллира 
pln суёт вам под нос какой-то листик.
btn tavernstraidertablesalliratalkstupidyes, Вдохнуть
btn tavernstraidertables, Шатаясь, отойти
end

:tavernstraidertablesalliratalkstupidyes
pln #%name$ вдыхает запах листа. Сначала аромат кажется слабым и даже каким-то дурманящим. Но секундой после ваши лёгкие обдаёт нестерпимым жаром, становится невозможным дышать, а сердце начинает бешено гнать кровь по венам и артериям. Когда #%name$ приходит в себя, то ощущает, что он полностью трезв.
интеллект=интдопохмелья
восприятие=восдопохмелья
похмелье=0
btn tavernstraidertablesalliratalkhello, Поблагодарить и поздороваться
btn tavernstraidertables, Убраться подобру-поздорову
end

:tavernstraidertablesalliratalkhello
proc dialogpar
if alliraknow=0 then pln -Хмм, привет, #%race$, меня зовут Аллира. Я - специалистка по растениям. 
if alliraknow=1 then pln -Ты что-нибудь хотел спросить, #%name$?
alliraknow=1
if tavernstraidertablesalliratalkworks=0 then btn tavernstraidertablesalliratalkwork, - Что ты здесь делаешь?
if tavernstraidertablesalliratalkworks=1 then btn tavernstraidertablesalliratalkworkcheck, - Насчёт твоего задания...
btn  tavernstraidertablesalliratalkplants, - Какие растения ты продаёшь?
btn  tavernstraidertablesalliratalktrading, - Я хотел бы заняться торговлей
число=5
proc rnd
proc replicbye
btn  tavernstraidertables, -#%bye$, Аллира
btn tavernstraidertablesallirafight, Атаковать Аллиру
end

:tavernstraidertablesalliratalkwork
tavernstraidertablesalliratalkworks=1
pln - Я здесь жду одного своего коллегу. Хотя, хмм... Ладно, думаю, что ты подойдёшь. В близлежащем лесу, в Протгорне, растёт довольно редкое в Трионе растение. Называется "Гинка". Так вот, я хочу, чтобы ты пошёл в лес, нашёл это растение (она описывает, как растение выглядит) и осторожно вытащил его с корнем из земли. В общем, в корне-то всё и дело. Из него можно сделать много снадобий. В качестве благодарности я могу дать тебе несколько лечебных травок. Ну, так ты согласен? Если найдёшь - неси сюда. Правда, уже через два часа меня здесь уже не будет, так что тебе лучше поторопиться.
btn tavernstraidertablesalliratalkhello, - Ладно, я всё понял
end

:tavernstraidertablesalliratalkworkcheck
if not Корень_гинка then pln -Мы уже обо всём договорились. & goto tavernstraidertablesalliratalkhello
tavernstraidertablesalliratalkworks=2
опыт=опыт+7+харизма
instr weapname=владения топором
instr weapexp=знаниетопора
weapbonus=знаниетопора
опытзнаниетопора=опытзнаниетопора+2
if опыт>=нужныйопыт#уровень+1$ then proc checklevup
inv- Корень_гинка
inv+ 3, Лечебная_трава
p -Надо же, ты справился. Я слышала, что в этом лесу довольно много волков. 
if здоровье<максздоровье+0.9 then p Да ты ранен! давай я залечу твои раны. (Она вытаскивает какой-то мешочек, достаёт оттуда пригоршню зеленоватой пыли и присыпает ею ваши раны. Через несколько секунд кровь на ранах запекается, а боль стихает.) Ну, вот, теперь порядок! & здоровье=максздоровье+0.9
pln #/$-Как я и обещала, вот три листа лечебной травы. Если будешь ранен, просто разжуй их и прижми к ранам - они остановят кровотечение.
btn tavernstraidertablesalliratalkhello, - Благодарю, Аллира
end

:tavernstraidertablesalliratalkplants
pln - У меня довольно-таки большой ассортимент всяких порошков и снадобий из растений. К сожалению, сейчас при мне только самое необходимое, а товар на продажу остался в моей лавке. Если тебе нужно будет какое-то снадобье, то ты сможешь найти меня в Лимфиуме, там моя лавка.
btn  tavernstraidertablesalliratalkhello, - Ещё кое-что...
end

:tavernstraidertablesalliratalktrading
proc screenpar
dialog=1
hplantcost=8
mplantcost=7
bmushcost=7
pln - Сейчас у меня довольно мало товара:
p Лечебная трава за 
if торговля<7 then hplantcost=8-торговля & pln #8-торговля$ Гил
if торговля>6 then hplantcost=4 & pln 4 Гил
p Манновая ромашка за 
if торговля<6 then mplantcost=7-торговля & pln #7-торговля$ Гил
if торговля>5 then mplantcost=3 & pln 3 Гил
p Сок синего гриба (восстановитель бодрости) за 
if торговля<6 then bmushcost=7-торговля & pln #7-торговля$ Гил
if торговля>5 then bmushcost=3 & pln 3 Гил
btn tavernstraidertablesalliratalktradinghplant, Купить лечебную траву
btn tavernstraidertablesalliratalktradingmplant, Купить манновую ромашку
btn tavernstraidertablesalliratalktradingbmush, Купить сок синего гриба
if Лечебная_трава or Манновая_ромашка or Сок_синего_гриба then btn tavernstraidertablesalliratalktradingsell, Продать вещи
btn tavernstraidertablesalliratalkhello, - Мне ничего не нужно
end

:tavernstraidertablesalliratalktradingsell
hplantcost=1+торговляif hplantcost>3 then hplantcost=3
mplantcost=1
if торговля>0 then mplantcost=2
bmushcost=1
if торговля>0 then bmushcost=2
pln - Что ты хочешь продать?
if Лечебная_трава then btn tavernstraidertablesalliratalktradingsellhplant, Продать лечебную траву за #%hplantcost$ Гил
if Манновая_ромашка then btn tavernstraidertablesalliratalktradingsellmplant, Продать манновую ромашку за #%mplantcost$ Гил
if Сок_синего_гриба then btn tavernstraidertablesalliratalktradingsellbmush, Продать сок синего гриба за #%bmushcost$ Гил
if Лечебная_трава and Манновая_ромашка and Сок_синего_гриба then btn tavernstraidertablesalliratalktrading, Купить вещи
btn tavernstraidertablesalliratalkhello, - Мне ничего не нужно
end

:tavernstraidertablesalliratalktradingsellhplant
inv+ #hplantcost$, Гил
inv- Лечебная_трава
alliragold=alliragold-hplantcost
pln - Спасибо, что-нибудь ещё?
proc checktrading
goto tavernstraidertablesalliratalktradingsell

:tavernstraidertablesalliratalktradingsellmplant
inv+ #mplantcost$, Гил
inv- Манновая_ромашка
proc checktrading
alliragold=alliragold-hplantcost
pln - Спасибо, что-нибудь ещё?
goto tavernstraidertablesalliratalktradingsell 
:tavernstraidertablesalliratalktradingsellbmush
inv+ #bmushcost$, Гил
inv- Сок_синего_гриба
alliragold=alliragold-hplantcost
proc checktrading
pln - Спасибо, что-нибудь ещё?
goto tavernstraidertablesalliratalktradingsell

:tavernstraidertablesalliratalktradinghplant
if inv_Гил<hplantcost then pln - У тебя нет столько денег! & goto tavernstraidertablesalliratalktrading
inv- #hplantcost$, Гил
inv+ Лечебная_трава
proc checktrading
alliragold=alliragold+hplantcost
pln - Спасибо, #%name$.
goto tavernstraidertablesalliratalktrading

:tavernstraidertablesalliratalktradingmplant
if inv_Гил<mplantcost then pln - У тебя нет столько денег! & goto tavernstraidertablesalliratalktrading
inv- #mplantcost$, Гил
inv+ Манновая_ромашка
proc checktrading
alliragold=alliragold+hplantcost
pln - Спасибо, #%name$.
goto tavernstraidertablesalliratalktrading

:tavernstraidertablesalliratalktradingbmush
if inv_Гил<bmushcost then pln - У тебя нет столько денег! & goto tavernstraidertablesalliratalktrading
inv- #bmushcost$, Гил
inv+ Сок_синего_гриба
proc checktrading
alliragold=alliragold+hplantcostpln - Спасибо, #%name$.
goto tavernstraidertablesalliratalktrading

:tavernstraiderstairsup
if Кружка_пива then pln С кружкой пива в руках нельзя подниматься по лестнице.#/$ & goto tavernstraider
pln #%name$ поднялся по лестнице и оказался в длинном коридоре. Пройдя несколько шагов по скрипучим половицам, #%name$ увидел шесть дверей, над каждой из которых висят таблички с номерами. В конце коридора находится распахнутое окно, а прямо за вашей спиной есть лестница, ведущая вниз, в бар.
if tavernstraidersecondfloors=0 and удача>2 then pln #%name$ заметил и подобрал один Гил, который кто-то случайно обронил. Вам везёт сегодня! & inv+ Гил & tavernstraidersecondfloors=1
btn tavernstraidersecondfloorroom1, В комнату № 1
btn tavernstraidersecondfloorroom2, В комнату № 2
btn tavernstraidersecondfloorroom3, В комнату № 3
btn tavernstraidersecondfloorroom4, В комнату № 4
btn tavernstraidersecondfloorroom5, В комнату № 5
btn tavernstraidersecondfloorroom6, В комнату № 6
btn taverstraidersecondfloorwindow, Подойти к окну
btn tavernstraider, Спуститься вниз по лестнице
end

:tavernstraidersecondfloor
pln #%name$ стоит посреди длинного коридора с шестью дверьми. В оном конце коридора есть лестница, ведущая на первый этаж таверны "Заблудший странник", а в другом - широко распахнутое окно.
btn tavernstraidersecondfloorroom1, В комнату № 1
btn tavernstraidersecondfloorroom2, В комнату № 2
btn tavernstraidersecondfloorroom3, В комнату № 3
btn tavernstraidersecondfloorroom4, В комнату № 4
btn tavernstraidersecondfloorroom5, В комнату № 5
btn tavernstraidersecondfloorroom6, В комнату № 6
btn tavernstraidersecondfloorwindow, Подойти к окну
btn tavernstraider, Спуститься вниз по лестнице
end

:tavernstraidersecondfloorroom1
proc screenpar
instr locname=tavernstraidersecondfloorroom1
if tavernstraiderroom<2 and tavernstraiderrooms=0 then pln #%name$ зашёл в пустую комнату. Если все комнаты в этой таверне пустуют, то это значит, что дела идут здесь не очень хорошо.
if tavernstraiderroom>2 then pln Эта комната уже кем-то занята и не хочется его, кто бы это ни был, беспокоить.#/$ & goto tavernstraidersecondfloor
if tavernstraiderroom=2 then pln Небольшая кровать, столик, сундук и пара картин на стене - всё убранство этой комнаты. & btn bed, Лечь на кровать & btn box, Открыть сундук & btn tavernstraidersecondfloorroompic1, Осмотреть картины & btn saving, Сохранить игру
btn tavernstraidersecondfloor, Выйти из комнаты
end

:tavernstraidersecondfloorroom2
proc screenpar
instr locname=tavernstraidersecondfloorroom2
if tavernstraiderroom<=3 then pln #%name$ зашёл в пустую комнату.
if tavernstraiderroom>3 then pln Эта комната уже кем-то занята и не хочется его, кто бы это ни был, беспокоить.#/$ & goto tavernstraidersecondfloor
if tavernstraiderroom=3 and tavernstraiderrooms=1 then pln Небольшая кровать, столик, на котором ползает маленький паучок, сундук и пара картин на стене - всё убранство этой комнаты. & btn bed, Лечь на кровать & btn box, Открыть сундук & btn tavernstraidersecondfloorroompic2, Осмотреть картины & btn saving, Сохранить игру
btn tavernstraidersecondfloor, Выйти из комнаты
end

:tavernstraidersecondfloorroom3
proc screenpar
instr locname=tavernstraidersecondfloorroom3
if tavernstraiderroom<=4 then pln #%name$ зашёл в пустую комнату.
if tavernstraiderroom>4 then pln Эта комната уже кем-то занята и не хочется его, кто бы это ни был, беспокоить.#/$ & goto tavernstraidersecondfloor
if tavernstraiderroom=4 and tavernstraiderrooms=1 then pln Пыльная кровать, столик, сундук и пара картин на стене - всё убранство этой комнаты.
if tavernstraiderroom=4 and tavernstraiderrooms=1 then btn bed, Лечь на кровать & btn box, Открыть сундук & btn tavernstraidersecondfloorroompic1, Осмотреть картины & btn saving, Сохранить игру
btn tavernstraidersecondfloor, Выйти из комнаты
end

:tavernstraidersecondfloorroom4
proc screenpar
instr locname=tavernstraidersecondfloorroom4
if tavernstraiderroom<=5 then pln #%name$ зашёл в пустую комнату.
if tavernstraiderroom>5 then pln Эта комната уже кем-то занята и не хочется его, кто бы это ни был, беспокоить.#/$ & goto tavernstraidersecondfloor
if tavernstraiderroom=5 and tavernstraiderrooms=1 then pln Небольшая кровать, столик, сундук с облетевшей краской и пара картин на стене - всё убранство этой комнаты. & btn bed, Лечь на кровать & btn box, Открыть сундук & btn tavernstraidersecondfloorroompic2, Осмотреть картины & btn saving, Сохранить игру
btn tavernstraidersecondfloor, Выйти из комнаты
end

:tavernstraidersecondfloorroom5
proc screenpar
instr locname=tavernstraidersecondfloorroom5
if tavernstraiderroom<=6 then pln #%name$ зашёл в пустую комнату.
if tavernstraiderroom>6 then pln Эта комната уже кем-то занята и не хочется его, кто бы это ни был, беспокоить.#/$ & goto tavernstraidersecondfloor
if tavernstraiderroom=6 and tavernstraiderrooms=1 then pln Пыльная кровать, столик, сундук и пара картин на стене - всё убранство этой скучной комнатушки. & btn bed, Лечь на кровать & btn box, Открыть сундук & btn tavernstraidersecondfloorroompic1, Осмотреть картины & btn saving, Сохранить игру
btn tavernstraidersecondfloor, Выйти из комнаты
end

:tavernstraidersecondfloorroom6
proc screenparinstr locname=tavernstraidersecondfloorroom6
if tavernstraiderroom<=7 then pln #%name$ зашёл в пустую комнату.
if tavernstraiderroom>7 then pln Эта комната уже кем-то занята и не хочется его, кто бы это ни был, беспокоить.#/$ & goto tavernstraidersecondfloor
if tavernstraiderroom=7 and tavernstraiderrooms=1 then pln Небольшая кровать, столик, сундук с облетевшей краской и пара картин на стене - всё убранство этой комнаты. & btn bed, Лечь на кровать & btn box, Открыть сундук & btn tavernstraidersecondfloorroompic2, Осмотреть картины & btn saving, Сохранить игру
btn tavernstraidersecondfloor, Выйти из комнаты
end

:tavernstraidersecondfloorroompic1
pln На картине изображена мельница в поле. Судя по окружающим её деревьям, пора года - осень. Всё небо тёмно-синего цвета, гроза. Прямо перед нами сверкает молния. Это - одна из самых распространённых картин на севере.
btn #%locname$, Отойти от картины
end
:tavernstraidersecondfloorroompic2
pln На картине изображён старый кобольд, сидящий на холме. Дует сильный ветер и идёт слабый снежок. Однако кобольд, бородка которого уже вся седая, похоже, не замечает этого. Он, как часто делают старцы всех рас, о чём-то глубоко задумался...
btn #%locname$, Отойти от картины
end

:box
pln #%name$ открыл сундук для хранения.

:boxopen
сундукхранения=1
p В сундуке 
if boxs=0 then p ничего не лежит.
if boxs>0 then pln лежит:
if boxтопордровосекаaxes>0 then pln #boxтопордровосекаaxes$ шт. Топоров дровосека & btn boxtakeтопордровосека, Взять топор дровосека
if boxмалыйтопорaxes>0 then pln #boxмалыйтопорaxes$ шт. Малых топоров & btn boxtakeмалыйтопор, Взять малый топор
if boxдвуручныйтопорaxes>0 then pln #boxдвуручныйтопорaxes$ шт. Двуручных топоров & btn boxtakeдвуручныйтопор, Взять двуручный топор
if boxпосохдруидаwands>0 then pln #boxпосохдруидаwands$ шт. Посохов друида & btn boxtakeпосохдруида, Взять посох друида
if boxпосохманыwands>0 then pln #boxпосохманыwands$ шт. Посохов маны & btn boxtakeпосохманы, Взять посох маны
if boxплащs>0 then pln #boxплащrobes$ шт. Плащей & btn boxtakeплащ, Взять плащ
if boxсандалииsandaless>0 then pln #boxсандалииsandaless$ шт. Сандалий & btn boxtakeсандалии, Взять сандалии
if boxгилs>0 then pln #boxгилs$ Гил & btn boxtakeгил, Взять деньги
if boxлечебнаятраваs>0 then pln #boxлечебнаятраваs$ шт. Лечебной травы & btn boxtakeлечебнаятрава, Взять лечебную траву
if boxманноваяромашкаs>0 then pln #boxманноваяромашкаs$ шт. Манновой ромашки & btn boxtakeманноваяромашка, Взять манновую ромашку
if boxсоксинегогрибаs>0 then pln #boxсоксинегогрибаs$ шт. Пакетиков с соком синего гриба & btn boxtakeсоксинегогриба, Взять сок синего гриба
if boxдневникркs>0 then pln Дневник Рилла Криома & btn boxtakeдневникрк, Взять дневник Рилла Криома
if boxrkrings>0 then pln Кольцо Рилла Криома & btn boxtakerkring, Взять кольцо Рилла Криома
if boxкольцолеченияs>0 then pln #boxкольцолеченияs$ шт. Колец лечения & btn boxtakeкольцолечения, Взять кольцо лечения
if boxкоробокспичекs>0 then pln #boxкоробокспичекs$ шт. Коробков спичек & btn boxtakeкоробокспичек, Взять коробок спичек
if boxкусокпанциряs>0 then pln #boxкусокпанциряs$ шт. Кусков костяного панциря & btn boxtakeкусокпанциря, Взять кусок костяного панциря
btn #%locname$, Закрыть сундук
end

:boxdropсандалии
cls
if boxсандалииs=0 then boxs=boxs+1
inv- Сандалии
boxсандалииs=boxсандалииs+1
goto boxopen
end

:boxtakeсандалии
cls
instr cname=boxсандалии
proc takesandales
if boxсандалииsandaless=0 then boxs=boxs-1
goto boxopen
end

:boxdropплащ
cls
if boxплащs=0 then boxs=boxs+1
inv- Плащ
boxплащs=boxплащs+1
goto boxopen
end

:boxtakeплащ
cls
instr cname=boxплащ
proc takerobe
if boxплащrobes=0 then boxs=boxs-1
goto boxopen
end

:boxdropпосохманы
cls
if boxпосохманыs=0 then boxs=boxs+1
inv- Посох_маны
весоружия=весоружия-2
boxпосохманыs=boxпосохманыs+1
goto boxopen
end

:boxtakeпосохманы
cls
instr cname=boxпосохманы
proc takewand(i)
if boxпосохманыwands=0 then boxs=boxs-1
goto boxopen
end

:boxdropпосохдруида
cls
if boxпосохдруидаs=0 then boxs=boxs+1
inv- Посох_друида
весоружия=весоружия-2
boxпосохдруидаs=boxпосохдруидаs+1
goto boxopen
end

:boxtakeпосохдруида
cls
instr cname=boxпосохдруида
proc takewand
if boxпосохдруидаwands=0 then boxs=boxs-1
goto boxopen
end

:boxdropкоробокспичек
cls
boxmatchess=boxmatchess+((inv_Коробок_спичек-1)*50+matches)
matches=matches-((inv_Коробок_спичек-1)*50+matches)
inv- Коробок_спичек
if boxкоробокспичекs=0 then boxs=boxs+1
boxкоробокспичекs=boxкоробокспичекs+1
goto boxopen
end

:boxtakeкоробокспичек
cls
if boxmatchess<51 and inv_Коробок_спичек*50+boxmatchess>(inv_Коробок_спичек+1)*50 or inv_Коробок_спичек=0 then matches=matches+boxmatchess & boxmatchess=0 & inv+ Коробок_спичек
if boxmatchess>50 then matches=matches+50 & boxmatchess=boxmatchess-50 & inv+ Коробок_спичек
boxкоробокспичекs=boxкоробокспичекs-1
if boxкоробокспичекs=0 then boxs=boxs-1
p #%name$ достал из сундука коробок спичек и положил его себе в карман.
goto boxopen
end

:boxdropдневникрк
cls
inv- Дневник_Рилла_Криома
if boxдневникркs=0 then boxs=boxs+1
boxдневникркs=boxдневникркs+1
goto boxopen
end

:boxtakeдневникрк
cls
inv+ Дневник_Рилла_Криома
boxдневникркs=boxдневникркs-1
if boxдневникркs=0 then boxs=boxs-1
p #%name$ достал из сундука дневник Рилла Криома и 
if мешок=0 then pln положил его себе в мешок.
if мешок=1 then pln положил его себе в карман.
goto boxopen
end

:boxdropкусокпанциря
cls
inv- Кусок_костяного_панциря
if boxкусокпанциряs=0 then boxs=boxs+1
boxкусокпанциряs=boxкусокпанциряs+1
goto boxopen
end

:boxtakeкусокпанциря
cls
inv+ Кусок_костяного_панциря
boxкусокпанциряs=boxкусокпанциряs-1
if boxкусокпанциряs=0 then boxs=boxs-1
pln #%name$ достал из сундука кусок костяного панциря.
goto boxopen
end

:boxdroprkring
cls
inv- Кольцо_Рилла_Криома
if boxrkrings=0 then boxs=boxs+1
boxrkrings=boxrkrings+1
goto boxopen
end

:boxtakerkring
cls
inv+ Кольцо_Рилла_Криома
boxrkrings=boxrkrings-1
if boxrkrings=0 then boxs=boxs-1
p #%name$ достал из сундука кольцо Рилла Криома и 
if мешок=0 then pln положил его себе в мешок.
if мешок=1 then pln положил его себе в карман.
goto boxopen
end

:boxdropкольцолечения
cls
inv- Кольцо_лечения
if boxкольцолеченияs=0 then boxs=boxs+1
boxкольцолеченияs=boxкольцолеченияs+1
goto boxopen
end

:boxtakeкольцолечения
cls
inv+ Кольцо_лечения
boxкольцолеченияs=boxкольцолеченияs-1
if boxкольцолеченияs=0 then boxs=boxs-1
p #%name$ достал из сундука кольцо лечения и 
if мешок=0 then pln положил его себе в мешок.
if мешок=1 then pln положил его себе в карман.
goto boxopen
end

:boxtakeгил
cls
clrscr=1
pln Сколько взять Гил?
if boxгилs>0 then btn boxtake1гил, Взять один Гил
if boxгилs>9 then btn boxtake10гил, Взять десять Гил
if boxгилs>99 then btn boxtake100гил, Взять сто Гил
btn boxopen, Ничего не брать
end

:boxtake1гил
inv+ Гил
boxгилs=boxгилs-1
if boxгилs=0 then boxs=boxs-1
goto boxtakeгил
end

:boxtake10гил
inv+ 10,Гил
boxгилs=boxгилs-10
if boxгилs=0 then boxs=boxs-1
goto boxtakeгил
end

:boxtake100гил
inv+ 100,Гил
boxгилs=boxгилs-100
if boxгилs=0 then boxs=boxs-1
goto boxtakeгил
end

:boxdropгил
cls
clrscr=1
pln Сколько положить Гил?
btn boxdrop1гил, Положить один Гил
btn boxdrop10гил, Положить десять Гил
btn boxdrop100гил, Положить сто Гил
btn boxopen, Ничего не вложить
end

:boxdrop1гил
if not Гил then pln У вас нет никаких денег! & goto boxopen
inv- Гил
if boxгилs=0 then boxs=boxs+1
boxгилs=boxгилs+1
goto boxdropгил
end

:boxdrop10гил
if not 10 Гил then pln У вас нет десяти Гил! & goto boxopen
inv- 10,Гил
if boxгилs=0 then boxs=boxs+1
boxгилs=boxгилs+10
goto boxdropгил
end

:boxdrop100гил
if not 100 Гил then pln У вас нет ста Гил! & goto boxopen
inv- 100,Гил
if boxгилs=0 then boxs=boxs+1
boxгилs=boxгилs+100
goto boxdropгил
end

:boxdropмалыйтопор
cls
if boxмалыйтопорs=0 then boxs=boxs+1
inv- Малый_топор
if мешок=0 and колоружия=1 then колоружия=0 & весоружия=0
if мешок=0 and колоружия=2 then колоружия=1 & весоружия=весоружия-4
if мешок=1 then весоружия=весоружия-3
boxмалыйтопорs=boxмалыйтопорs+1
goto boxopen
end

:boxtakeмалыйтопор
cls
instr cname=boxмалыйтопор
proc takeaxe1
if boxмалыйтопорaxes=0 then boxs=boxs-1
goto boxopen
end

:boxtakeтопордровосека
cls
inv+ Топор_дровосека
instr cname=boxтопордровосека
proc takeaxe
if boxтопордровосекаaxes=0 then boxs=boxs-1
goto boxopen
end

:boxdropлечебнаятрава
cls
inv- Лечебная_трава
if boxлечебнаятраваs=0 then boxs=boxs+1
boxлечебнаятраваs=boxлечебнаятраваs+1
goto boxopen
end

:boxtakeлечебнаятрава
cls
inv+ Лечебная_трава
boxлечебнаятраваs=boxлечебнаятраваs-1
if boxлечебнаятраваs=0 then boxs=boxs-1
p #%name$ достал из сундука лист лечебной травы и 
if мешок=0 then pln положил его себе в мешок.
if мешок=1 then pln положил его себе в карман.
goto boxopen
end

:boxdropманноваяромашка
cls
inv- Манновая_ромашка
if boxманноваяромашкаs=0 then boxs=boxs+1
boxманноваяромашкаs=boxманноваяромашкаs+1
goto boxopen
end

:boxtakeманноваяромашка
cls
inv+ Манновая_ромашка
boxманноваяромашкаs=boxманноваяромашкаs-1
if boxманноваяромашкаs=0 then boxs=boxs-1
p #%name$ достал из сундука лепестки манновой ромашки и 
if мешок=0 then pln положил их себе в мешок.
if мешок=1 then pln положил их себе в карман.
goto boxopen
end

:boxdropсоксинегогриба
cls
inv- Сок_синего_гриба
if boxсоксинегогрибаs=0 then boxs=boxs+1
boxсоксинегогрибаs=boxсоксинегогрибаs+1
goto boxopen
end

:boxtakeсоксинегогриба
cls
inv+ Сок_синего_гриба
boxсоксинегогрибаs=boxсоксинегогрибаs-1
if boxсоксинегогрибаs=0 then boxs=boxs-1
p #%name$ достал из сундука пакетик с соком синего гриба и 
if мешок=0 then pln положил его себе в мешок.
if мешок=1 then pln положил его себе в карман.
goto boxopen
end

:saving
save saving2
pln ***Скопируйте следующие строчки в сохранение игры - в файл .qsv (можно открыть его любым текстовым редактором):
pln #%ins$ name=#%name$
pln #%ins$ race=#%race$
pln #%ins$ месяц=#%месяц$
pln #%ins$ день=#%день$
pln #%ins$ locname=#%locname$
pln #%ins$ weapexp=a
pln #%ins$ imagearmor=#%imagearmor$
pln #%ins$ imageshoes=#%imageshoes$
pln #%ins$ imagecap=#%imagecap$
pln Эти неудобства присутствуют в URQ 1.4. Возможно, в более новых версиях ничего копировать будет не нужно.
btn #%locname$, Вернуться в игру
end

:saving2
proc screenpar
proc replichello
proc replicbye
goto #%locname$
end

:tavernstraidersecondfloorwindow
p #%name$ подошёл к широко распахнутому окну и вдохнул свежий 
if hour<10 then p утренний
if hour>18 then p ночной
p  воздух. Перед вашим взором открываются 
if month=6 or month=10 or month=11 then p уже пожнённые пшеничные поля.
if month=12 or month<4 then p покрытые толстым слоем снега поля.
if month=4 or month=5 or month>6 and month<10 then p ещё не пожнённые, богатые золотистой пшеницей поля.
if hour>5 or hour<=18 then pln Далеко-далеко, на самом горизонте видна какая-то деревня.
if hour<6 or hour>18 then pln Темнота окутывает всё на расстоянии двадцати метров от вас, но, всё же, где-то на юге видны какие-то огни - видимо там есть деревня.
btn forestprotntjumping, Прыгнуть через окно
btn tavernstraidersecondfloor, Отойти от окна
end

:forestprotntjumping
if Кружка_пива then pln С кружкой пива в руках вы не можете выходить из таверны.#/$& goto tavernstraidersecondfloorwindow
число=5
proc rnd
повреждение=рнд+ловкость
if повреждение<7 then pln Прыгая с довольно-таки высокого окна, #%name$ случайно подвернул ногу. & здоровье=здоровье-1
if здоровье<1.9 then goto gameover
if здоровье>1.8 thenpln #%name$ очутился как раз перед входом в таверну.#/$
goto forestprotnt
end

:tavernstraiderbar
if hour<6 and valmesdie=0 or hour=24 and valmesdie=0 then tavernstraiderbarvalmess=0
proc screenpar
instr locname=tavernstraiderbar
instr stealloc=tavernstraiderbarsteal
if tavernstraideralert=1 and tavernstraidertablesalliras=1 and alliradie=0 and tavernstraiderbarvalmess=1 and valmesdie=1 and tavernstraidertableskrils=1 and krildie=1 and tavernstraidertablestrays=1 and traydie=1 then pln Полу-эльфийка благоразумно решила выбежать из таверны, увидев, как #%name$ убил всех кроме неё. Через несколько секунд в таверну вбежал полу-орк и бросился в атаку.#/$ & tavernstraidertablesallirarun=1 & tavernstraideraroundfurgots=0 & tavernstraidertablesfurgots=1 & goto tavernstraidertablesfurgotfight
if tavernstraiderbarvalmess=1 and valmesdie=1 and tavernstraidertableskrils=1 and krildie=1 then tavernstraideralert=0 & dangerplace=0
if tavernstraidertableskrils=1 and krildie=1 and tavernstraideralert=1 or tavernstraidertablesalliras=1 and alliradie=1 and tavernstraideralert=1 or tavernstraiderbarvalmess=1 and valmesdie=1 and tavernstraideralert=1 then if alliradie=0 and tavernstraidertablesalliras=1 or krildie=0 and tavernstraidertableskrils=1 then pln То, что вы совершили, явно не понравилось другим посетителям таверны. & goto tavernstraiderenemy
p Вы подошли к барной стойке. 
instr cname=и 
if интеллект>1 then instr cname=и сатир 
if valmesdie=0 and tavernstraiderbarvalmess=1 then p За нею стоит и протирает и без того чистые пивные кружк#%cname$ & steals=1
if valmesknow=1 and valmesdie=0 then p Валмес & btn tavernstraiderbarvalmestalk, Поговорить с Валмесом
if valmesdie=0 then p  - хозяин таверны.
if valmesknow=0 and valmesdie=0 and tavernstraiderbarvalmess=1 then btn tavernstraiderbarvalmestalk, Поговорить с хозяином таверны
if интеллект<2 then instr cname=ое существо 
if интеллект>1 or valmesknow=0 then instr cname=ый сатир 
if valmesknow=1 then instr cname=ый 
if valmesdie=1 then p Прямо под ней на полу лежит мёртв#%cname$
if valmesknow=1 and valmesdie=1 then p Валмес
if valmesdie=1 then p - хозяин таверны. & btn tavernstraiderbarvalmesdie, Взять вещи мертвеца
if tavernstraiderbarvalmess=0 or tavernstraidertableskrils=0 and tavernstraidertablestrays=0 and tavernstraidertablesalliras=0 and valmesdie=1 then pln Сейчас здесь никого нет. Можно зайти в дверь за барной стойкой. & btn tavernstraiderbarroom, Зайти в дверь за барной стойкой
btn tavernstraider, Отойти от барной стойки
end

:tavernstraiderbarroom
if tavernstraiderbarrommalert=1 and valmesdie=0 then pln Звуки сражения разбудили спящего сатира, и он атаковал вас. & goto tavernstraiderbarroomvalmesfight
if tavernstraiderbarrommalert=1 and furgotdie=0 then pln Звуки сражения разбудили спящего полу-орка, и он, с боевым кличем, атаковал вас. & goto tavernstraiderbarroomfurgotfight
p #%name$ стоит в небольшом винном погребе, по совместительству спальне
if valmesdie=0 then p . Здесь 
if valmesdie=0 and furgotdie=0 then p спят 
if valmesdie=0 and furgotdie=1 then p спит 
p сатир 
instr cname=сатиру
if valmesknow=1 then p Валмес & instr cname=Валмесу
btn tavernstraiderbarroomvalmes, Подкрасться к #%cname$
instr cname=полу-орку
if furdotdie=0 then p и полу-орк 
if furdotdie=0 and furgotknow=1 then p Фургот & instr cname=Фурготу
p . Рядом стоят две огромные, 
if размер<3 then p намного большие, чем #%name$ по высоте, 
if размер=3 then p лишь немного ниже, чем #%name$ по высоте,
p бочки с пивом.
btn tavernstraiderbarroomfurgot, Подкрасться к #%cname$
btn tavernstraiderbarroombeer, Выпить пива из бочек
btn tavernstraiderbar, Выйти из погреба
end

:tavernstraiderbarroomvalmesdie
p #%name$ обыскал убитого им сатира 
if valmesgold=0 then pln и ничего не нашёл.
if valmesgold>0 then pln и нашёл #valmesgold$ Гил. & inv+ #valmesgold$, Гил & valmesgold=0
if tavernstraiderbarroomvalmesdiemeats=0 and зеленокожий=1 then btn tavernstraiderbarroomvalmesdiemeat, Забрать мясо
btn tavernstraiderbarroom, Отойти от трупа
end

:tavernstraiderbarroomvalmesdiemeat
tavernstraiderbarroomvalmesdiemeats=1
pln #%name$ разделал тушу врага и забрал и его мясо.
inv+ Сырое_мясо
весинв=весинв+1
freshmeat=#inv_Сырое_мясо$
goto tavernstraiderbarroomvalmesdie
end

:tavernstraiderbarroomfurgotdie
p У полу-орка 
if furgotaxes=1 then pln в руке зажат топорик. & btn tavernstraiderbarroomfurgotdieaxe, Взять топорик
if furgotaxes=0 then pln ничего нет.
if furgotmeat=1 and зеленокожий=1 then btn tavernstraiderbarroomfurgotdiemeat, Забрать мясо
btn tavernstraiderbarroom, Отойти от трупа
end

:tavernstraiderbarroomfurgotdieaxe
instr cname=furgot
proc takeaxe
goto tavernstraiderbarroomfurgotdie
end

:tavernstraiderbarroomfurgotdiemeat
pln #%name$ забрал ещё свежее мясо мёртвого полу-орка
inv+ Сырое_мясо
весинв=весинв+1
if годностьмяса<1 then годностьмяса=6
freshmeat=#inv_Сырое_мясо$
furgotmeat=0
goto tavernstraiderbarroomfurgotdie
end

:tavernstraiderbarroombeer
pln #%name$ открутил вентиль на кране в бочке пива и сделал несколько больших глотков. Алкоголь резко ударил в голову. & бодрость=бодрость+1.5 & похмелье=похмелье+50 & интдопохмелья=интеллект & восдопохмелья=восприятие & восприятие=восприятие-1 & интеллект=интеллект-1
btn tavernstraiderbarroombeer, Пить ещё
btn tavernstraiderbarroom, Отойти
end

:tavernstraiderbarroomvalmes
if valmesknow=0 then instr cname=сатир
if valmesknow=1 then instr cname=Валмес
if ловкость<3 then pln Вы двигались слишком шумно и #%cname$ проснулся. Увидев вас, он напал. & btn tavernstraiderbarroomvalmesfight, Сражаться
if ловкость>2 and valmesgold>0 then pln Вы тихо подкрались и встали над спящим сатиром. Рядом с ним лежит увесистый мешок с деньгами. & btn tavernstraiderbarroomvalmesgold, Взять деньги & btn tavernstraiderbarroom, Отойти
if ловкость>2 and valmesgold=0 then pln Вы тихо подкрались и встали над спящим сатиром. При нём ничего нет. & btn tavernstraiderbarroom, Отойти
end

:tavernstraiderbarroomvalmesgold
p #%name$ забрал все деньги спящего 
if valmesknow=0 then pln сатира.
if valmesknow=1 then pln Валмеса.
inv+ #valmesgold$, Гил
valmesgold=0
btn tavernstraiderbarroom, Отойти
end

:tavernstraiderbarroomfurgot
if furgotknow=0 then instr cname=полу-орк
if furgotknow=1 then instr cname=Фургот
if ловкость<4 then pln Вы двигались слишком шумно и #%cname$ проснулся. Увидев вас, он напал. & btn tavernstraiderbarroomfurgotfight, Сражаться
if ловкость>3 and furgotaxes=1 then pln Вы тихо подкрались и встали над спящим полу-орком. Рядом с ним лежит простой деревянный топор. & btn tavernstraiderbarroomfurgotaxe, Взять топор & btn tavernstraiderbarroom, Отойти
if ловкость>3 and furgotaxes=0 then pln Вы тихо подкрались и встали над спящим полу-орком. При нём ничего нет. & btn tavernstraiderbarroom, Отойти
end

:tavernstraiderbarroomfurgotaxe
instr cname=furgot
proc takeaxe
btn tavernstraiderbarroom, Отойти
end

:tavernstraiderbarsteal
cls
proc screenpar
pln Выберите свою жертву.
if tavernstraiderbarvalmess=1 and valmesknow=0 then btn valmessteal, Хозяин таверны
if tavernstraiderbarvalmess=1 and valmesknow=1 then btn valmessteal, Валмес
btn #%locname$, Вернуться
end

:valmessteal
instr style_formpicture=heroimages/noarmor/noshoes/nocap/1.bmp
if valmesknow=1 then p У Валмеса 
if valmesknow=0 then p У хозяина таверны 
if valmesgold<1 then pln ничего нет.
if valmesgold>0 then pln есть #valmesgold$ Гил. & btn valmesstealgold, Воровать деньги
btn #%locname$, Вернуться
end

:valmesstealgold
число=7
proc rnd
instr cname=valmes
удачливость=рнд+удача/3+воровство+ловкость/3
if удачливость<=5 then опытворовство=опытворовство+1 & pln Вас заметили! & btn tavernstraiderbarvalmesfight, Сражаться насмерть
if удачливость>5 and удачливость<=6.5 then p Кража удалась, но вас заметили! & proc checkstealgold & опытворовство=опытворовство+1 & опыт=опыт+харизма & instr locname=tavernstraiderbarvalmesfight & proc checklevup & btn tavernstraiderbarvalmesfight, Сражаться насмерть
if удачливость>6.5 and удачливость<=8.5 then опытворовство=опытворовство+1 & pln Кража не удалась, но вас, похоже, не заметили.
if удачливость>8.5 then опытворовство=опытворовство+1 & опыт=опыт+2+харизма & p Кража удалась! & proc checkstealgold & proc checklevup
proc stealup
if удачливость>6.5 and valmesgold=0 then pln У Валмеса больше нет денег. & goto tavernstraiderbar
if удачливость>6.5 then btn valmesstealgold, Попробовать ещё раз & btn #%locname$, Вернуться
end

:tavernstraiderbarvalmesdie
p #%name$ обыскал убитого им сатира
if valmesgold=0 then pln и ничего не нашёл.
if valmesgold>0 then pln и нашёл #valmesgold$ Гил. & inv+ #valmesgold$, Гил & valmesgold=0
if tavernstraiderbarvalmesdiemeats=0 and зеленокожий=1 then btn tavernstraiderbarvalmesdiemeat, Забрать мясо
btn tavernstraiderbar, Отойти от трупа
end

:tavernstraiderbarvalmesdiemeat
pln #%name$ разделал тушу врага и забрал и его мясо.
inv+ Сырое_мясо
весинв=весинв+1
freshmeat=#inv_Сырое_мясо$
goto tavernstraiderbarvalmesdie
end

:tavernstraiderbarvalmestalk
if Кружка_пива then pln С кружкой пива в руках нельзя разговаривать!#/$#/$ & goto tavernstraiderbar
proc dialogpar
if valmesknow=1 then instr cname=, Валмес
if valmesknow=0 then instr cname=
число=5
proc rnd
рнд=5
proc replicbye
if valmesknow=1 then число=7 & proc rnd & proc replichello & pln - #%hello$, #%name$!
if valmesknow=0 then число=7 & proc rnd & proc replichello & pln - #%hello$!
число=7
proc rnd
proc replichello
if интеллект>=0 then btn tavernstraiderbarvalmestalkhello, - #%hello$#%cname$!
if интеллект<0 then btn tavernstraiderbarvalmestalkstupid, - Эээ... Ммм... Дык... А?; MDK !
if интеллект>=0 then btn tavernstraiderbar, - #%bye$#%cname$.
if интеллект<0 then btn tavernstraiderbar, Шатаясь, отойти
instr cname=сатира
if интеллект<2 then instr cname=существо
if valmesknow=1 then instr cname=Валмеса
btn tavernstraiderbarvalmesfight, Атаковать #%cname$
end

:tavernstraiderbarvalmestalkstupid
pln - Нет, пить тебе больше нельзя. Может тебе комната нужна? Сейчас тебе, наверное, вздремнуть не мешало бы...
if 4 Гил then btn tavernstraiderbarvalmestalkroombuy, - О
btn tavernstraiderbar, Шатаясь, отойти
end

:tavernstraiderbarvalmestalkhello
if valmesknow=0 then pln - Я - Валмес, хозяин этой таверны. #/$- Моё имя - #%name$. & valmesknow=1
число=2
proc rnd
if рнд<1.1 then pln - В этой таверне вы можете вкусно поесть, выпить и провести ночь в тёплой постели, а не на холодной траве. Также вы можете пообщаться здесь и узнать последние новости - в этой таверне бывают представители почти всех народов Триона. Извините, но из спиртного есть только пиво.
if рнд>=2 then pln - Здесь вы можете отдохнуть от дороги, перекусить и выпить. Присоединившись к какой-нибудь компании, вы можете узнать последние новости и слухи. Наконец, когда ноги уже не будут держать вас, вы можете переночевать в этой таверне.
btn tavernstraiderbarvalmestalkbeer, - Кружку пива, Валмес.
btn tavernstraiderbarvalmestalkmeat, - Съестного, да побольше!
btn tavernstraiderbarvalmestalkroom, - Я хочу взять комнату на день.
if ter=3 and valmesmustmoney=0 then btn tavernstraiderbarvalmestalkmoney, - Я к тебе по личному делу.
if ter=3 and valmesmustmoney=1 and furgottalkvalmes=1 then btn tavernstraiderbarvalmestalkfurgot, - Фургот работает на тебя, да?
число=5
proc rnd
proc replicbye
btn tavernstraiderbar, - #%bye$, Валмес.
btn tavernstraiderbarvalmesfight, Атаковать Валмеса
end

:tavernstraiderbarvalmestalkfurgot
pln - Да, он - славный малый. Я его ещё с пелёнок знаю. Работящий, добрый по своей натуре. Правда, в последнее время в нём ни с того, ни с сего, проснулся боевой дух его предков. Что-то в нём изменилось... Боюсь, что однажды проснусь и не увижу его на привычном месте.
btn tavernstraiderbarvalmestalkbeer, - Кружку пива, Валмес.
btn tavernstraiderbarvalmestalkmeat, - Съестного, да побольше 
btn tavernstraiderbarvalmestalkroom, - Я хочу взять комнату на день.
if ter=3 and valmesmustmoney=0 then btn tavernstraiderbarvalmestalkmoney, - Я к тебе по личному делу.
if ter=3 and valmesmustmoney=1 and furgottalkvalmes=1 then btn tavernstraiderbarvalmestalkfurgot, - Фургот работает на тебя, да?
число=5
proc rnd
proc replicbye
btn tavernstraiderbar, - #%bye$, Валмес.
btn tavernstraiderbarvalmesfight, Атаковать Валмеса
end

:tavernstraiderbarvalmestalkmoney
pln - Я тебя внимательно слушаю, #%name$.
pln - Валмес, мне надоело всё это однообразие и... эээ... в общем я хочу начать новую жизнь, а какую - мне и самому пока неизвестно...
p - Да, прав был твой отец. Он знал, что ты не усидишь на месте. Ну, что же, отговаривать тебя я не стану - ежу понятно, что это бесполезно. Но твой отец оставил мне кое-какие деньги как раз на такой случай. 40 Гил - не очень большая сумма, но это всё, что твой отец сумел скопить к старости.
if valmesgold<40 and valmesgold>0 then p Сейчас, правда, дела идут не слишком хорошо и даже таких денег у меня нет. #valmesgold$ Гил - это всё, что у меня есть. Если деньги нужны тебе срочно, то можешь забрать их прямо сейчас. А можешь прийти через неделю - тогда у меня, скорее всего, будет вся сумма.
if valmesgold<1 then p Да, #%name$, дела у меня идут очень плохо - у меня нет ни одного Гила... Но я уверен, что через пару недель у меня будут кой-какие деньги. & btn tavernstraiderbarvalmestalkhello, - Хорошо, вернёмся к этому позже
if valmesgold>0 then btn tavernstraiderbarvalmestalktakemoney, - Да, я заберу свои деньги & btn tavernstraiderbarvalmestalkhello, - Пусть пока полежат у тебя
end

:tavernstraiderbarvalmestalktakemoney
valmesgold=valmesgold-40
inv+ 40, Гил
valmesmustmoney=1
pln - Держи, сынок. И удачи тебе в твоих приключениях!
btn tavernstraiderbarvalmestalkhello, Продолжить разговор
btn tavernstraiderbar, Закончить разговор
end

:tavernstraiderbarvalmestalktakesomemoney
valmesgold=valmesgold-40
inv+ 40, Гил
valmesmustmoney=1
pln - Держи, сынок. И удачи тебе в твоих приключениях!
btn tavernstraiderbarvalmestalkhello, Продолжить разговор
btn tavernstraiderbar, Закончить разговор
end

:tavernstraiderbarvalmestalkroom
if tavernstraiderrooms=1 then pln - Парень, ты чего? Ты ж уже снял комнату! & btn tavernstraiderbarvalmestalkhello, - Ах, да, я забыл.
if 4 Гил and tavernstraiderrooms=0 then btn tavernstraiderbarvalmestalkroombuy, - Держи деньги, а я пойду вздремну.
if tavernstraiderrooms=0 then pln - Уютная комната на день стоит четыре гил. & btn tavernstraiderbarvalmestalkhello, - Нет, комната мне не нужна
end

:tavernstraiderbarvalmestalkroombuy
if tavernstraiderroom=7 and интеллект>=0 then pln - Извини, #%name$, но все комнаты заняты.#/$ #/$ & goto tavernstraiderbarvalmestalkhello
if tavernstraiderroom=7 and интеллект<0 then pln - Извини, #%name$, но все комнаты заняты.#/$ #/$ & goto tavernstraiderbar
inv- 4,Гил
valmesgold=valmesgold+4
p - Отлично, #%name$! Комната № 
if tavernstraiderroom>1 then p #tavernstraiderroom-1$ 
if tavernstraiderroom=1 then p 1 & tavernstraiderroom=2
p сейчас свободна. Она в вашем распоряжении ровно на день. Через двадцать четыре часа вам нужно будет снова заплатить за день вперёд или покинуть комнату.
tavernstraiderrooms=1
tavernstraiderroomday=day+1
tavernstraiderroomhour=hour
tavernstraiderroommonth=month
tavernstraiderroomyear=year
if day=31 and месяцдни=31 then tavernstraiderroommonth=month+1 & tavernstraiderroomday=1
if day=31 and common=176412 then tavernstraiderroommonth=1 & tavernstraiderroomday=1 & tavernstraiderroomyear=tavernstraiderroomyear+1
if day=30 and месяцдни=30 then tavernstraiderroommonth=month+1 & tavernstraiderroomday=1
if похмелье=0 then btn tavernstraiderbarvalmestalkhello, Продолжить разговор
btn tavernstraiderbar, Закончить разговор
end

:tavernstraiderbarvalmestalkmeat
pln - Наше фирменное жаркое стоит два гил. Рекомендую!
if 2 Гил then btn tavernstraiderbarvalmestalkmeatbuy, - Мне одну порцию.
btn tavernstraiderbarvalmestalkhello, - Как-нибудь в другой раз.
end

:tavernstraiderbarvalmestalkmeatbuy
if выносливость-0.9>максвыносливость then pln #%name$ сыт и совершенно не хочет есть.
inv- 2, Гил
valmesgold=valmesgold+2
выносливость=выносливость+6
if выносливость>максвыносливость+0.9 then выносливость=(максвыносливость+0.9)
pln #%name$ вкусно поел "фирменного" жаркого. Да, что ни говори, а хвалят его не зря!
btn tavernstraiderbarvalmestalkhello, Продолжить разговор
btn tavernstraiderbar, Закончить разговор
end

:tavernstraiderbarvalmestalkbeer
pln - Один гил, #%name$.
if Гил then btn tavernstraiderbarvalmestalkbeerbuy, - Держи!
btn tavernstraiderbarvalmestalkhello, - Я передумал.
end

:tavernstraiderbarvalmestalkbeerbuy
pln Хозяин таверны подставил объёмистую кружку под бочку, прокрутил вентиль на кране и наполнил кружку до самых краёв хорошим Стилриджским пивом.
inv- Гил
valmesgold=valmesgold+1
inv+ Кружка_пива
beerstatus=beerstatus+1
btn tavernstraiderbar, Отойти
end

:tavernstraiderbarbeerdrink
pln #%name$ выпил пиво. Жидкость немного взбодрила, но притупила ваше восприятие и интеллект.
inv- Кружка_пива
бодрость=бодрость+1.5
if бодрость>бодрость+0.9 then бодрость=бодрость+0.9
if похмелье<1 then интдопохмелья=интеллект
интеллект=интеллект-1
if восприятие>0 and похмелье<1 then восдопохмелья=восприятие & восприятие=восприятие-1
if восприятие>0 and похмелье>0 then восприятие=восприятие-1
похмелье=похмелье+50
btn tavernstraiderbarvalmestalkhello, Продолжить разговор
btn tavernstraiderbar, Закончить разговор
end

:forestprotfield
minute=minute+12
p Насвистывая незатейливую мелодию, #%name$ направился к пшеничным полям. 
if month>2 and month<6 then pln В лицо ему дул лёгкий весенний ветерок. 
p Добравшись, наконец, до растущих здесь повсюду пшеничных колосьев, #%name$ зашагал по извилистой тропке, ведущей через всё поле. 
pln Не останавливаясь, вы оглядели покрытую степным золотом землю, простирающуюся на многие вёрсты. И где-то там, на самом горизонте, #%name$ увидел нечёткие очертания каких-то больших созданий.
pln Западное направление тропы ведёт к небольшой деревне, а северо-восточное - к границе леса Протгорн.
btn villageplaundnearmill, Идти к деревне
btn forestprotfieldbugs, Идти к созданиям
btn forestprotnt, Идти к лесу
end

:forestprotfieldbugssteal
pln Выберите свою жертву.
btn poorpeasantsteal, Крестьянин
btn plainsbugsteal, Гигантский степной жук
btn #%locname$, Вернуться
end

:poorpeasantsteal
pln У крестьянина ничего нет.
btn #%locname$, Вернуться
end

:plainsbugsteal
pln У гигантского полевого жука ничего нет.
btn #%locname$, Вернуться
end

:forestprotfieldbugs
if forestprotbugraiderdie=1 then goto forestprotfieldbugsalert
if forestprotbugraiderdie=2 then goto forestprotfielddead
p Пробираясь через высокие колосья, #%name$ подошёл к двум огромным, 
if размер=1 then p раза в три выше его самого, 
if размер=2 then p раза в два выше его самого, 
if размер=3 then p примерно как он сам, 
if forestprotfieldbugss=1 then pln жукам. & goto forestprotfieldbugs1
forestprotfieldbugss=1
pln созданииям. Создания, оказавшиеся гигантскими жуками, были покрыты толстым серым панцирем, их длинные усы торопливо ощупывали землю перед ними. Передняя пара лапок была предназначена не для передвижения - толстые суставы заканчивали большими, размером со взрослого человека, острыми наростами серповидной формы. Только сейчас #%name$ заметил двух людей, сидящих на жуках и, судя по всему, управляющих ими. С виду это были обычные крестьяне.
btn forestprotfieldbugslook, Наблюдать за жуками
btn forestprotfieldbugsraidertalk, Поговорить с крестьянином
btn forestprotfieldbugraiderfight, Атаковать жуков
btn forestprotfield, Вернуться к тропе
end

:forestprotfieldbugslook
pln #%name$ продолжал наблюдать за гигантскими насекомыми, однако те, напротив, словно не замечали его. Медленно пробираясь по полю, жуки методично взрыхляли землю своими "когтями". Крестьяне, в свою очередь, доставали жмени зерна из больших наплечных сумок и посыпали взрыхлённую землю.

:forestprotfieldbugs1
btn forestprotfieldbugsraidertalk, Поговорить с крестьянином
btn forestprotfieldbugraiderfight, Атаковать жуков
btn forestprotfield, Вернуться к тропе
end

:forestprotfieldbugsalert
pln #%name$ ожидал, что второй крестьянин развернётся и бросится в бегство на своём жуке, однако тот, издав яростный клич, бросился на вас в атаку.
btn forestprotfieldbugraiderfight, Сражаться
end

:forestprotfielddead
pln #%name$ подошёл к двум окровавленным кучам мяса. Мухи уже вовсю жужжали над тем, что когда-то было гигантскими жуками, хотя среди изрубленных останков узнавались и два человеческих тела. Так или иначе, но сражались они до последнего и смерть их была страшна.
btn forestprotfieldbugsdie, Обыскать останки
btn forestprotfield, Вернуться к тропе
end

:forestprotfieldbugsdie
p Если не считать двух покрытых кровью мешков с зерном, от крестьян не осталось ничего ценного. 
if forestprotfieldbugsdieplates>0 then pln Однако, панцири гигантских жуков ценятся среди кузнецов как неплохой материал для доспеха.& btn forestprotfieldbugsdieplate, Забрать панцирь
btn forestprotfielddead, Отойти
end

:forestprotfieldbugsdieplate
forestprotfieldbugsdieplates=forestprotfieldbugsdieplates-1
pln Несколько раз с силой дёрнув, #%name$ оторвал наиболее толстый кусок панциря гигантского жука.
есинв=весинв+2
inv+ Кусок_костяного_панциря
btn forestprotfieldbugsdie, Осмотреться
end

:forestprotfieldbugsraidertalk
proc dialogpar
число=5
proc rnd
proc replicbye
число=7
proc rnd
proc replichello
pln - Здравствуйте, сударь!
число=7
proc rnd
proc replichello
if интеллект>=0 then btn forestprotfieldbugsraidertalkhello, - #%hello$, крестьянин!
if интеллект<0 then btn forestprotfieldbugsraidertalkstupid, - Эээ...Ммм...Дык...А?
if интеллект>=0 then btn forestprotfieldbugs, - #%bye$.
if интеллект<0 then btn forestprotfieldbugs, Шатаясь, отойти
btn forestprotfieldbugraiderfight, Атаковать крестьянина
end

:forestprotfieldbugsraidertalkstupid
pln - Вы уж меня извините, что вас перебиваю, но что-то ваших слов разобрать не могу.
btn forestprotfieldbugs, Отойти
end

:forestprotfieldbugsraidertalkhello
pln - Чего вам надобно, сударь?
btn forestprotfieldbugsraidertalkbugs, - Что это за создания?
btn forestprotfieldbugsraidertalkvillage, - Что у вас за деревня?
if интеллект>=0 then btn forestprotfieldbugs, - #%bye$.
btn forestprotfieldbugsraiderfight, Атаковать крестьянина
end

:forestprotfieldbugsraidertalkbugs
pln - О, не пугайтесь, они не причинят вам вреда. Перед вами - гигантские степные жуки, вот так. Я много не узнавал, знаю только, что наш деревенский чародей, почтенный Гурий, сумел приручить нескольких таких тварей и направить их в нужное русло. Их дикие собратья опасны, но наши действительно безобидны и подчиняются только командам своих наездников. К тому же они - хорошая защита от нападений разбойников.
btn forestprotfieldbugsraidertalkhello, - Весьма интересно, а...
end

:forestprotfieldbugsraidertalkvillage
pln - О, это очень милая небольшая деревенька Плаунд. Тут живут всего пару десятков человек, почти все - пахари. Это, можно сказать, и есть наш основной промысел. Края здесь родят хорошо, почти каждый год хороший урожай, так что живём потихоньку... Это очень гостеприимное место, у нас есть небольшая церковь, кузница.
btn forestprotfieldbugsraidertalkhello, - Весьма интересно, а...
end

:villageplaundnearmill
pln Пройдя дальше по тропинке, #%name$ увидел неподалёку возвышающуюся ввысь ветровую мельницу. Её крылья, выполняя положенную им роль и равномерно кружась вокруг своей оси, оставляли контрастирующую с освещённой дневным светилом землёй тень, которая то скрывала вас в полумраке, то снова уходила в сторону, отдавая во власть солнца.#/$Чуть поодаль виднеется вход в окружённую невысоким забором деревню, а в противоположном направлении - узкая тропинка, ведущая в пшеничное поле.
btn villageplaundwentrance, Идти ко входу в деревню
btn villageplaundinmill, Войти в мельницу
btn forestprotfield, Идти по тропинке в поле
end

:villageplaundwentrance
pln Восседая на грозном боевом жуке, западный вход в деревню охраняет одинокий копейщик. Не похоже, чтобы на нём был какой-либо доспех - накинута обычная деревенская одежда. Однако, по тому, как парень держит копьё в руках и уверенно держится на гигантском жуке, можно сказать, что он скорее воин, чем пахарь.

end

;Информация

:infothornhand
pln Шипастая рука
pln Заклинание зелёной магии, первый уровень
pln Моментальное
pln Мана: 5-1
pln Условие: Вы должны драться голыми руками.
pln Эффект: Урон повышается на 2-5 единицы.
btn #%locname$, Назад
end

:infobranch
pln Опутывающие ветви
pln Заклинание зелёной магии, первый уровень
pln Кастинг: 1 ход
pln Мана: 5-2
pln Условие: Нет.
pln Эффект: Противника парализует на 3-5 ходов. Зависит также от уровня противника.
btn #%locname$, Назад
end

:infoaiming
pln Исцеление
pln Заклинание зелёной магии, первый уровень
pln Кастинг: 1 ход
pln Мана: 4-2
pln Условие: Нет.
pln Эффект: Излечивает от яда, проклятия и слезливости. Восстанавливает 0-15 жизненной силы.
btn #%locname$, Назад
end

:infopblade
pln Отравленный клинок
pln Заклинание зелёной магии, второй уровень
pln Моментальное
pln Мана: 3-1
pln Условие: В ваших руках должно быть режущее или колющее оружие.
pln Эффект: При каждом ударе ваше оружие отравляет противника на 1-3 единицы.
btn #%locname$, Назад
end

:infobeastkick
pln Удар зверя
pln Заклинание зелёной магии, второй уровень
pln Моментальное
pln Мана: 5-2
pln Условие: Вы должны быть безоружны.
pln Эффект: Вы делаете удар врагу с двойным (тройным) уроном.
btn #%locname$, Назад
end

:infonoilluses
pln Снятие иллюзий
pln Заклинание зелёной магии, второй уровень
pln Кастинг: 1 ход.
pln Мана: 3-1
pln Условие: Нет.
pln Эффект: Вы уничтожаете все иллюзии на месте поединка.
btn #%locname$, Назад
end

:infostearing
pln Слезливость
pln Заклинание синей магии, первый уровень
pln Кастинг: 1 ход.
pln Мана: 7-1
pln Условие: Нет.
pln Эффект: Точность противника понижается на 1-16 единиц.
btn #%locname$, Назад
end

:infoshock
pln Удар шоком
pln Заклинание белой магии, первый уровень
pln Кастинг: 1 ход.
pln Мана: 6-1
pln Условие: Нет.
pln Эффект: Противник получает 8-23 повреждений шоком.
btn #%locname$, Назад
end

:infodeadhand
pln Умерщвляющая рука
pln Заклинание чёрной магии, первый уровень
pln Моментальное.
pln Мана: 4-1
pln Условие: Противник должен быть живым.
pln Эффект: Противник теряет 3-18 единиц бодрости, 0-15 здоровья и одну единицу ловкости.
btn #%locname$, Назад
end

:infosmart
pln Пылкость
pln Заклинание красной магии, первый уровень
pln Моментальное.
pln Мана: 4-1
pln Условие: Нет.
pln Эффект: Вы становитесь на 2-17 единицы быстрее.
btn #%locname$, Назад
end

:Use_Inv_Воровство
if steals=0 then p #/$#/$Здесь нет никого, у кого можно было бы что-либо украсть!
if steals=1 then goto #%stealloc$ 
end

:Use_Inv_Время
p #/$#/$#year$ год, #%месяц$, #week$ неделя, #day$ число, #%день$, #hour$:
if minute<10 then p 0#minute$, 
if minute>9 then p #minute$, 
if sec<10 then pln 0#sec$ секунд.
if sec>9 then pln #sec$ секунд.
end

:Use_Inv_Статус
if dialog=0 then instr style_formpicture=heroimages/#%imagearmor$/#%imageshoes$/#%imagecap$/#imageweapon$.bmp
pln #/$#/$#%race$ #%name$.
p Здоровье - #здоровье-0.7$/#максздоровье$, мана - #мана-0.7$/#максмана$, бодрость - #бодрость-0.7$/#максбодрость$, сытость - #выносливость-0.7$/#максвыносливость$, опыт - #опыт$/
if уровень=0 then p 15
if уровень=1 then p 30
if уровень=2 then p 60
if уровень=3 then p 90
if уровень=4 then p 120
if уровень=5 then p 150
if уровень=6 then p 200
if уровень=7 then p 250
if уровень=8 then p 300
if уровень=9 then p 350
if уровень=10 then p 450
if уровень=11 then p 550
if уровень=12 then p 700
if уровень=13 then p 850
if уровень=14 then p 1000
if уровень=15 then p 1250
if уровень=16 then p 1500
if уровень=17 then p 1800
if уровень=18 then p 2100
if уровень=19 then p 2500
pln .
end

:Use_Inv_Характеристики
pln #/$#/$Навыки:#/$
pln Сила - #сила$
pln Скорость - #скорость$
pln Ловкость - #ловкость$
pln Восприятие - #восприятие$
pln Точность - #точность$
pln Интеллект - #интеллект$
pln Выносливость - #максвыносливость/3$
pln Бодрость - #максбодрость/3$
pln Здоровье - #максздоровье/3$
pln Мана - #максмана/3$
pln Удача - #удача$
pln Харизма - #харизма$
pln #/$Магия:#/$
pln Белая магия - #белмагия$
pln Чёрная магия - #чёрмагия$
pln Синяя магия - #синмагия$
pln Красная магия - #красмагия$
pln Зелёная магия - #зелмагия$
pln #/$Умения:#/$
pln Торговля - #торговля$
pln Воровство - #воровство$
pln Рукопашная - #знаниекулака$
pln Мечи и кинжалы - #знаниемеча$
pln Посохи, копья, глефы, алебарды - #знаниешеста$
pln Кастеты - #знаниекастета$
pln Кувалды, булавы, молоты, жезлы - #знаниепалицы$
pln Топоры - #знаниетопора$
end

:Use_Inv_Включить_музыку
musicno=0
число=2
proc rnd
if common=1 and рнд=1 then music="1.ogg"
if common=1 and рнд=2 then music="3.ogg"
if common>1 then music="2.ogg"
end

:Use_Inv_Выключить_музыку
musicno=1
music=""
end
 :Use_Inv_Начать_сначала
clrscr=1
cls
goto mainmenu
end

:Use_Малый_топор
p #/$#/$Небольшой одноручный топор. Чаще всего используется в паре с щитом. 
if знаниетопора=0 then p Вы пока не можете использовать это оружие. 
if интеллект>1 then pln Вес топора: 4. Повреждения: 2 - 5. Требуется: знание топора 1.
end

:Use_Малый_топор_Бросить
if сундукхранения=0 and dangerplace=0 and мешок=0 then pln #/$#/$Вы выбросили малый топор. & inv- Малый_топор & весоружия=весоружия-4 & колоружия=колоружия-1
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropмалыйтопор
end

:Use_Топор_дровосека
p #/$#/$Это скорее не оружие, а инструмент для колки дров. 
if интеллект>1 then pln Вес топора: 3. Повреждения: 1 - 3.
end

:Use_Топор_дровосека_Бросить
if сундукхранения=0 and dangerplace=0 and мешок=0 then pln #/$#/$Вы выбросили топор дровосека. & inv- Топор_дровосека & весоружия=весоружия-3 & колоружия=колоружия-1
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropтопордровосека
end

:Use_Двуручный_топор
p #/$#/$Большое двуручное оружие. Одним взмахос такого топора можно отрубить голову. 
if интеллект>1 then pln Вес топора: 5. Повреждения: 3 - 8.
end

:Use_Двуручный_топор_Бросить
if сундукхранения=0 and dangerplace=0 and мешок=0 then pln #/$#/$Вы выбросили двуручный топор. & inv- Двуручный_топор & весоружия=весоружия-5
if сундукхранения=0 and dangerplace=0 and мешок=0 and размер=3 then колоружия=колоружия-1
if сундукхранения=0 and dangerplace=0 and мешок=0 and размер<3 then колоружия=колоружия-2
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropдвуручныйтопор
end

:Use_Посох_друида
if интеллект>2 then pln #%name$ осмотрел посох маны и, прищурившись, увидел тонкие струйки магической энергии, струящейся в трещинках деревянной коры, с самого магического камня на вершине посоха, до конца упирающегося в землю. Вес посоха: 2. Повреждения: 1 - 2 +6 к мане, +1 к зелёной магии. & inv- Посох_друида & inv+ Посох_маны
if интеллект<3 then pln Перед вами обычный сучковатый шест с круглым каменным навершием. Однако в этой незамысловатой на вид палке содержится магическая сила, заметная даже такому малопонимающему в волшебстве #%race$у, как #%name$. Вес посоха: 2. Повреждения: 1 - 2.
end

:Use_Посох_маны
pln #%name$ осмотрел посох маны и, прищурившись, увидел тонкие струйки магической энергии, струящейся в трещинках деревянной коры, с самого магического камня на вершине посоха, до конца упирающегося в землю. Вес посоха: 2. Повреждения: 1 - 2 +6 к мане, +1 к зелёной магии.
end

:Use_Посох_друида_Бросить
if сундукхранения=0 and dangerplace=0 then pln #/$#/$Вы выбросили посох друида. & inv- Посох_друида & весоружия=весоружия-3 & максмана=максмана-6 & колоружия=колоружия-2
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropпосохдруида & максмана=максмана-6 & весоружия=весоружия-3
if мана>максмана+0.9 then мана=максмана+0.9
end

:Use_Посох_маны_Бросить
if сундукхранения=0 and dangerplace=0 then pln #/$#/$Вы выбросили посох маны. & inv- Посох_маны & весоружия=весоружия-3 & максмана=максмана-6 & колоружия=колоружия-2
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropпосохманы & максмана=максмана-6 & весоружия=весоружия-3
if мана>максмана+0.9 then мана=максмана+0.9
end

:Use_Плащ
pln Обычный дорожный плащ. Хорошо защищает от дождя, пыли. Часто носится ворами.
if интеллект>1 then pln Защита: 1.
end

:Use_Плащ_Надеть
if dangerplace=1 then pln Сейчас нельзя ничего надевать!
if dangerplace=0 and actbody=1 then pln На вас уже что-то надето!
if dangerplace=0 and actbody=0 then pln #%name$ надел на себя коричневый плащ. & бронятела=бронятела+1 & actbody=1 & robes=1 & sec=sec+20 & весинв=весинв-1 & весброни=весброни+1
end

:Use_Плащ_Снять
if dangerplace=1 then pln Сейчас нельзя ничего снимать!
if dangerplace=0 and robes=0 then pln На вас не надет плащ!
if dangerplace=0 and robes=1 and мешок=1 then pln #%name$ снял с себя коричневый плащ и положил его себе в мешок.& instr imagearmor=noarmor& бронятела=бронятела-1 & actbody=0 & robes=0 & sec=sec+20 & весброни=весброни-1 & весинв=весинв+1
if dangerplace=0 and robes=1 and мешок=0 and kickclothes=1 then pln #%name$ снял с себя коричневый плащ и выкинул его.& instr imagearmor=noarmor& бронятела=бронятела-1 & actbody=0 & robes=0 & sec=sec+20 & inv- Плащ & весброни=весброни-1 & kickclothes=0
if dangerplace=0 and robes=1 and мешок=0 and kickclothes=0 then pln #%name$ не может снять с себя плащ - ему некуда его положить. Повторите операцию, чтобы снять и выкинуть плащ. & kickclothes=1
end

:Use_Плащ_Бросить
if сундукхранения=0 and dangerplace=0 and robes=0 then pln #/$#/$Вы выбросили плащ. & inv- Плащ & весинв=весинв-1 & бронятела=бронятела-1
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 and robes=0 then goto boxdropплащ & бронятела=бронятела-1 & весинв=весинв-1
if dangerplace=0 & robes=1 then pln Сначала снимите с себя плащ!
end

:Use_Сандалии
pln Обыкновенные сандалии с деревянной подошвой и кожаными ремешками.
if интеллект>1 then pln Защита: 1.
end

:Use_Сандалии_Надеть
if dangerplace=1 then pln Сейчас нельзя ничего надевать!
if dangerplace=0 and actlegs=1 then pln На вас уже что-то надето!
if dangerplace=0 and actlegs=0 and копыта=0 then pln #%name$ надел на себя сандалии. & броняног=броняног+1 & actlegs=1 & sandaless=1 & sec=sec+20 & весинв=весинв-1 & весобуви=весобуви+1 if копыта=1 then pln Вы не можете ничего надевать на ноги.
end

:Use_Сандалии_Снять
if dangerplace=1 then pln Сейчас нельзя ничего снимать!
if dangerplace=0 and sandaless=0 then pln На вас не надеты сандалии!
if dangerplace=0 and sandaless=1 and мешок=1 then pln #%name$ снял с себя сандалии и положил их себе в мешок.& instr imageshoes=noshoes& броняног=броняног-1 & actlegs=0 & sandaless=0 & sec=sec+20 & весобуви=весобуви-1 & весинв=весинв+1
if dangerplace=0 and sandaless=1 and мешок=0 and kickclothes=1 then pln #%name$ снял с себя сандалии и выкинул их.& instr imageshoes=noshoes& броняног=броняног-1 & actlegs=0 & sandaless=0 & sec=sec+20 & inv- Сандалии & весобуви=весобуви-1 & kickclothes=0
if dangerplace=0 and sandaless=1 and мешок=0 & kickclothes=0 then pln #%name$ не может снять с себя сандалии - ему некуда их положить. Повторите операцию, чтобы снять и выкинуть сандалии. & kickclothes=1
end

:Use_Сандалии_Бросить
if сундукхранения=0 and dangerplace=0 and sandaless=0 then pln #/$#/$Вы выбросили сандалии. & inv- Сандалии & весинв=весинв-1 & броняног=броняног-1
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 and sandaless=0 then goto boxdropсандалии & броняног=броняног-1 & весинв=весинв-1
if dangerplace=0 & sandaless=1 then pln Сначала снимите с себя сандалии!
end

:Use_Яблоко
if годностьяблок=3 then pln #/$#/$Свежее, сочное яблоко.
if годностьяблок=2 then pln #/$#/$Немного примятое, но всё равно аппетитное яблоко.
if годностьяблок=1 then pln #/$#/$Не очень свежее и сильно примятое яблоко.
if годностьяблок<1 then pln #/$#/$Это яблоко пропало.
end

:Use_Яблоко_Съесть
if dangerplace=0 and выносливость<(максвыносливость+0.9) then p #/$#/$#%name$ съел яблоко. & inv- Яблоко & выносливость=выносливость+1.5
if dangerplace=0 and выносливость>=максвыносливость+0.9 then pln #/$#/$#%name$ сыт.
if dangerplace=0 and выносливость>(максвыносливость+0.9) then выносливость=(максвыносливость+0.9)
if dangerplace=1 then pln #/$#/$Сейчас нельзя этого сделать!
end

:Use_Яблоко_Бросить
if dangerplace=0 and сундукхранения=0 then pln #/$#/$#%name$ выбросил яблоко. & inv- Яблоко
if dangerplace=1 then pln Сейчас нельзя ничего выкидывать!
if сундукхранения=1 then goto pln #/$#/$Пищу нельзя хранить в сундуках!
end

:Use_Кусок_костяного_панциря
pln Толстый кусок очень прочного костяного панциря. Из него можно сделать хороший доспех или оружие. Пусть он не так крепок как сталь, но уж точно легче.
if интеллект>1 then pln Вес: 2.
end

:Use_Кусок_костяного_панциря_Бросить
if dangerplace=0 and сундукхранения=0 then pln #/$#/$#%name$ выбросил яблоко. & inv- Кусок_костяного_панциря & весинв=весинв-2
if dangerplace=1 then pln Сейчас нельзя ничего выкидывать!
if сундукхранения=1 then goto boxdropкусокпанциря
end

:Use_Лечебная_трава
pln #/$#/$Засушенный лист редкой в Трионе лечебной травы. Быстро останавливает кровотечение и дезинфицирует рану.
end

:Use_Лечебная_трава_Использовать
if dangerplace=0 and здоровье>=максздоровье+0.9 then pln #/$#/$#%name$ здоров.
if dangerplace=0 and здоровье<максздоровье+0.9 then p #/$#/$#%name$ пережевал лист лечебной травы и нанёс кашицу на раненное место. Через несколько секунд кровотечение прекратилось, а кровь на ране запеклась. & inv- Лечебная_трава & здоровье=здоровье+2
if dangerplace=0 and здоровье>максздоровье+0.9 then здоровье=максздоровье+0.9
if dangerplace=1 then pln #/$#/$Сейчас нельзя этого сделать!
end

:Use_Лечебная_трава_Бросить
if сундукхранения=0 and dangerplace=0 then pln #/$#/$Вы выбросили лечебную траву. & inv- Лечебная_трава
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropлечебнаятрава
end

:Use_Корень_Гинка
pln #/$#/$Из корня растения Гинка можно сварить многие зелья, поэтому он ценится травниками всего Триона.
end

:Use_Корень_Гинка_Использовать
if dangerplace=0 and здоровье-максздоровье=0.9 and бодрость-максбодрость=0.9 and выносливость-максвыносливость=0.9 then pln #/$ #/$ #%name$ здоров, бодр и сыт.
if dangerplace=0 and здоровье<максздоровье+0.9 and бодрость<максбодрость+0.9 and выносливость<максвыносливость+0.9 then p #/$#/$#%name$, отламывая по кусочку, съел весь корень Гинка. Кроме прекрасного вкуса и сытности, корень восстановил вашу бодрость и жизненные силы. & inv- Корень_Гинка & здоровье=здоровье+2 & бодрость=бодрость+2 & выносливость=выносливость+2
if dangerplace=0 and здоровье>максздоровье+0.9 then здоровье=максздоровье+0.9
if dangerplace=0 and бодрость>максбодрость+0.9 then бодрость=максбодрость+0.9
if dangerplace=0 and выносливость>максвыносливость+0.9 then выносливость=максвыносливость+0.9
if dangerplace=1 then pln Сейчас нельзя этого сделать!
end

:Use_Корень_Гинка_Бросить
if сундукхранения=0 and dangerplace=0 then pln #/$#/$Вы выбросили корень Гинка. & inv- Корень_Гинка
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropкореньгинка
end

:Use_Манновая_ромашка
pln #/$#/$Около десятка засушенных лепестков особого вида ромашки, растущей только в эльфийских лесах. Говорят, что она растёт на местах захоронений эльфов и, поэтому, набирает в себя магическую силу.
end

:Use_Манновая_ромашка_Использовать
if dangerplace=0 and мана>=максмана+0.9 then pln #/$#/$#%name$ и так полон магической силы.
if dangerplace=0 and мана<максмана+0.9 then p #/$#/$#%name$ проглотил лепестки ромашки и почувствовал, как в него входят магические силы. Ваша голова закружилась от такого напора маны. & inv- Манновая_ромашка & мана=мана+3
if dangerplace=0 and мана>максмана+0.9 then мана=максмана+0.9
if dangerplace=1 then pln #/$#/$Сейчас нельзя этого сделать!
end

:Use_Манновая_ромашка_Бросить
if сундукхранения=0 and dangerplace=0 then pln #/$#/$Вы выбросили манновую ромашку. & inv- Манновая_ромашка
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropманноваяромашка
end

:Use_Сок_синего_гриба
pln #/$#/$Густая жидкость тёмно-синего цвета, запакованная в водостойкий бумажный пакетик. Синий гриб очень токсичный и запросто может убить человека. Поэтому соки из них выжимают только весной, когда большая часть токсичности пропадает.
end

:Use_Сок_синего_гриба_Использовать
if dangerplace=0 and бодрость>=максбодрость+0.9 then pln #/$#/$#%name$ бодр, а этим соком злоупотреблять нельзя.
if dangerplace=0 and бодрость<максбодрость+0.9 then p #/$#/$#%name$ заглотнул содержимое бумажного пакетика и еле устоял на ногах от жёсткой боли в голове и всём теле. Когда боль прошла, а головная боль немного приутихла, #%name$ почувствовал, что полон сил & inv- Сок_синего_гриба & бодрость=бодрость+3
if dangerplace=0 and бодрость>максбодрость+0.9 then бодрость=максбодрость+0.9
if dangerplace=1 then pln #/$#/$Сейчас нельзя этого сделать!
end

:Use_Сок_синего_гриба_Бросить
if сундукхранения=0 and dangerplace=0 then pln #/$#/$Вы выбросили сок синего гриба. & inv- Сок_синего_гриба
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropсоксинегогриба
end

:Use_Гил
pln #/$#/$Монета из чистого серебра, изготовленная как государственная монета Нелласа, но используемая во всём Трионе.
end

:Use_Гил_Бросить
if dangerplace=0 and сундукхранения=0 then pln #/$#/$#%name$ выбросил ненужные ему деньги. & inv_Гил=0
if dangerplace=1 then pln #/$#/$Сейчас нельзя ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropгил
end

:Use_Сырое_мясо
p #/$#/$Кусок сырого и плохо пахнущего мяса. 
if годностьмяса>3 then p Мясо пока ещё свежее
if годностьмяса<4 then p Мясо начинает пропадать
if годностьмяса<1 then p Мясо несъедобно
if годностьмяса>0 and dangerplace=0 and красмагия>0 then p . #%name$ произносит простое заклинание и кусок мяса в вашей руке начинает темнеть и жариться, как если бы он лежал на углях. & inv- #freshmeat$, Сырое_мясо & inv+ #freshmeat$, Жаренное_мясо & годностьжмяса=годностьмяса+2
end

:Use_Сырое_мясо_Съесть
if dangerplace=0 and выносливость>=максвыносливость+0.9 then pln #/$#/$#%name$ сыт.
if dangerplace=0 and выносливость<(максвыносливость+0.9) and годностьмяса>0 then pln #/$#/$#%name$ съел сырое мясо. & inv- Сырое_мясо & выносливость=выносливость+4 & весинв=весинв-1
if dangerplace=0 and выносливость<(максвыносливость-0.9) and годностьмяса<1 then p #/$ #/$ #%name$ не может это мясо. За время, которое мясо провело без нужной теплоизоляции, оно сильно испортилось.
if dangerplace=0 and выносливость>(максвыносливость+0.9) then выносливость=(максвыносливость+0.9)
if dangerplace=1 then pln #/$#/$Сейчас нельзя этого сделать!
end

:Use_Сырое_мясо_Бросить
if dangerplace=0 and сундукхранения=0 then pln #/$#/$#%name$ выбросил сырое мясо. & inv- Сырое_мясо & весинв=весинв-1
if dangerplace=1 then pln #/$#/$Сейчас нельзя ничего выкидывать!
if сундукхранения=1 then pln #/$#/$Пищу нельзя хранить в сундуках!
end

:Use_Жаренное_мясо
p #/$#/$Кусок хорошо прожаренного мяса. 
if годностьмяса<1 then p Мясо несъедобно
end

:Use_Жаренное_мясо_Съесть
if dangerplace=0 and выносливость>=максвыносливость+0.9 then pln #/$#/$#%name$ сыт.
if dangerplace=0 and выносливость<(максвыносливость+0.9) and годностьжмяса>0 then p #/$ #/$ #%name$ съел жаренное мясо. & inv- Жаренное_мясо & выносливость=выносливость+4 & здоровье=здоровье+1 & весинв=весинв-1
if dangerplace=0 and выносливость<(максвыносливость-0.9) and годностьжмяса<1 then p #/$#/$#%name$ не может это мясо. За время, которое мясо провело без нужной теплоизоляции, оно сильно испортилось.
if dangerplace=0 and выносливость>(максвыносливость+0.9) then выносливость=(максвыносливость+0.9)
if dangerplace=0 and здоровье>(максздоровье+0.9) then здоровье=(максздоровье+0.9)
if dangerplace=1 then pln #/$#/$Сейчас нельзя этого сделать!
end

:Use_Жаренное_мясо_Бросить
if dangerplace=0 and сундукхранения=0 then pln #/$#/$#%name$ выбросил жаренное мясо. & inv- Жаренное_мясо & весинв=весинв-1
if dangerplace=1 then pln #/$#/$Сейчас нельзя ничего выкидывать!
if сундукхранения=1 then pln #/$ #/$Пищу нельзя хранить в сундуках!
end

:Use_Кружка_пива_Выпить
if dangerplace=1 then pln #/$#/$Сейчас нельзя этого сделать!
if dangerplace=0 then pln #/$#/$#%name$ выпил пиво. Жидкость немного взбодрила, но притупила ваше восприятие и интеллект. & inv- Кружка_пива & бодрость=бодрость+1.5 & похмелье=похмелье+50 & интдопохмелья=интеллект & восдопохмелья=восприятие & восприятие=восприятие-1 & интеллект=интеллект-1
end

:Use_Кружка_пива
pln #/$#/$Хорошее светлое пиво, которое разливают в городе Стилридж. Это пиво считается одним из самых лучших.
end

:Use_Кружка_пива_Бросить
pln #%name$ поставил пиво на пустой столик.
inv- Кружка_пива
end

:Use_Заклинания
pln #/$#/$Вы знаете:
if magicshock=1 then pln Удар шоком
if magicdeadhand=1 then pln Умерщвляющая рука
if magicstearing=1 then pln Слезливость
if magicsmart=1 then pln Пылкость
if magicbranch=1 then pln Опутывающие ветви
if magicthornhand=1 then pln Шипастая рука
if magicaiming=1 then pln Исцеление
end

:Use_Коробок_спичек
p #/$#/$Обычный коробок со спичками. 
if inv_Коробок_спичек=1 then pln В нём осталось #matches$ спичек.
if inv_Коробок_спичек>1 then pln В #inv_Коробок_спичек$ коробках осталось #matches$ спичек.
end

:Use_Коробок_спичек_Зажечь_спичку
cls
light=1
pln #%name$ зажёг спичку.#/$#/$
matches=matches-1
if matches=0 then inv- Коробок_спичек
lighttime=3
if darklocs=1 then goto #%darkloc$
end

:Use_Коробок_спичек_Бросить
if сундукхранения=0 and dangerplace=0 then pln #/$ #/$Вы выбросили коробок спичек. & matches=matches-((inv_Коробок_спичек-1)*50-matches) & inv- Коробок_спичек
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropкоробокспичек
end

:Use_Дневник_Рилла_Криома
pln #/$#/$Старый потрёпанный блокнот. На обложке написано "Дневник Рилла Криома".
end

:Use_Дневник_Рилла_Криома_Прочитать
pln #/$#/$#%name$ открыл последнюю запись в дневнике:
pln "Сегодня я докажу себе и своему отцу, что я уже достоин называться настоящим воином. И хоть мне запретили идти в лес, я верю в то, что смогу победить волка. И в этом мне поможет моё магическое кольцо. Да, я знаю, что украл его из дома, но я не могу более ждать. Я иду в бой, чтобы выиграть."
end

:Use_Дневник_Рилла_Криома_Бросить
if сундукхранения=0 and dangerplace=0 then pln #/$ #/$Вы выбросили блокнот. & inv- Дневник_Рилла_Криома
if dangerplace=1 then pln #/$#/$Вы не можете сейчас ничего выкидывать!
if dangerplace=0 and сундукхранения=1 then goto boxdropдневникрк
end

:Use_Кольцо_Рилла_Криома
p #/$#/$Вы вгляделись в золотое кольцо. В светло-жёлтый отсвет, который оно отражает. Ещё глубже... в саму сущность кольца. Когда ваш разум уже почти познал сущность кольца, #%name$ почувствовал сильный магический толчок, как будто кто-то ударил вас по вискам. 
if интеллект>2 then pln Но, прежде чем прервать связь с кольцом, #%name$ успел понять его магический дар. & inv- Кольцо_Рилла_Криома & inv+ Кольцо_здоровья
if интеллект<3 then pln Магическая ловушка сработала и вам пришлось прервать связь с кольцом, чтобы просто не потерять сознание.
end

:Use_Кольцо_Рилла_Криома_Бросить
if rkrings=0 and dangerplace=0 and сундукхранения=0 then pln #/$#/$Вы выбросили золотое кольцо. & inv- Кольцо_Рилла_Криома
if rkrings=0 and dangerplace=0 and сундукхранения=1 then goto boxdroprkring
if rkrings=1 and dangerplace=0 then pln #/$#/$Кольцо сейчас на вашем пальце.
if dangerplace=1 then pln #/$#/$Вы сейчас не можете этого сделать!
end

:Use_Кольцо_Рилла_Криома_Надеть
if rkrings=1 then pln #/$#/$Это кольцо и так уже на вашем пальце!
if rkrings=0 and dangerplace=1 then pln #/$#/$#%name$ сейчас не может ничего надевать!
if rkrings=0 and dangerplace=0 and rings=3 and раса<>18 then pln #/$#/$#%name$ не может надевать более трёх колец!
if rkrings=0 and dangerplace=0 and rings<3 and раса<>18 then pln #/$#/$#%name$ надел золотое кольцо на палец. & rkrings=1 & rings=rings+1 & максздоровье=максздоровье+1
if размер=3 then pln #%name$ - #%race$ и не может надеть такое маленькое колечко!
end

:Use_Кольцо_Рилла_Криома_Снять
if rkrings=0 then pln #/$#/$Это кольцо на вас не надето!
if rkrings=1 and dangerplace=1 then pln #/$#/$#%name$ сейчас не может ничего снимать!
if rkrings=1 and dangerplace=0 then pln #/$#/$#%name$ снял золотое кольцо с пальца. & rkrings=0 & rings=rings-1 & максздоровье=максздоровье-1
if здоровье>максздоровье+0.9 then здоровье=максздоровье+0.9
end

:Use_Кольцо_лечения
pln #/$#/$Это кольцо наделено магической силой жизни и увеличивает ваше здоровье.
end

:Use_Кольцо_лечения_Бросить
if rkrings=0 and dangerplace=0 and сундукхранения=0 then pln #/$#/$Вы выбросили кольцо лечения. & inv- Кольцо_лечения
if rkrings=0 and dangerplace=0 and сундукхранения=1 then goto boxdropкольцолечения
if rkrings=1 and dangerplace=0 then pln #/$#/$Кольцо сейчас на вашем пальце.
if dangerplace=1 then pln #/$#/$Вы сейчас не можете этого сделать!
end

:Use_Кольцо_лечения_Надеть
if dangerplace=1 then pln #/$#/$#%name$ сейчас не может ничего надевать!
if dangerplace=0 and rings=3 and раса<>18 then pln #/$#/$#%name$ не может надевать более трёх колец!
if dangerplace=0 and rings<3 and раса<>18 then pln #/$#/$#%name$ надел золотое кольцо на палец. & rkrings=1 & rings=rings+1 & healrings=healrings+1 & максздоровье=максздоровье+1
if раса=18 then pln Дракон #%name$ не может надеть такое маленькое колечко!
if размер=3 then pln #%name$ - #%race$ и не может надеть такое маленькое колечко!
end

:Use_Кольцо_лечения_Снять
if healrings=0 then pln #/$#/$Это кольцо на вас не надето!
if healrings>0 and dangerplace=1 then pln #/$#/$#%name$ сейчас не может ничего снимать!
if healrings>0 and dangerplace=0 pln #/$#/$#%name$ снял кольцо лечения с пальца. & healrings=healrings-1 & rings=rings-1 & максздоровье=максздоровье-1
if здоровье>максздоровье+0.9 then здоровье=максздоровье+0.9
end

:gameover
music="4.ogg"
instr style_formpicture=999.bmp
pln #%name$ мёртв... Игра окончена. Чтобы загрузить игру, нажмите Файл > Загрузить игру. Чтобы начать сначала, нажмите кнопку внизу.
pln #/$#/$#/$#/$Welcome to dying#/$ I don't let it out#/$Welcome to dying#/$Look to the mirror it shows what I am#/$Welcome to dying#/$This town must burn now#/$Welcome to dying#/$Can't you see the dragon's seed bears in me
btn mainmenu, Начать сначала
end

:forestprotgibfight
dangerplace=0
instr locname=forestprotgibdie
instr fightname=wgib
common=1
proc fight#%fightname$status
if впол=1 then instr cname=ий
if впол=2 then instr cname=ая
if впол=3 then instr cname=ее
if впол=1 then instr cname1=ся
if впол=2 then instr cname1=ась
if впол=3 then instr cname1=ось
numterdesenemy=2
instr terdescriptionenemy1=Обезумевш#%cname$ #%enemy$, сквозь кучу листьев, помчал#%cname1$ прямо на вас.
instr terdescriptionenemy2=Громко прорычав, #%enemy$ ринул#%cname1$ в атаку на вас.
numterdes=2
instr terdescription1=Сконцентрированный только на #%enemy5$, #%name$ чуть было не споткнулся об пень.
instr terdescription2=На мгновение оторвав взгляд от #%enemy1$, #%name$ увидел, что все деревья вокруг них в следах от когтей.
goto fightchoseweap

:forestprotgibsmartfight
instr locname=forestprotgibdie
instr fightname=wgib
common=1
плюскскорости=2
скорость=скорость+2
proc fight#%fightname$status
if впол=1 then instr cname=ий
if впол=2 then instr cname=ая
if впол=3 then instr cname=ее
if впол=1 then instr cname1=ся
if впол=2 then instr cname1=ась
if впол=3 then instr cname1=ось
numterdesenemy=2
instr terdescriptionenemy1=Обезумевш#%cname$ #%enemy$, сквозь кучу листьев, помчал#%cname1$ прямо на вас.
instr terdescriptionenemy2=Громко прорычав, #%enemy$ ринул#%cname1$ в атаку на вас.
numterdes=2
instr terdescription1=Сконцентрированный только на #%enemy5$, #%name$ чуть было не споткнулся об пень.
instr terdescription2=На мгновение оторвав взгляд от #%enemy1$, #%name$ увидел, что все деревья вокруг них в следах от когтей.
goto fightchoseweap

:forestprothousegibfight
instr locname=forestprothousegibdie
instr fightname=wgib
common=1
numterdesenemy=0
numterdes=0
proc fight#%fightname$status
numterdesenemy=0
numterdes=0
goto fightchoseweap

:forestprotwolffight
instr fightname=wolf
common=1
proc fight#%fightname$status
if впол=1 then instr cname=ий
if впол=2 then instr cname=ая
if впол=3 then instr cname=ее
if впол=1 then instr cname1=ся
if впол=2 then instr cname1=ась
if впол=3 then instr cname1=ось
numterdesenemy=2
instr terdescriptionenemy1=Обезумевш#%cname$ #%enemy$, сквозь кучу листьев, помчал#%cname1$ прямо на вас.instr terdescriptionenemy2=Громко прорычав, #%enemy$ ринул#%cname1$ в атаку на вас.
numterdes=2
instr terdescription1=Сконцентрированный только на #%enemy5$, #%name$ чуть было не споткнулся об пень.
instr terdescription2=На мгновение оторвав взгляд от #%enemy1$, #%name$ увидел, что все деревья вокруг них в следах от когтей.
goto fightchoseweap

:tavernstraiderbarvalmesfight
tavernstraiderrooms=1
valmesdie=1
tavernstraideralert=1
instr locname=tavernstraiderbar
instr fightname=valmes
common=1
proc fight#%fightname$status
numterdesenemy=2
if впол=1 then instr cname=ий
if впол=2 then instr cname=ая
if впол=3 then instr cname=ее
if впол=1 or впол=3 then instr cname1=ему
if впол=2 then instr cname1=ей
if впол=1 then instr cname2=
if впол=2 then instr cname2=а
if впол=3 then instr cname2=о
instr terdescriptionenemy1=Озверевш#%cname$ #%enemy$ рабивает в щепья все попадающиеся #%cname1$ на пути стулья, сам#%cname2$ того не замечая.
if впол=1 then instr cname=ый
if впол=2 then instr cname=ая
if впол=3 then instr cname=ое
instr terdescriptionenemy2=Поглощён#%cname$ схваткой #%enemy$ перебил#%cname2$ уже половину маслянных ламп в таверне.
numterdes=1
if alliradie=0 or krildie=0 or traydie=0 then numterdes=2
instr terdescription1=Постоянно пятясь назад под напором атак #%enemy1$, #%name$ несколько раз сбивал с места стоящие тут столы.
instr terdescription2=Кто-то из посетителей таверны крикнул #%enemy2$: "Да убей же ты его!".
goto fightchoseweap

:tavernstraiderbarroomvalmesfight
valmesdie=1
tavernstraiderbarroomalert=1
instr locname=tavernstraiderbarroom
instr fightname=valmes
common=1
proc fight#%fightname$status
numterdesenemy=0
numterdes=0
goto fightchoseweap

:tavernstraiderbarroomfurgotfight
furgotdie=1
tavernstraiderbarroomalert=1
instr locname=tavernstraiderbarroom
instr fightname=furgot
common=1
proc fight#%fightname$status
numterdesenemy=0
numterdes=0
goto fightchoseweap

:tavernstraidertablesallirafight
alliradie=1
tavernstraideralert=1
instr locname=tavernstraidertables
instr fightname=allira
common=1
proc fight#%fightname$status
numterdesenemy=2
if впол=1 then instr cname=ий
if впол=2 then instr cname=ая
if впол=3 then instr cname=ее
if впол=1 or впол=3 then instr cname1=ему
if впол=2 then instr cname1=ей
if впол=1 then instr cname2=
if впол=2 then instr cname2=а
if впол=3 then instr cname2=о
instr terdescriptionenemy1=Озверевш#%cname$ #%enemy$ рабивает в щепья все попадающиеся #%cname1$ на пути стулья, сам#%cname2$ того не замечая.
if впол=1 then instr cname=ый
if впол=2 then instr cname=ая
if впол=3 then instr cname=ое
instr terdescriptionenemy2=Поглощён#%cname$ схваткой #%enemy$ перебил#%cname2$ уже половину маслянных ламп в таверне.
numterdes=1
if valmesdie=0 or krildie=0 or traydie=0 then numterdes=2
instr terdescription1=Постоянно пятясь назад под напором атак #%enemy1$, #%name$ несколько раз сбивал с места стоящие тут столы.
instr terdescription2=Кто-то из посетителей таверны крикнул #%enemy2$: "Да убей же ты его!".
goto fightchoseweap

:tavernstraidertablestrayfight
traydie=1
tavernstraideralert=1
instr locname=tavernstraidertables
instr fightname=tray
common=1
proc fight#%fightname$status
numterdesenemy=2
if впол=1 then instr cname=ий
if впол=2 then instr cname=ая
if впол=3 then instr cname=ее
if впол=1 or впол=3 then instr cname1=ему
if впол=2 then instr cname1=ей
if впол=1 then instr cname2=
if впол=2 then instr cname2=а
if впол=3 then instr cname2=о
instr terdescriptionenemy1=Озверевш#%cname$ #%enemy$ рабивает в щепья все попадающиеся #%cname1$ на пути стулья, сам#%cname2$ того не замечая.
if впол=1 then instr cname=ый
if впол=2 then instr cname=ая
if впол=3 then instr cname=ое
instr terdescriptionenemy2=Поглощён#%cname$ схваткой #%enemy$ перебил#%cname2$ уже половину маслянных ламп в таверне.
numterdes=1
if valmesdie=0 or krildie=0 or alliradie=0 then numterdes=2
instr terdescription1=Постоянно пятясь назад под напором атак #%enemy1$, #%name$ несколько раз сбивал с места стоящие тут столы.
instr terdescription2=Кто-то из посетителей таверны крикнул #%enemy2$: "Да убей же ты его!".
goto fightchoseweap

:tavernstraidertablesfightkril
krildie=1
tavernstraideralert=1
instr locname=tavernstraidertables
instr fightname=kril
common=1
proc fight#%fightname$status numterdesenemy=2
if впол=1 then instr cname=ий
if впол=2 then instr cname=ая
if впол=3 then instr cname=ее
if впол=1 or впол=3 then instr cname1=ему
if впол=2 then instr cname1=ей
if впол=1 then instr cname2=
if впол=2 then instr cname2=а
if впол=3 then instr cname2=о
instr terdescriptionenemy1=Озверевш#%cname$ #%enemy$ рабивает в щепья все попадающиеся #%cname1$ на пути стулья, сам#%cname2$ того не замечая.
if впол=1 then instr cname=ый
if впол=2 then instr cname=ая
if впол=3 then instr cname=ое
instr terdescriptionenemy2=Поглощён#%cname$ схваткой #%enemy$ перебил#%cname2$ уже половину маслянных ламп в таверне.
numterdes=1
if valmesdie=0 or alliradie=0 or traydie=0 then numterdes=2
instr terdescription1=Постоянно пятясь назад под напором атак #%enemy1$, #%name$ несколько раз сбивал с места стоящие тут столы.
instr terdescription2=Кто-то из посетителей таверны крикнул #%enemy2$: "Да убей же ты его!".
goto fightchoseweap

:tavernstraideraroundfurgotfight
furgotdie=1
tavernstraiderfurgots=0
instr locname=tavernstraideraround
instr fightname=furgot
common=1
proc fight#%fightname$status
numterdesenemy=0
numterdes=0
goto fightchoseweap

:tavernstraidertablesfurgotfight
furgotdie=1
tavernstraiderfurgots=0
instr locname=tavernstraidertables
instr fightname=furgot
common=1
proc fight#%fightname$status
numterdesenemy=2
if впол=1 then instr cname=ий
if впол=2 then instr cname=ая
if впол=3 then instr cname=ее
if впол=1 or впол=3 then instr cname1=ему
if впол=2 then instr cname1=ей
if впол=1 then instr cname2=
if впол=2 then instr cname2=а
if впол=3 then instr cname2=о
instr terdescriptionenemy1=Озверевш#%cname$ #%enemy$ рабивает в щепья все попадающиеся #%cname1$ на пути стулья, сам#%cname2$ того не замечая.
if впол=1 then instr cname=ый
if впол=2 then instr cname=ая
if впол=3 then instr cname=ое
instr terdescriptionenemy2=Поглощён#%cname$ схваткой #%enemy$ перебил#%cname2$ уже половину маслянных ламп в таверне.
numterdes=1
if valmesdie=0 or krildie=0 or traydie=0 then numterdes=2
instr terdescription1=Постоянно пятясь назад под напором атак #%enemy1$, #%name$ несколько раз сбивал с места стоящие тут столы.
instr terdescription2=Кто-то из посетителей таверны крикнул #%enemy2$: "Да убей же ты его!".
goto fightchoseweap

:redmountainsnearlakegoblinfight
redmountansnearlakegoblindie=1
forestprotrmtors=1
instr locname=forestprotrm
instr fightname=goblinfighter
common=1
proc fight#%fightname$status
numterdesenemy=0
numterdes=0
goto fightchoseweap

:forestprotrmtorfight
tordie=1
forestprotrmtors=1
instr locname=forestprotrm
instr fightname=tor
common=1
proc fight#%fightname$status
numterdesenemy=0
numterdes=0
goto fightchoseweap

:forestprotfieldbugraiderfight
forestprotbugraiderdie=forestprotbugraiderdie+1
instr locname=forestprotfieldbugs
instr fightname=peasant-bugraider
common=1
proc fight#%fightname$status
numterdesenemy=1
instr terdescriptionenemy1=Гигантский жук слегка приподнялся на задних лапах. Из его уродливой пасти раздался похожий на хрипение свист. Затем он снова ринулся в бой.
numterdes=1
if впол=1 or впол=3 then instr cname=ему
if впол=2 then instr cname=ей
instr terdescription1=Лёгкий ветер, несущий степную пыль, дул вам прямо в лицо и  приходилось щуриться. Однако этот же ветер дул #%enemy2$ в спину и нисколко не мешал #%cname$.
goto fightchoseweap

:fightchoseweap
слезливость=0
число=2
proc rnd
if musicno=0 and рнд=1 then music="1.ogg"
if musicno=0 and рнд=2 then music="3.ogg"
proc screenpar
confuse=0
confusetime=0
spellwait=0
spellcasting=0
enemyspellwait=0
enemyspellcasting=0
повышение=0
begin=0
action=0
act=0
dangerplace=1
fightrole=0
блок=0
времяконфуза=0
конфуз=0
лежит=0
оружиеупало=0
впроклятие=0
вслезливость=0
вяд=0
instr magicname=неизвестной
минфортуна=-уровень/1.5
максфортуна=удача
pln Выберите оружие, которым вы будете сражаться.
if Топор_дровосека and размер<3 then btn fightweapтопордровосека, Топор дровосека
if Малый_топор and размер<3 and знаниетопора>0 then btn fightweapмалыйтопор, Малый топор
if Двуручный_топор and знаниетопора>1 then btn fightweapдвуручныйтопор, Двуручный топор
;if 2 Топор_дровосека and сила>5 and знаниетопора>1 and размер<3 then btn fightweap2топордровосека, Топор дровосека + топор дровосека
if Посох_друида then btn fightweapпосохдруида, Посох друида
if Посох_маны then btn fightweapпосохманы, Посох маны
btn fightnoweap, Голыми руками
end

:fightnoweap
instr style_formpicture=heroimages/#%imagearmor$/#%imageshoes$/#%imagecap$/1.bmp
imageweapon=1
weaptype=0
instr weapname=рукопашного боя
instr оружие=кулак
weapbonus=знаниекулака
instr weapexp=знаниекулака
сминатака=0
смаксатака=0
весоружия=0
блок=1
весвсего=весшлема+весброни+весобуви+весперчаток+весинв
goto fightbegin

:fightweapтопордровосека
instr style_formpicture=heroimages/#%imagearmor$/#%imageshoes$/#%imagecap$/2.bmp
imageweapon=2
weaptype=4
instr weapname=владения топором
instr weapexp=знаниетопора
weapbonus=знаниетопора
instr оружие=топор дровосека
instr weapfullname=топордровосека
сминатака=1
смаксатака=3
весоружия=3
весвсего=весоружия+весшлема+весброни+весобуви+весперчаток+весинв
блок=5
goto fightbegin

:fightweapмалыйтопор
instr style_formpicture=heroimages/#%imagearmor$/#%imageshoes$/#%imagecap$/3.bmp
imageweapon=3
weaptype=4
instr weapname=владения топором
instr weapexp=знаниетопора
weapbonus=знаниетопора
instr оружие=малый топор
instr weapfullname=малыйтопор
сминатака=2
смаксатака=5
весоружия=4
весвсего=весоружия+весшлема+весброни+весобуви+весперчаток+весинв
блок=9
goto fightbegin

:fightweapдвуручныйтопор
instr style_formpicture=heroimages/#%imagearmor$/#%imageshoes$/#%imagecap$/5.bmp
imageweapon=5
weaptype=4
instr weapname=владения топором
instr weapexp=знаниетопора
weapbonus=знаниетопора
instr оружие=двуручный топор
instr weapfullname=двуручныйтопор
сминатака=3
смаксатака=8
весоружия=5
весвсего=весоружия+весшлема+весброни+весобуви+весперчаток+весинв
блок=15
goto fightbegin

:fightweapпосохдруида
instr style_formpicture=heroimages/#%imagearmor$/#%imageshoes$/#%imagecap$/4.bmp
imageweapon=4
weaptype=3
instr weapname=владения шестом
instr weapexp=знаниешеста
weapbonus=знаниешеста
instr оружие=посох друида
instr оружие1=навершием
instr weapfullname=посохдруида
сминатака=1
смаксатака=2
весоружия=3
зелмагия=зелмагия+1
плюскзелмагии=плюскзелмагии+1
весвсего=весоружия+весшлема+весброни+весобуви+весперчаток+весинв
блок=23
goto fightbegin

:fightweapпосохманы
instr style_formpicture=heroimages/#%imagearmor$/#%imageshoes$/#%imagecap$/4.bmp
imageweapon=4
weaptype=3
instr weapname=владения шестом
instr weapexp=знаниешеста
weapbonus=знаниешеста
instr оружие=посох маны
instr оружие1=навершием
instr weapfullname=посохманы
сминатака=1
смаксатака=2
весоружия=3
зелмагия=зелмагия+1
плюскзелмагии=плюскзелмагии+1
весвсего=весоружия+весшлема+весброни+весобуви+весперчаток+весинв
блок=23
goto fightbegin

:fightwgibstatus
полученныйопыт=5
if интеллект<3 then instr enemy=Существо
if интеллект<3 then впол=3
if интеллект<3 then instr enemy1=Существа
if интеллект<3 then instr enemy2=Существу
if интеллект<3 then instr enemy3=Существо
if интеллект<3 then instr enemy4=Существом
if интеллект<3 then instr enemy5=Существе
if интеллект>2 then впол=1
if интеллект>2 then instr enemy=Дикий гибберлин
if интеллект>2 then instr enemy1=Дикого гибберлина
if интеллект>2 then instr enemy2=Дикому гибберлину
if интеллект>2 then instr enemy3=Дикого гибберлина
if интеллект>2 then instr enemy4=Диким гибберлином
if интеллект>2 then instr enemy5=Диком гибберлине
enemyact=0
всила=1
вздоровье=9
вмаксздоровье=9
вмаксбодрость=3
вмана=0
вбодрость=3
вмаксмана=0
вловкость=3
вточность=1
ввосприятие=2
вскорость=2
виллюзия=0
вудача=1
внагруженность=1
вбронятела=0
вброняног=0
вброняголовы=0
вминфортуна=0
вмаксфортуна=вудача
вразмер=1
end

:fightwolfstatus
полученныйопыт=6
instr enemy=Волк
instr enemy1=Волка
instr enemy2=Волку
instr enemy3=Волка
instr enemy4=Волком
instr enemy5=Волке
впол=1
if интеллект<1 and alliraknow=0 then instr enemy=Существо
if интеллект<1 then instr enemy1=Существа
if интеллект<1 then instr enemy2=Существу
if интеллект<1 then instr enemy3=Существо
if интеллект<1 then instr enemy4=Существом
if интеллект<1 then instr enemy5=Существе
if интеллект<1 then впол=3
enemyact=0
всила=4
вздоровье=15
вмаксздоровье=15
вмаксбодрость=6
вмана=0
вбодрость=6
вмаксмана=0
вловкость=3
вточность=2
ввосприятие=2
вскорость=2
виллюзия=0
вудача=0
внагруженность=1
вбронятела=0
вброняног=0
вброняголовы=0
вминфортуна=-0.75
вмаксфортуна=вудача
вразмер=1
end

:fightvalmesstatus
полученныйопыт=12
if интеллект<2 and valmesknow=0 then instr enemy=Существо
if интеллект<2 then впол=3
if интеллект<2 then instr enemy1=Существа
if интеллект<2 then instr enemy2=Существу
if интеллект<2 then instr enemy3=Существо
if интеллект<2 then instr enemy4=Существом
if интеллект<2 then instr enemy5=Существе
if интеллект>1 and valmesknow=0 then instr enemy=Сатир
if интеллект>1 then впол=1
if интеллект>1 then instr enemy1=Сатира
if интеллект>1 then instr enemy2=Сатиру
if интеллект>1 then instr enemy3=Сатира
if интеллект>1 then instr enemy4=Сатиром
if интеллект>1 then instr enemy5=Сатире
if valmesknow=1 then instr enemy=Валмес
if valmesknow=1 then впол=1
if valmesknow=1 then instr enemy1=Валмеса
if valmesknow=1 then instr enemy2=Валмесу
if valmesknow=1 then instr enemy3=Валмеса
if valmesknow=1 then instr enemy4=Валмесом
if valmesknow=1 then instr enemy5=Валмесе
enemyact=0
всила=2
вздоровье=18
вмаксздоровье=18
вмаксбодрость=9
вмана=3
вбодрость=9
вмаксмана=3
вловкость=2
вточность=1
ввосприятие=1
вскорость=2
виллюзия=0
вудача=3
внагруженность=1
вбронятела=0
вброняног=0
вброняголовы=0
вминфортуна=-0.7.5
вмаксфортуна=вудача
вразмер=2
end

:fightallirastatus
полученныйопыт=12
if интеллект<2 and alliraknow=0 then instr enemy=Существо
if интеллект<2 then впол=3
if интеллект<2 then instr enemy1=Существа
if интеллект<2 then instr enemy2=Существу
if интеллект<2 then instr enemy3=Существо
if интеллект<2 then instr enemy4=Существом
if интеллект<2 then instr enemy5=Существе
if интеллект>1 and alliraknow=0 then instr enemy=Полу-эльфийка
if интеллект>1 then впол=2
if интеллект>1 then instr enemy1=Полу-эльфийки
if интеллект>1 then instr enemy2=Полу-эльфийке
if интеллект>1 then instr enemy3=Полу-эльфийку
if интеллект>1 then instr enemy4=Полу-эльфийкой
if интеллект>1 then instr enemy5=Полу-эльфийке
if alliraknow=1 then instr enemy=Аллира
if alliraknow=1 then впол=2
if alliraknow=1 then instr enemy1=Аллиры
if alliraknow=1 then instr enemy2=Аллире
if alliraknow=1 then instr enemy3=Аллиру
if alliraknow=1 then instr enemy4=Аллирой
if alliraknow=1 then instr enemy5=Аллире
enemyact=0
всила=2
вздоровье=12
вмаксздоровье=12
вмаксбодрость=9
вмана=6
вбодрость=9
вмаксмана=6
вловкость=4
вточность=2
ввосприятие=2
вскорость=2
виллюзия=1
вудача=0
внагруженность=1
вбронятела=0
вброняног=0
вброняголовы=0
вминфортуна=-0.75
вмаксфортуна=вудача
вразмер=2
end

:fightkrilstatus
полученныйопыт=20
if интеллект<1 and krilknow=0 then instr enemy=Существо
if интеллект<1 then впол=3
if интеллект<1 then instr enemy1=Существа
if интеллект<1 then instr enemy2=Существу
if интеллект<1 then instr enemy3=Существо
if интеллект<1 then instr enemy4=Существом
if интеллект<1 then instr enemy5=Существе
if интеллект>0 and krilknow=0 then instr enemy=Человек
if интеллект>0 then впол=1
if интеллект>0 then instr enemy1=Человека
if интеллект>0 then instr enemy2=Человеку
if интеллект>0 then instr enemy3=Человека
if интеллект>0 then instr enemy4=Человеком
if интеллект>0 then instr enemy5=Человеке
if krilknow=1 then instr enemy=Крил
if krilknow=1 then впол=1
if krilknow=1 then instr enemy1=Крила
if krilknow=1 then instr enemy2=Крилу
if krilknow=1 then instr enemy3=Крила
if krilknow=1 then instr enemy4=Крилом
if krilknow=1 then instr enemy5=Криле
enemyact=0
всила=2
вздоровье=18
вмаксздоровье=18
вмаксбодрость=9
вмана=18
вбодрость=9
вмаксмана=6
вловкость=2
вточность=2
ввосприятие=2
вскорость=2
виллюзия=2
вудача=1
внагруженность=1
if krilwands=1 then всила=2 & внагруженность=2 & вмана=24
вбронятела=0
вброняног=0вброняголовы=0
if krilrobes=1 then вбронятела=1
if krilsandaless=1 then вброняног=1
вминфортуна=-1.3
вмаксфортуна=вудача
вразмер=2
end

:fightfurgotstatus
полученныйопыт=15
if интеллект<1 and furgotknow=0 then instr enemy=Существо
if интеллект<1 then впол=3
if интеллект<1 then instr enemy1=Существа
if интеллект<1 then instr enemy2=Существу
if интеллект<1 then instr enemy3=Существо
if интеллект<1 then instr enemy4=Существом
if интеллект<1 then instr enemy5=Существе
if интеллект>0 and furgotknow=0 then instr enemy=Полу-орк
if интеллект>0 then впол=1
if интеллект>0 then instr enemy1=Полу-орка
if интеллект>0 then instr enemy2=Полу-орку
if интеллект>0 then instr enemy3=Полу-орка
if интеллект>0 then instr enemy4=Полу-орком
if интеллект>0 then instr enemy5=Полу-орке
if furgotknow=1 then instr enemy=Фургот
if furgotknow=1 then впол=1
if furgotknow=1 then instr enemy1=Фургота
if furgotknow=1 then instr enemy2=Фурготу
if furgotknow=1 then instr enemy3=Фургота
if furgotknow=1 then instr enemy4=Фурготом
if furgotknow=1 then instr enemy5=Фурготе
enemyact=0
всила=4
if furgotaxes=1 then всила=5
вздоровье=18
вмаксздоровье=18
вмаксбодрость=12
вмана=3
вбодрость=12
вмаксмана=3
вловкость=0
вточность=1
ввосприятие=1
вскорость=3
виллюзия=0
вудача=2
внагруженность=1
вбронятела=0
вброняног=0
вброняголовы=0
вминфортуна=-1.3
вмаксфортуна=вудача
вразмер=2
end

:fighttraystatus
полученныйопыт=20
if интеллект<1 and trayknow=0 then instr enemy=Существо
if интеллект<1 then впол=3
if интеллект<1 then instr enemy1=Существа
if интеллект<1 then instr enemy2=Существу
if интеллект<1 then instr enemy3=Существо
if интеллект<1 then instr enemy4=Существом
if интеллект<1 then instr enemy5=Существе
if интеллект>0 and trayknow=0 then instr enemy=Гном
if интеллект>0 then впол=1
if интеллект>0 then instr enemy1=Гнома
if интеллект>0 then instr enemy2=Гному
if интеллект>0 then instr enemy3=Гнома
if интеллект>0 then instr enemy4=Гномом
if интеллект>0 then instr enemy5=Гноме
if trayknow=1 then instr enemy=Трэй
if trayknow=1 then впол=1
if trayknow=1 then instr enemy1=Трэя
if trayknow=1 then instr enemy2=Трэю
if trayknow=1 then instr enemy3=Трэя
if trayknow=1 then instr enemy4=Трэем
if trayknow=1 then instr enemy5=Трэе
enemyact=0
всила=3
if trayaxes=1 then всила=6
вздоровье=18
вмаксздоровье=18
вмаксбодрость=15
вмана=0
вбодрость=15
вмаксмана=0
вловкость=0
вточность=2
ввосприятие=2
вскорость=2
виллюзия=0
вудача=1
внагруженность=2
вбронятела=0
вброняног=0
вброняголовы=0
вминфортуна=-1.3
вмаксфортуна=вудача
вразмер=1
end

:fighttorstatus
полученныйопыт=28
if интеллект<1 and torknow=0 then instr enemy=Существо
if интеллект<1 then впол=3
if интеллект<1 then instr enemy1=Существа
if интеллект<1 then instr enemy2=Существу
if интеллект<1 then instr enemy3=Существо
if интеллект<1 then instr enemy4=Существом
if интеллект<1 then instr enemy5=Существе
if интеллект>0 and torknow=0 then instr enemy=Гном
if интеллект>0 then впол=1
if интеллект>0 then instr enemy1=Гнома
if интеллект>0 then instr enemy2=Гному
if интеллект>0 then instr enemy3=Гнома
if интеллект>0 then instr enemy4=Гномом
if интеллект>0 then instr enemy5=Гноме
if torknow=1 then instr enemy=Тор
if torknow=1 then впол=1
if torknow=1 then instr enemy1=Тора
if torknow=1 then instr enemy2=Тору
if torknow=1 then instr enemy3=Тора
if torknow=1 then instr enemy4=Тором
if torknow=1 then instr enemy5=Торе
enemyact=0
всила=4
if toraxes=1 then всила=9
вздоровье=21
вмаксздоровье=21
вмаксбодрость=15
вмана=0
вбодрость=15
вмаксмана=0
вловкость=0
вточность=2
ввосприятие=2
вскорость=1
виллюзия=0
вудача=1
внагруженность=4
вбронятела=0
вброняног=0
вброняголовы=0
вминфортуна=-1.3
вмаксфортуна=вудача
вразмер=1
end

:fightpeasant-bugraiderstatus
полученныйопыт=28
if интеллект<1 then instr enemy=Существо
if интеллект<1 then впол=3
if интеллект<1 then instr enemy1=Существа
if интеллект<1 then instr enemy2=Существу
if интеллект<1 then instr enemy3=Существо
if интеллект<1 then instr enemy4=Существом
if интеллект<1 then instr enemy5=Существе
if интеллект>0 and torknow=0 then instr enemy=Крестьянин-баграйдер
if интеллект>0 then впол=1
if интеллект>0 then instr enemy1=Крестьянина-баграйдера
if интеллект>0 then instr enemy2=Крестьянину-баграйдеру
if интеллект>0 then instr enemy3=Крестьянина-баграйдера
if интеллект>0 then instr enemy4=Крестьянином-баграйдером
if интеллект>0 then instr enemy5=Крестьянине-баграйдере
enemyact=0
всила=6
вздоровье=30
вмаксздоровье=30
вмаксбодрость=21
вмана=0
вбодрость=21
вмаксмана=0
вловкость=0
вточность=1
ввосприятие=2
вскорость=2
виллюзия=0
вудача=1
внагруженность=2
вбронятела=0
вброняног=0
вброняголовы=0
вминфортуна=-1.3
вмаксфортуна=вудача
вразмер=3
fightthrowstones=0
fightstones=2
end

:fightwin
common=2
imageweapon=1
proc screenpar
if musicno=0 then music="2.ogg"
image=раса
сила=сила+плюсксиле
восприятие=восприятие-плюсквосприятию
ловкость=ловкость-плюскловкости
скорость=скорость-плюскскорости
удача=удача-плюскудаче
точность=точность-плюскточности
интеллект=интеллект-плюскинтеллекту
знаниекулака=знаниекулака-плюсккулаку
знаниемеча=знаниемеча-плюскмечу
знаниепалицы=знаниепалицы-плюскпалице
знаниешеста=знаниешеста-плюскшесту
знаниетопора=знаниетопора-плюсктопору
знаниекастета=знаниекастета-плюсккастету
чёрмагия=чёрмагия-плюскчёрмагии
белмагия=белмагия-плюскбелмагии
красмагия=красмагия-плюсккрасмагии
синмагия=синмагия-плюсксинмагии
зелмагия=зелмагия-плюскзелмагии
плюсксиле=0плюсквосприятию=0
плюскловкости=0
плюскскорости=0
плюскудаче=0
плюскточности=0
плюскинтеллекту=0
плюсккулаку=0
плюскмечу=0
плюскпалице=0
плюскшесту=0
плюсктопору=0
плюсккастету=0
плюскчёрмагии=0
плюскчёрмагии=0
плюскбелмагии=0
плюсккрасмагии=0
плюсксинмагии=0
плюскзелмагии=0
полученныйопыт=полученныйопыт-уровень+харизма
if полученныйопыт<0 then полученныйопыт=0
pln #%name$ убил #%enemy3$ и получил #полученныйопыт$ единиц опыта!
опыт=опыт+полученныйопыт
if опыт#%weapexp$>=нужныйопыт#%weapexp$ then опыт#%weapexp$=0 & нужныйопыт#%weapexp$=нужныйопыт#%weapexp$*2 & #%weapexp$=#%weapexp$+1 & pln #%name$ повысил мастерство #%weapname$!
if опыт<нужныйопыт#уровень+1$ then btn #%locname$, Вернуться в игру
if опыт>=нужныйопыт#уровень+1$ and опыт<(нужныйопыт#уровень+2$+нужныйопыт#уровень+1$) then опыт=(опыт-нужныйопыт#уровень+1$) & уровень=уровень+1 & pln #%name$ повысил уровень - уровень #уровень+1$! & повышение=1 & btn levelup, Поднять характеристику
if опыт>=(нужныйопыт#уровень+1+нужныйопыт#уровень+2$) and опыт<(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$+нужныйопыт#уровень+3$) then опыт=опыт-(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$) & уровень=уровень+2 & pln #%name$ повысил уровень - уровень #уровень+2$! & повышение=2 & btn levelup, Поднять характеристики
if опыт>=(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$+нужныйопыт#уровень+3$) and опыт<(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$+нужныйопыт#уровень+3$+нужныйопыт#уровень+4$) then опыт=опыт-(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$+нужныйопыт#уровень+3$) & уровень=уровень+3 & pln #%name$ повысил уровень - уровень #уровень+3$! & повышение=3 & btn levelup, Поднять характеристики
if опыт>=(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$+нужныйопыт#уровень+3$+нужныйопыт#уровень+4$) and опыт<(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$+нужныйопыт#уровень+3$+нужныйопыт#уровень+4$+нужныйопыт#уровень+5$) then опыт=опыт-(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$+нужныйопыт#уровень+3$+нужныйопыт#уровень+4$) & уровень=уровень+4 & pln #%name$ повысил уровень - уровень #уровень+4$! & повышение=4 & btn levelup, Поднять характеристики
end

:checklevup
if опыт#%weapexp$>=нужныйопыт#%weapexp$ then опыт#%weapexp$=0 & нужныйопыт#%weapexp$=нужныйопыт#%weapexp$*2 & #%weapexp$=#%weapexp$+1 & pln #%name$ повысил мастерство #%weapname$!
if опыт>=нужныйопыт#уровень+1$ and опыт<нужныйопыт#уровень+2$ then опыт=(опыт-нужныйопыт#уровень+1$) & уровень=уровень+1 & cls & pln #%name$ повысил уровень - уровень #уровень+1$! & повышение=1 & btn levelup, Поднять характеристику
if опыт>=(нужныйопыт#уровень+1+нужныйопыт#уровень+2$) and опыт<(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$+нужныйопыт#уровень+3$) then уровень=уровень+2 & cls & pln #%name$ повысил уровень - уровень #уровень+2$! & повышение=2 & btn levelup, Поднять характеристики
if опыт>=(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$+нужныйопыт#уровень+3$) and опыт<(нужныйопыт#уровень+1$+нужныйопыт#уровень+2$+нужныйопыт#уровень+3$+нужныйопыт#уровень+1$) then уровень=уровень+3 & cls & pln #%name$ повысил уровень - уровень #уровень+3$! & повышение=3 & btn levelup, Поднять характеристики
end

:levelup
proc screenpar
pln #%name$ может повысить свои характеристики #повышение$ раз(а). Что повышать?
if herotype=1 or сила<4 then btn повышениесилы, Сила
if herotype=2 or максмана<12 then btn повышениеманы, Мана
if herotype=1 or ловкость<4 then btn повышениеловкости, Ловкость
if herotype=2 or интеллект<4 then btn повышениеинтеллекта, Интеллект
if herotype=1 or точность<4 then btn повышениеточности, Точность
btn повышениездоровья, Здоровье
if herotype=1 or максбодрость<12 then btn повышениебодрости, Бодрость
if herotype=1 or максвыносливость<12 then btn повышениевыносливости, Выносливость
btn повышениеудачи, Удача
btn повышениехаризмы, Харизма
if herotype=2 or восприятие<4 then btn повышениевосприятия, Восприятие
if herotype=1 or скорость<4 then btn повышениескорости, Скорость
end

:повышениесилы
повышение=повышение-1
pln #%name$ повысил силу.
сила=сила+1
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениеманы
повышение=повышение-1
pln #%name$ повысил ману.
мана=мана+3
максмана=максмана+3
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениеловкости
повышение=повышение-1
pln #%name$ повысил ловкость.
ловкость=ловкость+1
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениеинтеллекта
повышение=повышение-1
pln #%name$ повысил интеллект.
интеллект=интеллект+1
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениеточности
повышение=повышение-1
pln #%name$ повысил точность.
точность=точность+1
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениездоровья
повышение=повышение-1
pln #%name$ повысил здоровье.
здоровье=здоровье+3
максздоровье=максздоровье+3proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениебодрости
повышение=повышение-1
pln #%name$ повысил бодрость.
бодрость=бодрость+3
максбодрость=максбодрость+3
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениевыносливости
повышение=повышение-1
pln #%name$ повысил выносливость.
выносливость=выносливость+1
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениеудачи
повышение=повышение-1
pln #%name$ повысил удачу.
удача=удача+1
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениехаризмы
повышение=повышение-1
pln #%name$ повысил харизму.
харизма=харизма+1
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениевосприятия
повышение=повышение-1
pln #%name$ повысил восприятие.
восприятие=восприятие+1
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:повышениескорости
повышение=повышение-1
pln #%name$ повысил скорость.
скорость=скорость+1
proc levelupstatus
if повышение>0 then goto levelup
btn #%locname$, Вернуться в игру
end

:levelupstatus
здоровье=максздоровье+0.9
мана=максмана+0.9
бодрость=максбодрость+0.9
выносливость=максвыносливость+0.9
end

:stealup
if опытворовство>=нужныйопытворовство and воровство<14 then опытворовство=0 & нужныйопытворовство=нужныйопытворовство*2 & воровство=воровство+1
if опытворовство>=нужныйопытворовство and воровство=14 then опытворовство=0 & нужныйопытворовство=9999999 & воровство=15
end

:replichello
if рнд<2 then instr hello=Здорово
if рнд>=2 and рнд<3 then instr hello=Привет
if рнд>=3 and рнд<4 then instr hello=Приветствую
if рнд>=4 and рнд<5 then instr hello=Здравствуйте
if рнд>=5 and рнд<6 then instr hello=Привет тебе
if рнд>6 and hour<11 then instr hello=Доброе утро
if рнд>6 and hour>10 then instr hello=Добрый день
if рнд>6 and hour>15 then instr hello=Добрый вечер
end

:checkstealgold
checkstealgold=0
p #%name$ украл 
if воровство>14 and #%cname$gold>79 and checkstealgold=0 then inv+ 80,Гил & #%cname$gold=#%cname$gold-80 & checkstealgold=1 & p 80 
if воровство>14 and #%cname$gold>78 and checkstealgold=0 then inv+ 79,Гил & #%cname$gold=#%cname$gold-79 & checkstealgold=1 & p 79 
if воровство>14 and #%cname$gold>77 and checkstealgold=0 then inv+ 78,Гил & #%cname$gold=#%cname$gold-78 & checkstealgold=1 & p 78 
if воровство>14 and #%cname$gold>76 and checkstealgold=0 then inv+ 77,Гил & #%cname$gold=#%cname$gold-77 & checkstealgold=1 & p 77 
if воровство>14 and #%cname$gold>75 and checkstealgold=0 then inv+ 76,Гил & #%cname$gold=#%cname$gold-76 & checkstealgold=1 & p 76 

if воровство>13 and #%cname$gold>74 and checkstealgold=0 then inv+ 75,Гил & #%cname$gold=#%cname$gold-75 & checkstealgold=1 & p 75 
if воровство>13 and #%cname$gold>73 and checkstealgold=0 then inv+ 74,Гил & #%cname$gold=#%cname$gold-74 & checkstealgold=1 & p 74 
if воровство>13 and #%cname$gold>72 and checkstealgold=0 then inv+ 73,Гил & #%cname$gold=#%cname$gold-73 & checkstealgold=1 & p 73 
if воровство>13 and #%cname$gold>71 and checkstealgold=0 then inv+ 72,Гил & #%cname$gold=#%cname$gold-72 & checkstealgold=1 & p 72 
if воровство>13 and #%cname$gold>70 and checkstealgold=0 then inv+ 71,Гил & #%cname$gold=#%cname$gold-71 & checkstealgold=1 & p 71 

if воровство>12 and #%cname$gold>69 and checkstealgold=0 then inv+ 70,Гил & #%cname$gold=#%cname$gold-70 & checkstealgold=1 & p 70 
if воровство>12 and #%cname$gold>68 and checkstealgold=0 then inv+ 69,Гил & #%cname$gold=#%cname$gold-69 & checkstealgold=1 & p 69 
if воровство>12 and #%cname$gold>67 and checkstealgold=0 then inv+ 68,Гил & #%cname$gold=#%cname$gold-68 & checkstealgold=1 & p 68 
if воровство>12 and #%cname$gold>66 and checkstealgold=0 then inv+ 67,Гил & #%cname$gold=#%cname$gold-67 & checkstealgold=1 & p 67 
if воровство>12 and #%cname$gold>65 and checkstealgold=0 then inv+ 66,Гил & #%cname$gold=#%cname$gold-66 & checkstealgold=1 & p 66 

if воровство>11 and #%cname$gold>64 and checkstealgold=0 then inv+ 65,Гил & #%cname$gold=#%cname$gold-65 & checkstealgold=1 & p 65 
if воровство>11 and #%cname$gold>63 and checkstealgold=0 then inv+ 64,Гил & #%cname$gold=#%cname$gold-64 & checkstealgold=1 & p 64 
if воровство>11 and #%cname$gold>62 and checkstealgold=0 then inv+ 63,Гил & #%cname$gold=#%cname$gold-63 & checkstealgold=1 & p 63 
if воровство>11 and #%cname$gold>61 and checkstealgold=0 then inv+ 62,Гил & #%cname$gold=#%cname$gold-62 & checkstealgold=1 & p 62 
if воровство>11 and #%cname$gold>60 and checkstealgold=0 then inv+ 61,Гил & #%cname$gold=#%cname$gold-61 & checkstealgold=1 & p 61 

if воровство>10 and #%cname$gold>59 and checkstealgold=0 then inv+ 60,Гил & #%cname$gold=#%cname$gold-60 & checkstealgold=1 & p 60 
if воровство>10 and #%cname$gold>58 and checkstealgold=0 then inv+ 59,Гил & #%cname$gold=#%cname$gold-59 & checkstealgold=1 & p 59 
if воровство>10 and #%cname$gold>57 and checkstealgold=0 then inv+ 58,Гил & #%cname$gold=#%cname$gold-58 & checkstealgold=1 & p 58 
if воровство>10 and #%cname$gold>56 and checkstealgold=0 then inv+ 57,Гил & #%cname$gold=#%cname$gold-57 & checkstealgold=1 & p 57 
if воровство>10 and #%cname$gold>55 and checkstealgold=0 then inv+ 56,Гил & #%cname$gold=#%cname$gold-56 & checkstealgold=1 & p 56 

if воровство>9 and #%cname$gold>54 and checkstealgold=0 then inv+ 55,Гил & #%cname$gold=#%cname$gold-55 & checkstealgold=1 & p 55 
if воровство>9 and #%cname$gold>53 and checkstealgold=0 then inv+ 54,Гил & #%cname$gold=#%cname$gold-54 & checkstealgold=1 & p 54 
if воровство>9 and #%cname$gold>52 and checkstealgold=0 then inv+ 53,Гил & #%cname$gold=#%cname$gold-53 & checkstealgold=1 & p 53 
if воровство>9 and #%cname$gold>51 and checkstealgold=0 then inv+ 52,Гил & #%cname$gold=#%cname$gold-52 & checkstealgold=1 & p 52 
if воровство>9 and #%cname$gold>50 and checkstealgold=0 then inv+ 51,Гил & #%cname$gold=#%cname$gold-51 & checkstealgold=1 & p 51 

if воровство>8 and #%cname$gold>49 and checkstealgold=0 then inv+ 50,Гил & #%cname$gold=#%cname$gold-50 & checkstealgold=1 & p 50 
if воровство>8 and #%cname$gold>48 and checkstealgold=0 then inv+ 49,Гил & #%cname$gold=#%cname$gold-49 & checkstealgold=1 & p 49 
if воровство>8 and #%cname$gold>47 and checkstealgold=0 then inv+ 48,Гил & #%cname$gold=#%cname$gold-48 & checkstealgold=1 & p 48 
if воровство>8 and #%cname$gold>46 and checkstealgold=0 then inv+ 47,Гил & #%cname$gold=#%cname$gold-47 & checkstealgold=1 & p 47 
if воровство>8 and #%cname$gold>45 and checkstealgold=0 then inv+ 46,Гил & #%cname$gold=#%cname$gold-46 & checkstealgold=1 & p 46 

if воровство>7 and #%cname$gold>44 and checkstealgold=0 then inv+ 45,Гил & #%cname$gold=#%cname$gold-45 & checkstealgold=1 & p 45 
if воровство>7 and #%cname$gold>43 and checkstealgold=0 then inv+ 44,Гил & #%cname$gold=#%cname$gold-44 & checkstealgold=1 & p 44 
if воровство>7 and #%cname$gold>42 and checkstealgold=0 then inv+ 43,Гил & #%cname$gold=#%cname$gold-43 & checkstealgold=1 & p 43 
if воровство>7 and #%cname$gold>41 and checkstealgold=0 then inv+ 42,Гил & #%cname$gold=#%cname$gold-42 & checkstealgold=1 & p 42 
if воровство>7 and #%cname$gold>40 and checkstealgold=0 then inv+ 41,Гил & #%cname$gold=#%cname$gold-41 & checkstealgold=1 & p 41 

if воровство>6 and #%cname$gold>39 and checkstealgold=0 then inv+ 40,Гил & #%cname$gold=#%cname$gold-40 & checkstealgold=1 & p 40 
if воровство>6 and #%cname$gold>38 and checkstealgold=0 then inv+ 39,Гил & #%cname$gold=#%cname$gold-39 & checkstealgold=1 & p 39 
if воровство>6 and #%cname$gold>37 and checkstealgold=0 then inv+ 38,Гил & #%cname$gold=#%cname$gold-38 & checkstealgold=1 & p 38 
if воровство>6 and #%cname$gold>36 and checkstealgold=0 then inv+ 37,Гил & #%cname$gold=#%cname$gold-37 & checkstealgold=1 & p 37 
if воровство>6 and #%cname$gold>35 and checkstealgold=0 then inv+ 36,Гил & #%cname$gold=#%cname$gold-36 & checkstealgold=1 & p 36 

if воровство>5 and #%cname$gold>34 and checkstealgold=0 then inv+ 34,Гил & #%cname$gold=#%cname$gold-34 & checkstealgold=1 & p 34 
if воровство>5 and #%cname$gold>33 and checkstealgold=0 then inv+ 34,Гил & #%cname$gold=#%cname$gold-34 & checkstealgold=1 & p 34 
if воровство>5 and #%cname$gold>32 and checkstealgold=0 then inv+ 33,Гил & #%cname$gold=#%cname$gold-33 & checkstealgold=1 & p 33 
if воровство>5 and #%cname$gold>31 and checkstealgold=0 then inv+ 32,Гил & #%cname$gold=#%cname$gold-32 & checkstealgold=1 & p 32 
if воровство>5 and #%cname$gold>30 and checkstealgold=0 then inv+ 31,Гил & #%cname$gold=#%cname$gold-31 & checkstealgold=1 & p 31 

if воровство>4 and #%cname$gold>29 and checkstealgold=0 then inv+ 30,Гил & #%cname$gold=#%cname$gold-30 & checkstealgold=1 & p 30 
if воровство>4 and #%cname$gold>28 and checkstealgold=0 then inv+ 29,Гил & #%cname$gold=#%cname$gold-29 & checkstealgold=1 & p 29 
if воровство>4 and #%cname$gold>27 and checkstealgold=0 then inv+ 28,Гил & #%cname$gold=#%cname$gold-28 & checkstealgold=1 & p 28 
if воровство>4 and #%cname$gold>26 and checkstealgold=0 then inv+ 27,Гил & #%cname$gold=#%cname$gold-27 & checkstealgold=1 & p 27 
if воровство>4 and #%cname$gold>25 and checkstealgold=0 then inv+ 26,Гил & #%cname$gold=#%cname$gold-26 & checkstealgold=1 & p 26 

if воровство>3 and #%cname$gold>24 and checkstealgold=0 then inv+ 25,Гил & #%cname$gold=#%cname$gold-25 & checkstealgold=1 & p 25 
if воровство>3 and #%cname$gold>23 and checkstealgold=0 then inv+ 24,Гил & #%cname$gold=#%cname$gold-24 & checkstealgold=1 & p 24 
if воровство>3 and #%cname$gold>22 and checkstealgold=0 then inv+ 23,Гил & #%cname$gold=#%cname$gold-23 & checkstealgold=1 & p 23 
if воровство>3 and #%cname$gold>21 and checkstealgold=0 then inv+ 22,Гил & #%cname$gold=#%cname$gold-22 & checkstealgold=1 & p 22 
if воровство>3 and #%cname$gold>20 and checkstealgold=0 then inv+ 21,Гил & #%cname$gold=#%cname$gold-21 & checkstealgold=1 & p 21 

if воровство>2 and #%cname$gold>19 and checkstealgold=0 then inv+ 20,Гил & #%cname$gold=#%cname$gold-20 & checkstealgold=1 & p 20 
if воровство>2 and #%cname$gold>18 and checkstealgold=0 then inv+ 19,Гил & #%cname$gold=#%cname$gold-19 & checkstealgold=1 & p 19 
if воровство>2 and #%cname$gold>17 and checkstealgold=0 then inv+ 18,Гил & #%cname$gold=#%cname$gold-18 & checkstealgold=1 & p 18 
if воровство>2 and #%cname$gold>16 and checkstealgold=0 then inv+ 17,Гил & #%cname$gold=#%cname$gold-17 & checkstealgold=1 & p 17 
if воровство>2 and #%cname$gold>15 and checkstealgold=0 then inv+ 16,Гил & #%cname$gold=#%cname$gold-16 & checkstealgold=1 & p 16 

if воровство>1 and #%cname$gold>14 and checkstealgold=0 then inv+ 15,Гил & #%cname$gold=#%cname$gold-15 & checkstealgold=1 & p 15 
if воровство>1 and #%cname$gold>13 and checkstealgold=0 then inv+ 14,Гил & #%cname$gold=#%cname$gold-14 & checkstealgold=1 & p 14 
if воровство>1 and #%cname$gold>12 and checkstealgold=0 then inv+ 13,Гил & #%cname$gold=#%cname$gold-13 & checkstealgold=1 & p 13 
if воровство>1 and #%cname$gold>11 and checkstealgold=0 then inv+ 12,Гил & #%cname$gold=#%cname$gold-12 & checkstealgold=1 & p 12 
if воровство>1 and #%cname$gold>10 and checkstealgold=0 then inv+ 11,Гил & #%cname$gold=#%cname$gold-11 & checkstealgold=1 & p 11 

if воровство>0 and #%cname$gold>9 and checkstealgold=0 then inv+ 10,Гил & #%cname$gold=#%cname$gold-10 & checkstealgold=1 & p 10 
if воровство>0 and #%cname$gold>8 and checkstealgold=0 then inv+ 9,Гил & #%cname$gold=#%cname$gold-9 & checkstealgold=1 & p 9 
if воровство>0 and #%cname$gold>7 and checkstealgold=0 then inv+ 8,Гил & #%cname$gold=#%cname$gold-8 & checkstealgold=1 & p 8 
if воровство>0 and #%cname$gold>6 and checkstealgold=0 then inv+ 7,Гил & #%cname$gold=#%cname$gold-7 & checkstealgold=1 & p 7 
if воровство>0 and #%cname$gold>5 and checkstealgold=0 then inv+ 6,Гил & #%cname$gold=#%cname$gold-6 & checkstealgold=1 & p 6 
 
if #%cname$gold>4 and checkstealgold=0 then inv+ 5,Гил & #%cname$gold=#%cname$gold-5 & checkstealgold=1 & p 5 
if #%cname$gold>3 and checkstealgold=0 then inv+ 4,Гил & #%cname$gold=#%cname$gold-4 & checkstealgold=1 & p 4 
if #%cname$gold>2 and checkstealgold=0 then inv+ 3,Гил & #%cname$gold=#%cname$gold-3 & checkstealgold=1 & p 3 
if #%cname$gold>1 and checkstealgold=0 then inv+ 2,Гил & #%cname$gold=#%cname$gold-2 & checkstealgold=1 & p 2 
if #%cname$gold>0 and checkstealgold=0 then inv+ Гил & #%cname$gold=#%cname$gold-1 & checkstealgold=1
pln Гил.
end

:checktrading
опытторговли=опытторговли+1
if опытторговли>=7 and торговля<15 then опытторговли=опытторговли-7 & торговля=торговля+1 & pln #%name$ повысил своё мастерство торговли!
end

:replicbye
if рнд<2 then instr bye=Ну, бывай
if рнд=2 then instr bye=Пока
if рнд=3 then instr bye=Всего хорошего
if рнд=4 then instr bye=Счастливо
if рнд>4 then instr bye=До свиданья
end




:screenpar
dialog=0
if gamebegin=0 then instr style_formpicture=998.bmp
if gamebegin=1 then instr style_formpicture=heroimages/#%imagearmor$/#%imageshoes$/#%imagecap$/1.bmp
gamebegin=1
hide_phantoms=1
Style_TextColor=73989
Style_BackColor=13762508
Instr Style_NonActiveText=-
Style_ButtonSpaceWidth=1
Style_ButtonSpaceHeight=1
Style_FormWidth=12000
Style_FormMinimumHeight=8625
Style_FormMediumHeight=8625
Style_FormMaximumHeight=8625
Style_ButtonWidth=2058
Style_ButtonHeight=802
Style_TextBoxWidth=8545
Style_TextBoxHeight=2800
Style_DOS_FillEol=1
Style_DOS_ButtonColor=8
Style_DOS_CursorColor=7
end

:dialogpar
dialog=1
instr style_formpicture=997.bmp
Style_ButtonWidth=11805
Style_ButtonHeight=536
Style_ButtonSpaceHeight=345
end




;Генератор лабиринтов

:labirint
pln Генератор лабиринтов
btn labirintq, Поехали!
end

:labirintq
pln С компасом проходить будем?
btn labirintqy, Да
btn checklab, Нет
end

:labirintqy
inv+ Компас

:redmountainsenterlabs
;Прежде всего нарисуйте свой лабиринт на координатной плоскости на каком-нибудь листике.
;У каждой комнаты и у каждого перехода между ними должны быть координаты x, y.
;Напишите proc lab0
;Придумайте как ваш лабиринт будет называться (в примере - labrm), напишите instr labaction=<название лабиринта>.
;Напишите labx=*, laby=*, где * значат начальные координаты игрока.
;Затем напишите координаты существующих переходов между локациями (координаты локаций писать не нужно) на примере "labx<координата x>y<координата y>=1".
;Всё, осталось только написать goto labroom и искать ошибки ;)
proc lab0
instr labaction=labrm
labx=5
laby=1
laborient=90
labx4y1=1
labx6y1=1
labx3y2=1
labx7y2=1
labx9y2=1
labx2y3=1
labx6y3=1
labx8y3=1
labx10y3=1
labx7y4=1
labx11y4=1
labx2y5=1
labx4y5=1
labx8y5=1
labx5y6=1
labx11y6=1
labx6y7=1
labx10y7=1
labx12y7=1
labx7y8=1
labx9y8=1
labx6y9=1
labx8y9=1
labx10y9=1
labx5y10=1
goto labroom
end

:redmountainslabs
proc lab0
instr labaction=labrm
labx=1
laby=5
laborient=180
labx4y1=1
labx6y1=1
labx3y2=1
labx7y2=1
labx9y2=1
labx2y3=1
labx6y3=1
labx8y3=1
labx10y3=1
labx7y4=1
labx11y4=1
labx2y5=1
labx4y5=1
labx8y5=1
labx5y6=1
labx11y6=1
labx6y7=1
labx10y7=1
labx12y7=1
labx7y8=1
labx9y8=1
labx6y9=1
labx8y9=1
labx10y9=1
labx5y10=1
goto labroom
end

:lab0
labx2y1=0
labx4y1=0
labx6y1=0
labx8y1=0
labx10y1=0
labx12y1=0
labx14y1=0
labx16y1=0
labx18y1=0
labx20y1=0
labx1y2=0
labx3y2=0
labx5y2=0
labx7y2=0
labx9y2=0
labx11y2=0
labx13y2=0
labx15y2=0
labx17y2=0
labx19y2=0
labx2y3=0
labx4y3=0
labx6y3=0
labx8y3=0
labx10y3=0
labx12y3=0
labx14y3=0
labx16y3=0
labx18y3=0
labx20y3=0
labx1y4=0
labx3y4=0
labx5y4=0
labx7y4=0
labx9y4=0
labx11y4=0
labx13y4=0
labx15y4=0
labx17y4=0
labx19y4=0
labx2y5=0
labx4y5=0
labx6y5=0
labx8y5=0
labx10y5=0
labx12y5=0
labx14y5=0
labx16y5=0
labx18y5=0
labx20y5=0
labx1y6=0
labx3y6=0
labx5y6=0
labx7y6=0
labx9y6=0
labx11y6=0
labx13y6=0
labx15y6=0
labx17y6=0
labx19y6=0
labx2y7=0
labx4y7=0
labx6y7=0
labx8y7=0
labx10y7=0
labx12y7=0
labx14y7=0
labx16y7=0
labx18y7=0
labx20y7=0
labx1y8=0
labx3y8=0
labx5y8=0
labx7y8=0
labx9y8=0
labx11y8=0
labx13y8=0
labx15y8=0
labx17y8=0
labx19y8=0
labx2y9=0
labx4y9=0
labx6y9=0
labx8y9=0
labx10y9=0
labx12y9=0
labx14y9=0
labx16y9=0
labx18y9=0
labx20y9=0
labx1y10=0
labx3y10=0
labx5y10=0
labx7y10=0
labx9y10=0
labx11y10=0
labx13y10=0
labx15y10=0
labx17y10=0
labx19y10=0
labx2y11=0
labx4y11=0
labx6y11=0
labx8y11=0
labx10y11=0
labx12y11=0
labx14y11=0
labx16y11=0
labx18y11=0
labx20y11=0
labx1y12=0
labx3y12=0
labx5y12=0
labx7y12=0
labx9y12=0
labx11y12=0
labx13y12=0
labx15y12=0
labx17y12=0
labx19y12=0
labx1y13=0
labx3y13=0
labx5y13=0
labx7y13=0
labx9y13=0
labx11y13=0
labx13y13=0
labx15y13=0
labx17y13=0
labx19y13=0
labx2y14=0
labx4y14=0
labx6y14=0
labx8y14=0
labx10y14=0
labx12y14=0
labx14y14=0
labx16y14=0
labx18y14=0
labx20y14=0
labx1y15=0
labx3y15=0
labx5y15=0
labx7y15=0
labx9y15=0
labx11y15=0
labx13y15=0
labx15y15=0
labx17y15=0
labx19y15=0
labx1y16=0
labx3y16=0
labx5y16=0
labx7y16=0
labx9y16=0
labx11y16=0
labx13y16=0
labx15y16=0
labx17y16=0
labx19y16=0
labx2y17=0
labx4y17=0
labx6y17=0
labx8y17=0
labx10y17=0
labx12y17=0
labx14y17=0 labx16y17=0
labx18y17=0
labx20y17=0
labx1y18=0
labx3y18=0
labx5y18=0
labx7y18=0
labx9y18=0
labx11y18=0
labx13y18=0
labx15y18=0
labx17y18=0
labx19y18=0
labx1y19=0
labx3y19=0
labx5y19=0
labx7y19=0
labx9y19=0
labx11y19=0
labx13y19=0
labx15y19=0
labx17y19=0
labx19y19=0
labx2y20=0
labx4y20=0
labx6y20=0
labx8y20=0
labx10y20=0
labx12y20=0
labx14y20=0
labx16y20=0
labx18y20=0
labx20y20=0
end

:labroom
proc #%labaction$
if labx#labx$y#laby+1$=1 and labx#labx$y#laby-1$=1 or labx#labx$y#laby-1$=1 and labx#labx-1$y#laby$=1 or labx#labx-1$y#laby$=1 and labx#labx+1$y#laby$=1 or labx#labx+1$y#laby$=1 and labx#labx$y#laby+1$=1 or labx#labx-1$y#laby$=1 and labx#labx$y#laby+1$=1 or labx#labx+1$y#laby$=1 and labx#labx$y#laby-1$=1 then p Выходы: 
if labx#labx$y#laby+1$=1 and labx#labx$y#laby-1$=0 and labx#labx-1$y#laby$=0 and labx#labx+1$y#laby$=0 or labx#labx$y#laby-1$=1 and labx#labx$y#laby+1$=0 and labx#labx-1$y#laby$=0 and labx#labx+1$y#laby$=0 or labx#labx$y#laby+1$=0 and labx#labx$y#laby-1$=0 and labx#labx-1$y#laby$=1 and labx#labx+1$y#laby$=0 or labx#labx$y#laby+1$=0 and labx#labx$y#laby-1$=0 and labx#labx-1$y#laby$=0 and labx#labx+1$y#laby$=1 then p Выход только один: 
instr laband=
if labx#labx$y#laby+1$=1 and Компас then p север& btn labgonorth, Идти на север& instr laband=,
if labx#labx$y#laby-1$=1 and Компас then p #%laband$ юг& btn labgosouth, Идти на юг& instr laband=,
if labx#labx-1$y#laby$=1 and Компас then p #%laband$ запад& btn labgowest, Идти на запад& instr laband=,
if labx#labx+1$y#laby$=1 and Компас then p #%laband$ восток& btn labgoeast, Идти на восток

if laborient=0 and labx#labx-1$y#laby$=1 and not Компас or laborient=90 and labx#labx$y#laby+1$=1 and not Компас or laborient=180 and labx#labx+1$y#laby$=1 and not Компас or laborient=270 and labx#labx$y#laby-1$=1 and not Компас then p вперёд& btn labgoforward, Идти вперёд& instr laband=,
if laborient=0 and labx#labx$y#laby-1$=1 and not Компас or laborient=90 and labx#labx-1$y#laby$=1 and not Компас or laborient=180 and labx#labx$y#laby+1$=1 and not Компас or laborient=270 and labx#labx+1$y#laby$=1 and not Компас then p #%laband$ налево& btn labgoleft, Идти налево& instr laband=,
if laborient=0 and labx#labx$y#laby+1$=1 and not Компас or laborient=90 and labx#labx+1$y#laby$=1 and not Компас or laborient=180 and labx#labx$y#laby-1$=1 and not Компас or laborient=270 and labx#labx-1$y#laby$=1 and not Компас then p #%laband$ направо& btn labgoright, Идти направо& instr laband=,
if laborient=0 and labx#labx+1$y#laby$=1 and not Компас or laborient=90 and labx#labx$y#laby-1$=1 and not Компас or laborient=180 and labx#labx-1$y#laby$=1 and not Компас or laborient=270 and labx#labx$y#laby+1$=1 and not Компас then p #%laband$ назад& btn labgoback, Идти назад& instr laband=,
pln .
end

:labgoforward
pln #%name$ пошёл вперёд.
if laborient=0 then labx=labx-2
if laborient=90 then laby=laby+2
if laborient=180 then labx=labx+2
if laborient=270 then laby=laby-2
goto labroom
end

:labgoback
pln #%name$ развернулся и пошёл назад.
if laborient=0 then labx=labx+2
if laborient=90 then laby=laby-2
if laborient=180 then labx=labx-2
if laborient=270 then laby=laby+2
laborient=laborient+180
if laborient>359 then laborient=laborient-360
goto labroom
end

:labgoleft
pln #%name$ повернулся и пошёл налево.
if laborient=0 then laby=laby-2
if laborient=90 then labx=labx-2
if laborient=180 then laby=laby+2
if laborient=270 then labx=labx+2
laborient=laborient+270
if laborient>359 then laborient=laborient-360
goto labroom
end

:labgoright
pln #%name$ повернулся и пошёл направо.
if laborient=0 then laby=laby+2
if laborient=90 then labx=labx+2
if laborient=180 then laby=laby-2
if laborient=270 then labx=labx-2
laborient=laborient+90
if laborient>359 then laborient=laborient-360
goto labroom
end

:labrm
labstatus=0
;А эту локацию скопируйте и назовите "lab<название лабиринта>".
if labx=1 and laby=5 then pln #%name$ увидел свет факелов, льющийся из туннеля.& btn redmountainstunnel, Выйти в туннель& labstatus=1 if labx=5 and laby=1 then pln #%name$ видит выход в более просторный туннель.& btn redmountainsnenterlab, Выйти в туннель& labstatus=1
; Далее можете изменить описания, но не трогайте сам код.
if labx#labx$y#laby+1$=1 and labx#labx$y#laby-1$=0 and labx#labx-1$y#laby$=0 and labx#labx+1$y#laby$=0 and labstatus=0 or labx#labx$y#laby-1$=1 and labx#labx$y#laby+1$=0 and labx#labx-1$y#laby$=0 and labx#labx+1$y#laby$=0 and labstatus=0 or labx#labx$y#laby+1$=0 and labx#labx$y#laby-1$=0 and labx#labx-1$y#laby$=1 and labx#labx+1$y#laby$=0 and labstatus=0 or labx#labx$y#laby+1$=0 and labx#labx$y#laby-1$=0 and labx#labx-1$y#laby$=0 and labx#labx+1$y#laby$=1 and labstatus=0 then p #%name$ зашёл в тупик. & labstatus=1
рнд=rnd
if рнд<0.1429 and labstatus=0 then pln Здесь довольно мало воздуха и вам сложно дышать.
if рнд>0.1428 and рнд<0.2857 and labstatus=0 then pln Мимо вас пролетела летучая мышь.
if рнд>0.2856 and рнд<0.4285 and labstatus=0 then pln #%name$ чихнул и услышал долгое эхо, отражающееся от стен гномьего лабиринта.
if рнд>0.4284 and labstatus=0 then pln #%name$ находится в проходе. Вокруг одни лишь каменные стены, и, поэтому, здесь довольно холодно.
end

:labgonorth
pln #%name$ пошёл на север.
laby=laby+2
goto labroom
end

:labgosouth
pln #%name$ пошёл на юг.
laby=laby-2
goto labroom
end

:labgowest
pln #%name$ пошёл на запад.
labx=labx-2
goto labroom
end

:labgoeast
pln #%name$ пошёл на восток.
labx=labx+2
goto labroom
end
